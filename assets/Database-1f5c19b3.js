import{l as z,r as T,j as e,m as x,n as P,R as p,L as D,W as K}from"./main-97e8a966.js";import{d as F,t as I,s as W,n as $,a as G}from"./format-5969a492.js";import{u as V,T as M,I as J,c as Q}from"./useLocalStorage-d8b862fd.js";import{s as q}from"./slugify-386a61cd.js";import{S as Z}from"./star-5b6e2a22.js";import{c as w,h as H}from"./herbs-ee431b13.js";import{F as X}from"./fuse-11af6271.js";import{S as ee}from"./StarfieldBackground-e8d8cd8d.js";/**
 * @license lucide-react v0.298.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=z("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),se="Unknown",ne="Not well documented";function Y(){const[t,i]=V("herbFavorites",[]);return{favorites:t,toggle:a=>{i(c=>c.includes(a)?c.filter(m=>m!==a):[...c,a])},isFavorite:a=>t.includes(a)}}const ie={Oneirogen:"blue","Dissociative / Sedative":"purple","Empathogen / Euphoriant":"pink","Ritual / Visionary":"green",Other:"yellow"},ae={hidden:{},visible:{transition:{staggerChildren:.05}}},A={hidden:{opacity:0,y:10},visible:{opacity:1,y:0}},R=4,_={mechanismOfAction:"How this herb produces its effects in the body.",toxicity:"Known adverse effects or poisoning information.",therapeuticUses:"Traditional or potential healing applications.",contraindications:"Situations where this herb should be avoided.",dosage:"Common oral or smoked amount for effects."};function oe(t){const i=t.toLowerCase();return i.includes("oneirogen")?"from-indigo-700/40 to-purple-700/40":i.includes("ritual")||i.includes("visionary")?"from-green-800/40 to-blue-800/40":i.includes("stimulant")?"from-orange-700/40 to-red-700/40":"from-white/10 to-white/5"}function re(t,i){let n;if(typeof t=="number"&&(n=t),typeof t=="string"){const o=t.toLowerCase();o==="low"?n=1:o==="moderate"?n=3:o==="high"&&(n=5)}if(i&&/severe|danger/i.test(i))return"danger";if(n!=null)return n<=2?"safe":n<=4?"caution":"danger"}function le({herb:t,highlight:i=""}){var S,d,h;const[n,o]=T.useState(!1),[a,c]=T.useState(!1),m=()=>o(s=>!s),{isFavorite:f,toggle:v}=Y(),j=s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),m())},E=s=>{if(!i)return s;const l=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),u=new RegExp(`(${l})`,"ig");return s.replace(u,'<span class="font-bold text-yellow-300">$1</span>')},k=oe(t.category),N=re(t.safetyRating,t.toxicity);return e.jsxs(x.div,{id:`herb-${t.id}`,layout:!0,initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},exit:{opacity:0,scale:.9},onClick:m,onKeyDown:j,tabIndex:0,role:"button","aria-expanded":n,whileHover:{scale:1.03,boxShadow:"0 0 20px rgba(255,255,255,0.2)",backgroundColor:"rgba(255,255,255,0.1)"},whileTap:{scale:.97},transition:{layout:{duration:.4,ease:"easeInOut"}},className:`hover-glow card-contrast relative cursor-pointer overflow-hidden rounded-2xl bg-gradient-to-br ${k} border border-white/10 p-3 shadow-lg shadow-black/50 ring-1 ring-white/30 backdrop-blur-lg hover:shadow-psychedelic-pink/40 hover:drop-shadow-2xl focus:outline-none focus-visible:shadow-intense focus-visible:ring-2 focus-visible:ring-psychedelic-pink focus-visible:ring-offset-2 focus-visible:ring-offset-space-dark focus-visible:ring-sky-400 focus-visible:ring-4 sm:p-6`,children:[e.jsx(x.span,{initial:{opacity:0,y:-4},whileHover:{opacity:1,y:0},whileTap:{opacity:1,y:0},className:"pointer-events-none absolute right-4 top-2 text-xs text-sand",children:"+ More Info"}),e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[e.jsx("h3",{className:"text-shadow mb-0.5 font-herb text-xl text-white sm:text-2xl",dangerouslySetInnerHTML:{__html:E(t.name)}}),N&&e.jsx("span",{className:`rounded-full px-2 py-0.5 text-xs font-medium shadow ${N==="safe"?"bg-green-700/40 text-green-200 ring-1 ring-green-400/60":N==="caution"?"bg-yellow-700/40 text-yellow-200 ring-1 ring-yellow-400/60":"bg-red-700/40 text-red-200 ring-1 ring-red-500/60"}`,children:N==="safe"?"âœ… Safe":N==="caution"?"âš ï¸ Caution":"â˜ ï¸ High Risk"})]}),t.scientificName&&e.jsx("p",{className:"mt-0.5 text-xs italic text-sand",dangerouslySetInnerHTML:{__html:E(t.scientificName)}}),e.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2 text-sm text-sand sm:text-base",children:[t.category&&e.jsx(M,{label:t.category,variant:ie[t.category]||"purple"}),((S=t.effects)==null?void 0:S.length)>0&&e.jsx("span",{children:t.effects.join(", ")}),t.affiliateLink?e.jsx("span",{className:"rounded bg-lime-700/40 px-2 py-0.5 text-xs text-lime-200",children:"Available Online"}):e.jsx("span",{className:"rounded bg-slate-700/30 px-2 py-0.5 text-xs text-slate-300",children:"âš ï¸ No Link"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),v(t.id)},"aria-label":f(t.id)?"Remove favorite":"Add favorite",className:"rounded-md p-1 text-yellow-400 hover:bg-white/10",children:e.jsx(Z,{fill:f(t.id)?"currentColor":"none",size:18})}),e.jsx(x.span,{layout:!0,initial:!1,animate:{rotate:n?90:0},transition:{duration:.3},className:"text-cyan-200 transition-transform",children:e.jsx(te,{size:18})})]})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[(a||t.tags.length<=R?t.tags:t.tags.slice(0,R)).map(s=>e.jsx(M,{label:F(s),variant:I(s),className:n?"animate-pulse":""},s)),t.tags.length>R&&e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),c(l=>!l)},className:"focus:outline-none",children:e.jsx(M,{label:a?"Show Less":`+${t.tags.length-R} more`,variant:"yellow"})})]}),e.jsx(P,{initial:!1,children:n&&e.jsx(x.div,{layout:!0,initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},transition:{duration:.4,ease:"easeInOut"},className:"mt-4 overflow-hidden whitespace-pre-line break-words text-sm text-sand sm:text-base",children:e.jsxs(x.div,{variants:ae,initial:"hidden",animate:"visible",exit:"hidden",className:"space-y-3",children:[["description","mechanismOfAction","therapeuticUses","sideEffects","contraindications","drugInteractions","preparation","dosage","pharmacokinetics","onset","duration","intensity","region","legalStatus","safetyRating","toxicity","toxicityLD50"].map(s=>{const l=t[s],u=typeof l=="string"&&l.trim()&&l!=="No description provided."?l:s==="mechanismOfAction"||s==="toxicity"||s==="toxicityLD50"?se:ne;return e.jsxs(x.div,{variants:A,children:[e.jsxs("span",{className:"font-semibold text-lime-300",children:[s.replace(/([A-Z])/g," $1")+":",_[s]&&e.jsx(J,{text:_[s]})]})," ",s==="safetyRating"?e.jsx("span",{className:typeof l=="number"?W(l):"",children:u}):u]},s)}),((d=t.activeConstituents)==null?void 0:d.length)>0&&e.jsxs(x.div,{variants:A,children:[e.jsx("span",{className:"font-semibold text-lime-300",children:"Active Compounds:"})," ",t.activeConstituents.map((s,l)=>e.jsxs(p.Fragment,{children:[l>0&&", ",e.jsx(D,{to:`/compounds#${q(s.name)}`,onClick:u=>u.stopPropagation(),className:"hover-glow inline-block rounded px-1 text-sky-300 underline",children:s.name})]},s.name))]}),((h=t.tags)==null?void 0:h.length)>0&&e.jsx(x.div,{variants:A,className:"flex max-h-32 flex-wrap gap-2 overflow-y-auto pt-2",children:t.tags.slice(0,10).map(s=>e.jsx(M,{label:F(s),variant:I(s),className:n?"animate-pulse":""},s))}),e.jsxs(x.div,{variants:A,className:"pt-2",children:[e.jsx(D,{to:`/herbs/${t.id}`,onClick:s=>s.stopPropagation(),className:"text-comet underline focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-psychedelic-pink",children:"View full page"}),t.affiliateLink?e.jsx("a",{href:t.affiliateLink,target:"_blank",rel:"noopener noreferrer",onClick:s=>s.stopPropagation(),className:"ml-4 text-sm text-sky-300 underline focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-psychedelic-pink",children:"ðŸŒ Buy Online"}):e.jsx("span",{className:"ml-4 text-sm text-sand/50",children:"âš ï¸ Buy Online"})]})]})},"content")})]})}const ce={hidden:{},visible:{transition:{staggerChildren:.05}}},de={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},me=({herbs:t,highlightQuery:i="",batchSize:n=24})=>{const[o,a]=p.useState(n),c=()=>a(m=>Math.min(m+n,t.length));return t.length===0?e.jsx("p",{className:"text-center text-sand/80",children:"No herbs match your search."}):e.jsxs(e.Fragment,{children:[e.jsx(x.div,{layout:!0,variants:ce,initial:"hidden",animate:"visible",className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:e.jsx(P,{children:t.slice(0,o).map(m=>e.jsx(x.div,{variants:de,layout:!0,children:e.jsx(le,{herb:m,highlight:i})},m.id||m.name))})},t.map(m=>m.id).join("-")),o<t.length&&e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{type:"button",onClick:c,className:"rounded-md bg-black/30 px-4 py-2 text-sand hover:bg-white/10 backdrop-blur-md",children:"Show More"})})]})},ue=me,fe=["Effect","Preparation","Safety","Chemistry","Region","Other"];function pe({tags:t,onChange:i,storageKey:n="tagFilters",counts:o={}}){const[a,c]=V(n,[]),[m,f]=T.useState({Effect:!0,Preparation:!1,Safety:!1,Chemistry:!1,Region:!1,Other:!1}),[v,j]=T.useState({Effect:!1,Preparation:!1,Safety:!1,Chemistry:!1,Region:!1,Other:!1});T.useEffect(()=>{i==null||i(a)},[a,i]);const E=T.useMemo(()=>{const d={Effect:[],Preparation:[],Safety:[],Chemistry:[],Region:[],Other:[]};return t.forEach(h=>{const s=w($(h)),l=G(s);d[l].includes(s)||d[l].push(s)}),d},[t]),k=d=>{const h=w(d);c(s=>s.includes(h)?s.filter(l=>l!==h):[...s,h])},N=d=>{switch(d){case"Effect":return"âš¡ Effects";case"Preparation":return"ðŸŒ¿ Preparation";case"Safety":return"âš ï¸ Safety";case"Chemistry":return"ðŸ§ª Chemistry";case"Region":return"ðŸ“ Region";default:return"âœ¨ Other"}},S=d=>{const h=E[d]||[],s=12,l=v[d]?h:h.slice(0,s);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"tag-list",children:[l.map(u=>e.jsx(x.button,{type:"button",onClick:()=>k(u),whileHover:{scale:1.1},whileTap:{scale:.95},animate:{opacity:a.includes(u)?1:.6},"aria-pressed":a.includes(u),className:"flex-shrink-0 focus:outline-none",title:o[u]?`${F($(u))} â€” used in ${o[u]} herbs`:F($(u)),children:e.jsx(M,{label:F($(u)),variant:a.includes(u)?"green":I(u),className:Q(a.includes(u)&&"ring-1 ring-emerald-400")})},u)),h.length>s&&e.jsx(x.button,{type:"button",whileHover:{scale:1.05},onClick:()=>j(u=>({...u,[d]:!u[d]})),className:"tag-pill mt-2",children:v[d]?"Show Less":"Show More"})]})})};return e.jsx("div",{className:"sticky top-16 z-20 space-y-3 bg-black/30 backdrop-blur-md p-2 rounded-xl sm:static sm:bg-transparent sm:p-0",children:fe.map(d=>e.jsxs("div",{className:"tag-section",children:[e.jsxs("button",{type:"button",className:"tag-label",onClick:()=>f(h=>({...h,[d]:!h[d]})),"aria-expanded":m[d],children:[N(d),e.jsx(x.span,{animate:{rotate:m[d]?90:0},className:"ml-1 text-xs",children:"â–¶"})]}),e.jsx(P,{initial:!1,children:m[d]&&e.jsx(x.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},children:S(d)},"content")})]},d))})}function he(){const t=p.useMemo(()=>{const n={};return H.forEach(o=>{const a=o.category.split("/")[0].trim();n[a]=(n[a]||0)+1}),n},[]),i=Math.max(...Object.values(t));return e.jsx("div",{className:"space-y-2",children:Object.entries(t).map(([n,o])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-40 text-sm",children:n}),e.jsx("div",{className:"flex-1 bg-slate-700/50 h-2 rounded",children:e.jsx("div",{className:"h-2 rounded bg-fuchsia-500",style:{width:`${o/i*100}%`}})}),e.jsx("span",{className:"text-sm",children:o})]},n))})}function U(t){const i=t.toLowerCase();return/(empathogen|euphoriant)/.test(i)?"Empathogen":/(psychedelic|visionary)/.test(i)?"Psychedelic":/dissociative|sedative/.test(i)?"Dissociative":/oneirogen|dream/.test(i)?"Oneirogen":"Other"}function ge(t,i={}){const{favorites:n=[]}=i,[o,a]=p.useState(""),[c,m]=p.useState([]),[f,v]=p.useState(!0),[j,E]=p.useState(!1),[k,N]=p.useState([]),[S,d]=p.useState(""),h=p.useMemo(()=>new X(t,{keys:["name","altNames","scientificName","effects","tags"],threshold:.4,includeMatches:!0,isCaseSensitive:!1,ignoreLocation:!0}),[t]);return{filtered:p.useMemo(()=>{let l=t;const u=o.trim();return u&&(l=h.search(u).map(b=>b.item)),c.length&&(l=l.filter(b=>f?c.every(L=>b.tags.some(r=>w(r)===w(L))):c.some(L=>b.tags.some(r=>w(r)===w(L))))),k.length&&(l=l.filter(b=>k.includes(U(b.category)))),j&&(l=l.filter(b=>n.includes(b.id))),S==="name"&&(l=[...l].sort((b,L)=>b.name.localeCompare(L.name))),l},[t,o,c,k,j,n,S,h,f]),query:o,setQuery:a,tags:c,setTags:m,matchAll:f,setMatchAll:v,categories:k,setCategories:N,favoritesOnly:j,setFavoritesOnly:E,sort:S,setSort:d,fuse:h}}function xe({selected:t,onChange:i}){const n=p.useMemo(()=>{const a={};return H.forEach(c=>{const m=U(c.category);a[m]=(a[m]||0)+1}),a},[]),o=a=>{const c=t.includes(a)?t.filter(m=>m!==a):[...t,a];i==null||i(c)};return e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(n).sort((a,c)=>c[1]-a[1]).map(([a,c])=>e.jsxs("button",{type:"button",onClick:()=>o(a),className:`tag-pill ${t.includes(a)?"ring-2 ring-emerald-400":""}`,children:[a," (",c,")"]},a))})}function ye(){const[t]=p.useState(H);return p.useEffect(()=>{const i=H.filter(n=>{var o;return!n.affiliateLink||!((o=n.activeConstituents)!=null&&o.length)||!n.mechanismOfAction});i.length&&(console.groupCollapsed("Herb data missing fields"),i.forEach(n=>{var a;const o=[];n.affiliateLink||o.push("affiliateLink"),(a=n.activeConstituents)!=null&&a.length||o.push("activeConstituents"),n.mechanismOfAction||o.push("mechanismOfAction"),console.log(`${n.name}: ${o.join(", ")}`)}),console.groupEnd())},[]),t}function ve({query:t,setQuery:i,fuse:n}){const[o,a]=p.useState([]);p.useEffect(()=>{const f=t.trim();a(f?n.search(f,{limit:5,isCaseSensitive:!1,ignoreLocation:!0}):[])},[t,n]);const c=f=>{if(!t)return f;const v=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),j=new RegExp(`(${v})`,"ig");return f.replace(j,'<span class="font-bold">$1</span>')},m=f=>{const v=[f.item.name,...f.item.altNames||[]].join(", ");return c(v)};return e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",placeholder:"Search herbs...",value:t,onChange:f=>i(f.target.value),className:"w-full rounded-md bg-space-dark/70 px-3 py-2 text-white backdrop-blur-md focus:outline-none"}),o.length>0&&e.jsx("ul",{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-black/80 p-2 text-sm text-sand backdrop-blur-md",children:o.map(f=>e.jsx("li",{children:e.jsx("button",{type:"button",className:"w-full text-left rounded px-2 py-1 hover:bg-white/10",onClick:()=>i(f.item.name),dangerouslySetInnerHTML:{__html:m(f)}})},f.item.id))})]})}function be(t,i){try{const n=localStorage.getItem(t);return n?JSON.parse(n):i}catch{return i}}function B(t,i){try{localStorage.setItem(t,JSON.stringify(i))}catch{}}function Oe(){const t=ye(),{favorites:i}=Y(),{filtered:n,query:o,setQuery:a,tags:c,setTags:m,matchAll:f,setMatchAll:v,categories:j,setCategories:E,favoritesOnly:k,setFavoritesOnly:N,fuse:S}=ge(t,{favorites:i});p.useEffect(()=>{var y;const g=((y=new URLSearchParams(window.location.search).get("herbs"))==null?void 0:y.split(","))||[];g.length&&setTimeout(()=>{g.forEach(C=>{const O=document.getElementById(`herb-${C}`);O&&(O.scrollIntoView({behavior:"smooth"}),O.classList.add("ring-2","ring-sky-300"),setTimeout(()=>O.classList.remove("ring-2","ring-sky-300"),2e3))})},300)},[]),p.useEffect(()=>{const r=be("dbScroll",0);r&&window.scrollTo(0,r);const g=()=>B("dbScroll",window.scrollY);return window.addEventListener("scroll",g),()=>{B("dbScroll",window.scrollY),window.removeEventListener("scroll",g)}},[]);const d=p.useMemo(()=>{const r=t.reduce((g,y)=>g.concat(y.tags),[]);return Array.from(new Set(r.map(w)))},[t]),h=p.useMemo(()=>{const r={};return t.forEach(g=>{g.tags.forEach(y=>{const C=w(y);r[C]=(r[C]||0)+1})}),r},[t]),[s,l]=p.useState(!1),[u,b]=p.useState(!0);p.useEffect(()=>{let r=window.scrollY;const g=()=>{const y=window.scrollY;b(y<r||y<100),r=y};return window.addEventListener("scroll",g),()=>window.removeEventListener("scroll",g)},[]),p.useEffect(()=>{const r=()=>{window.scrollY>150&&l(!1)};return window.addEventListener("scroll",r),window.addEventListener("touchmove",r),()=>{window.removeEventListener("scroll",r),window.removeEventListener("touchmove",r)}},[]);const L=p.useMemo(()=>{if(c.length===0)return[];const r={};return t.forEach(g=>{c.every(y=>g.tags.some(C=>w(C)===w(y)))&&g.tags.forEach(y=>{const C=w(y);c.some(O=>w(O)===C)||(r[C]=(r[C]||0)+1)})}),Object.entries(r).sort((g,y)=>y[1]-g[1]).slice(0,5).map(([g])=>g)},[c,t]);return e.jsxs(e.Fragment,{children:[e.jsxs(K,{children:[e.jsx("title",{children:"Database - The Hippie Scientist"}),e.jsx("meta",{name:"description",content:"Browse herbal entries and expand each to learn more about their effects and usage."})]}),e.jsxs("div",{className:"relative min-h-screen px-4 pt-20",children:[e.jsx(ee,{}),e.jsxs("div",{className:"relative mx-auto max-w-6xl",children:[e.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-gradient mb-6 text-5xl font-bold",children:"Herb Database"}),e.jsx("p",{className:"mx-auto max-w-4xl text-xl text-sand",children:"Explore our collection of herbs. Click any entry to see detailed information."})]}),e.jsxs(x.div,{className:"sticky top-2 z-20 mb-4 flex flex-wrap items-center gap-2",animate:{y:u?0:-60,opacity:u?1:0},transition:{duration:.3},children:[e.jsx(ve,{query:o,setQuery:a,fuse:S}),e.jsx("button",{type:"button",onClick:()=>N(r=>!r),className:"rounded-md bg-space-dark/70 px-3 py-2 text-sm text-yellow-300 backdrop-blur-md hover:bg-white/10",children:k?"All Herbs":"My Herbs"}),e.jsx("button",{type:"button",onClick:()=>v(r=>!r),className:"hover-glow rounded-md bg-space-dark/70 px-3 py-2 text-sm text-sand backdrop-blur-md hover:bg-white/10",children:f?"Match ALL":"Match ANY"}),e.jsx("button",{type:"button",onClick:()=>l(r=>!r),className:"rounded-md bg-space-dark/70 px-3 py-2 text-sm text-sand backdrop-blur-md hover:bg-white/10 sm:hidden",children:s?"Hide Filters":"Show Filters"})]}),e.jsxs("div",{className:`mb-4 space-y-4 ${s?"":"hidden sm:block"}`,children:[e.jsx(xe,{selected:j,onChange:E}),e.jsx(pe,{tags:d,counts:h,onChange:m})]}),L.length>0&&e.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-sm text-moss",children:"Related tags:"}),L.map(r=>e.jsx("button",{type:"button",onClick:()=>m(g=>Array.from(new Set([...g,r]))),className:"tag-pill",children:F(r)},r))]}),e.jsx(he,{}),e.jsx(ue,{herbs:n,highlightQuery:o})]})]})]})}export{Oe as default};
