import{l as P,R as p,j as e,n as T,m as h,r as S,L as _,W as V}from"./main-0354fb16.js";import{d as N,t as F,s as B,n as E,a as z}from"./format-5969a492.js";import{u as I,T as C,c as U}from"./useLocalStorage-04eadfb8.js";import{S as K}from"./star-1c6f3e8c.js";import{h as M}from"./herbs-7604592b.js";import{F as Y}from"./fuse-11af6271.js";import{S as W}from"./StarfieldBackground-f9fa46ce.js";/**
 * @license lucide-react v0.298.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=P("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),J="Unknown",Q="Not well documented";function A(){const[t,a]=I("herbFavorites",[]);return{favorites:t,toggle:i=>{a(d=>d.includes(i)?d.filter(o=>o!==i):[...d,i])},isFavorite:i=>t.includes(i)}}function q({text:t,children:a}){const[r,l]=p.useState(!1);return e.jsxs("span",{className:"relative inline-block",onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),onFocus:()=>l(!0),onBlur:()=>l(!1),onTouchStart:()=>l(i=>!i),children:[a||e.jsx("span",{className:"ml-1 cursor-help select-none text-sand",children:"‚ÑπÔ∏è"}),e.jsx(T,{children:r&&e.jsx(h.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},transition:{duration:.2},className:"absolute left-1/2 z-50 mt-1 w-56 -translate-x-1/2 rounded-md bg-black/80 p-2 text-xs text-white backdrop-blur",children:t})})]})}const Z={Oneirogen:"blue","Dissociative / Sedative":"purple","Empathogen / Euphoriant":"pink","Ritual / Visionary":"green",Other:"yellow"},X={hidden:{},visible:{transition:{staggerChildren:.05}}},L={hidden:{opacity:0,y:10},visible:{opacity:1,y:0}},O=4,$={mechanismOfAction:"How this herb produces its effects in the body.",toxicity:"Known adverse effects or poisoning information.",therapeuticUses:"Traditional or potential healing applications.",contraindications:"Situations where this herb should be avoided."};function ee(t){const a=t.toLowerCase();return a.includes("oneirogen")?"from-indigo-700/40 to-purple-700/40":a.includes("ritual")||a.includes("visionary")?"from-green-800/40 to-blue-800/40":a.includes("stimulant")?"from-orange-700/40 to-red-700/40":"from-white/10 to-white/5"}function te(t,a){let r;if(typeof t=="number"&&(r=t),typeof t=="string"){const l=t.toLowerCase();l==="low"?r=1:l==="moderate"?r=3:l==="high"&&(r=5)}if(a&&/severe|danger/i.test(a))return"danger";if(r!=null)return r<=2?"safe":r<=4?"caution":"danger"}function se({herb:t,highlight:a=""}){var b,u;const[r,l]=S.useState(!1),[i,d]=S.useState(!1),o=()=>l(s=>!s),{isFavorite:x,toggle:y}=A(),v=s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),o())},j=s=>{if(!a)return s;const m=a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),n=new RegExp(`(${m})`,"ig");return s.replace(n,'<span class="font-bold text-yellow-300">$1</span>')},w=ee(t.category),g=te(t.safetyRating,t.toxicity);return e.jsxs(h.div,{layout:!0,initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},exit:{opacity:0,scale:.9},onClick:o,onKeyDown:v,tabIndex:0,role:"button","aria-expanded":r,whileHover:{scale:1.03,boxShadow:"0 0 20px rgba(255,255,255,0.2)",backgroundColor:"rgba(255,255,255,0.1)"},whileTap:{scale:.97},transition:{layout:{duration:.4,ease:"easeInOut"}},className:`hover-glow card-contrast relative cursor-pointer overflow-hidden rounded-2xl bg-gradient-to-br ${w} border border-white/10 p-4 shadow-lg shadow-black/50 ring-1 ring-white/30 backdrop-blur-md hover:shadow-psychedelic-pink/40 hover:drop-shadow-xl focus:outline-none focus-visible:shadow-intense focus-visible:ring-2 focus-visible:ring-psychedelic-pink sm:p-6`,children:[e.jsx(h.span,{initial:{opacity:0,y:-4},whileHover:{opacity:1,y:0},whileTap:{opacity:1,y:0},className:"pointer-events-none absolute right-4 top-2 text-xs text-sand",children:"+ More Info"}),e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[e.jsx("h3",{className:"text-shadow mb-0.5 font-herb text-xl text-white sm:text-2xl",dangerouslySetInnerHTML:{__html:j(t.name)}}),g&&e.jsx("span",{className:`rounded-full px-2 py-0.5 text-xs font-medium shadow ${g==="safe"?"bg-green-700/40 text-green-200 ring-1 ring-green-400/60":g==="caution"?"bg-yellow-700/40 text-yellow-200 ring-1 ring-yellow-400/60":"bg-red-700/40 text-red-200 ring-1 ring-red-500/60"}`,children:g==="safe"?"‚úÖ Safe":g==="caution"?"‚ö†Ô∏è Caution":"‚ò†Ô∏è High Risk"})]}),t.scientificName&&e.jsx("p",{className:"mt-0.5 text-xs italic text-sand",dangerouslySetInnerHTML:{__html:j(t.scientificName)}}),e.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2 text-sm text-sand sm:text-base",children:[t.category&&e.jsx(C,{label:t.category,variant:Z[t.category]||"purple"}),((b=t.effects)==null?void 0:b.length)>0&&e.jsx("span",{children:t.effects.join(", ")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),y(t.id)},"aria-label":x(t.id)?"Remove favorite":"Add favorite",className:"rounded-md p-1 text-yellow-400 hover:bg-white/10",children:e.jsx(K,{fill:x(t.id)?"currentColor":"none",size:18})}),e.jsx(h.span,{layout:!0,initial:!1,animate:{rotate:r?90:0},transition:{duration:.3},className:"text-cyan-200 transition-transform",children:e.jsx(G,{size:18})})]})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[(i||t.tags.length<=O?t.tags:t.tags.slice(0,O)).map(s=>e.jsx(C,{label:N(s),variant:F(s),className:r?"animate-pulse":""},s)),t.tags.length>O&&e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),d(m=>!m)},className:"focus:outline-none",children:e.jsx(C,{label:i?"Show Less":`+${t.tags.length-O} more`,variant:"yellow"})})]}),e.jsx(T,{initial:!1,children:r&&e.jsx(h.div,{layout:!0,initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},transition:{duration:.4,ease:"easeInOut"},className:"mt-4 overflow-hidden whitespace-pre-line break-words text-sm text-sand sm:text-base",children:e.jsxs(h.div,{variants:X,initial:"hidden",animate:"visible",exit:"hidden",className:"space-y-3",children:[["description","mechanismOfAction","therapeuticUses","sideEffects","contraindications","drugInteractions","preparation","pharmacokinetics","onset","duration","intensity","region","legalStatus","safetyRating","toxicity","toxicityLD50"].map(s=>{const m=t[s],n=typeof m=="string"&&m.trim()&&m!=="No description provided."?m:s==="mechanismOfAction"||s==="toxicity"||s==="toxicityLD50"?J:Q;return e.jsxs(h.div,{variants:L,children:[e.jsxs("span",{className:"font-semibold text-lime-300",children:[s.replace(/([A-Z])/g," $1")+":",$[s]&&e.jsx(q,{text:$[s]})]})," ",s==="safetyRating"?e.jsx("span",{className:typeof m=="number"?B(m):"",children:n}):n]},s)}),((u=t.tags)==null?void 0:u.length)>0&&e.jsx(h.div,{variants:L,className:"flex max-h-32 flex-wrap gap-2 overflow-y-auto pt-2",children:t.tags.slice(0,10).map(s=>e.jsx(C,{label:N(s),variant:F(s),className:r?"animate-pulse":""},s))}),e.jsx(h.div,{variants:L,className:"pt-2",children:e.jsx(_,{to:`/herbs/${t.id}`,onClick:s=>s.stopPropagation(),className:"text-comet underline",children:"View full page"})})]})},"content")})]})}const ae={hidden:{},visible:{transition:{staggerChildren:.05}}},ne={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},ie=({herbs:t,highlightQuery:a="",batchSize:r=24})=>{const[l,i]=p.useState(r),d=()=>i(o=>Math.min(o+r,t.length));return t.length===0?e.jsx("p",{className:"text-center text-sand/80",children:"No herbs match your search."}):e.jsxs(e.Fragment,{children:[e.jsx(h.div,{layout:!0,variants:ae,initial:"hidden",animate:"visible",className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:e.jsx(T,{children:t.slice(0,l).map(o=>e.jsx(h.div,{variants:ne,layout:!0,children:e.jsx(se,{herb:o,highlight:a})},o.id||o.name))})},t.map(o=>o.id).join("-")),l<t.length&&e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{type:"button",onClick:d,className:"rounded-md bg-black/30 px-4 py-2 text-sand hover:bg-white/10 backdrop-blur-md",children:"Show More"})})]})},re=ie,oe={"root bark":"root",bark:"root",tryptamine:"alkaloid",phenethylamine:"alkaloid"};function k(t){const a=N(t).toLowerCase().trim();return oe[a]||a}const le=["Effect","Preparation","Safety","Chemistry","Region","Other"];function ce({tags:t,onChange:a,storageKey:r="tagFilters",counts:l={}}){const[i,d]=I(r,[]),[o,x]=S.useState({Effect:!0,Preparation:!1,Safety:!1,Chemistry:!1,Region:!1,Other:!1}),[y,v]=S.useState({Effect:!1,Preparation:!1,Safety:!1,Chemistry:!1,Region:!1,Other:!1});S.useEffect(()=>{a==null||a(i)},[i,a]);const j=S.useMemo(()=>{const u={Effect:[],Preparation:[],Safety:[],Chemistry:[],Region:[],Other:[]};return t.forEach(s=>{const m=k(E(s)),n=z(m);u[n].includes(m)||u[n].push(m)}),u},[t]),w=u=>{const s=k(u);d(m=>m.includes(s)?m.filter(n=>n!==s):[...m,s])},g=u=>{switch(u){case"Effect":return"‚ö° Effects";case"Preparation":return"üåø Preparation";case"Safety":return"‚ö†Ô∏è Safety";case"Chemistry":return"üß™ Chemistry";case"Region":return"üìç Region";default:return"‚ú® Other"}},b=u=>{const s=j[u]||[],m=12,n=y[u]?s:s.slice(0,m);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"tag-list",children:[n.map(c=>e.jsx(h.button,{type:"button",onClick:()=>w(c),whileHover:{scale:1.1},whileTap:{scale:.95},animate:{opacity:i.includes(c)?1:.6},"aria-pressed":i.includes(c),className:"flex-shrink-0 focus:outline-none",title:l[c]?`${N(E(c))} ‚Äî used in ${l[c]} herbs`:N(E(c)),children:e.jsx(C,{label:N(E(c)),variant:i.includes(c)?"green":F(c),className:U(i.includes(c)&&"ring-1 ring-emerald-400")})},c)),s.length>m&&e.jsx(h.button,{type:"button",whileHover:{scale:1.05},onClick:()=>v(c=>({...c,[u]:!c[u]})),className:"tag-pill mt-2",children:y[u]?"Show Less":"Show More"})]})})};return e.jsx("div",{className:"space-y-3",children:le.map(u=>e.jsxs("div",{className:"tag-section",children:[e.jsxs("button",{type:"button",className:"tag-label",onClick:()=>x(s=>({...s,[u]:!s[u]})),"aria-expanded":o[u],children:[g(u),e.jsx(h.span,{animate:{rotate:o[u]?90:0},className:"ml-1 text-xs",children:"‚ñ∂"})]}),e.jsx(T,{initial:!1,children:o[u]&&e.jsx(h.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},children:b(u)},"content")})]},u))})}function de(){const t=p.useMemo(()=>{const r={};return M.forEach(l=>{const i=l.category.split("/")[0].trim();r[i]=(r[i]||0)+1}),r},[]),a=Math.max(...Object.values(t));return e.jsx("div",{className:"space-y-2",children:Object.entries(t).map(([r,l])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-40 text-sm",children:r}),e.jsx("div",{className:"flex-1 bg-slate-700/50 h-2 rounded",children:e.jsx("div",{className:"h-2 rounded bg-fuchsia-500",style:{width:`${l/a*100}%`}})}),e.jsx("span",{className:"text-sm",children:l})]},r))})}function D(t){const a=t.toLowerCase();return/(empathogen|euphoriant)/.test(a)?"Empathogen":/(psychedelic|visionary)/.test(a)?"Psychedelic":/dissociative|sedative/.test(a)?"Dissociative":/oneirogen|dream/.test(a)?"Oneirogen":"Other"}function ue(t,a={}){const{favorites:r=[]}=a,[l,i]=p.useState(""),[d,o]=p.useState([]),[x,y]=p.useState(!1),[v,j]=p.useState([]),[w,g]=p.useState(""),b=p.useMemo(()=>new Y(t,{keys:["name","scientificName","effects","description","tags"],threshold:.4,includeMatches:!0}),[t]);return{filtered:p.useMemo(()=>{let s=t;const m=l.trim();return m&&(s=b.search(m).map(n=>n.item)),d.length&&(s=s.filter(n=>d.every(c=>n.tags.some(f=>k(f)===k(c))))),v.length&&(s=s.filter(n=>v.includes(D(n.category)))),x&&(s=s.filter(n=>r.includes(n.id))),w==="name"&&(s=[...s].sort((n,c)=>n.name.localeCompare(c.name))),s},[t,l,d,v,x,r,w,b]),query:l,setQuery:i,tags:d,setTags:o,categories:v,setCategories:j,favoritesOnly:x,setFavoritesOnly:y,sort:w,setSort:g,fuse:b}}function me({selected:t,onChange:a}){const r=p.useMemo(()=>{const i={};return M.forEach(d=>{const o=D(d.category);i[o]=(i[o]||0)+1}),i},[]),l=i=>{const d=t.includes(i)?t.filter(o=>o!==i):[...t,i];a==null||a(d)};return e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(r).sort((i,d)=>d[1]-i[1]).map(([i,d])=>e.jsxs("button",{type:"button",onClick:()=>l(i),className:`tag-pill ${t.includes(i)?"ring-2 ring-emerald-400":""}`,children:[i," (",d,")"]},i))})}function pe(){const[t]=p.useState(M);return t}function he({query:t,setQuery:a,fuse:r}){const[l,i]=p.useState([]);p.useEffect(()=>{const o=t.trim();i(o?r.search(o,{limit:5}):[])},[t,r]);const d=o=>{if(!t)return o;const x=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),y=new RegExp(`(${x})`,"ig");return o.replace(y,'<span class="font-bold">$1</span>')};return e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",placeholder:"Search herbs...",value:t,onChange:o=>a(o.target.value),className:"w-full rounded-md bg-space-dark/70 px-3 py-2 text-white backdrop-blur-md focus:outline-none"}),l.length>0&&e.jsx("ul",{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-black/80 p-2 text-sm text-sand backdrop-blur-md",children:l.map(o=>e.jsx("li",{children:e.jsx("button",{type:"button",className:"w-full text-left hover:bg-white/10 px-2 py-1 rounded",onClick:()=>a(o.item.name),dangerouslySetInnerHTML:{__html:d(o.item.name)}})},o.item.id))})]})}function fe(t,a){try{const r=localStorage.getItem(t);return r?JSON.parse(r):a}catch{return a}}function H(t,a){try{localStorage.setItem(t,JSON.stringify(a))}catch{}}function Ne(){const t=pe(),{favorites:a}=A(),{filtered:r,query:l,setQuery:i,tags:d,setTags:o,categories:x,setCategories:y,favoritesOnly:v,setFavoritesOnly:j,fuse:w}=ue(t,{favorites:a});p.useEffect(()=>{const n=fe("dbScroll",0);n&&window.scrollTo(0,n);const c=()=>H("dbScroll",window.scrollY);return window.addEventListener("scroll",c),()=>{H("dbScroll",window.scrollY),window.removeEventListener("scroll",c)}},[]);const g=p.useMemo(()=>{const n=t.reduce((c,f)=>c.concat(f.tags),[]);return Array.from(new Set(n.map(k)))},[t]),b=p.useMemo(()=>{const n={};return t.forEach(c=>{c.tags.forEach(f=>{const R=k(f);n[R]=(n[R]||0)+1})}),n},[t]),[u,s]=p.useState(!1);p.useEffect(()=>{const n=()=>{window.scrollY>150&&s(!1)};return window.addEventListener("scroll",n),window.addEventListener("touchmove",n),()=>{window.removeEventListener("scroll",n),window.removeEventListener("touchmove",n)}},[]);const m=p.useMemo(()=>{if(d.length===0)return[];const n={};return t.forEach(c=>{d.every(f=>c.tags.includes(f))&&c.tags.forEach(f=>{d.includes(f)||(n[f]=(n[f]||0)+1)})}),Object.entries(n).sort((c,f)=>f[1]-c[1]).slice(0,5).map(([c])=>c)},[d,t]);return e.jsxs(e.Fragment,{children:[e.jsxs(V,{children:[e.jsx("title",{children:"Database - The Hippie Scientist"}),e.jsx("meta",{name:"description",content:"Browse herbal entries and expand each to learn more about their effects and usage."})]}),e.jsxs("div",{className:"relative min-h-screen px-4 pt-20",children:[e.jsx(W,{}),e.jsxs("div",{className:"relative mx-auto max-w-6xl",children:[e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-gradient mb-6 text-5xl font-bold",children:"Herb Database"}),e.jsx("p",{className:"mx-auto max-w-4xl text-xl text-gray-300",children:"Explore our collection of herbs. Click any entry to see detailed information."})]}),e.jsxs("div",{className:"sticky top-2 z-20 mb-4 flex flex-wrap items-center gap-2",children:[e.jsx(he,{query:l,setQuery:i,fuse:w}),e.jsx("button",{type:"button",onClick:()=>j(n=>!n),className:"rounded-md bg-space-dark/70 px-3 py-2 text-sm text-yellow-300 backdrop-blur-md hover:bg-white/10",children:v?"All Herbs":"My Herbs"}),e.jsx("button",{type:"button",onClick:()=>s(n=>!n),className:"rounded-md bg-space-dark/70 px-3 py-2 text-sm text-sand backdrop-blur-md hover:bg-white/10 sm:hidden",children:u?"Hide Filters":"Show Filters"})]}),e.jsxs("div",{className:`mb-4 space-y-4 ${u?"":"hidden sm:block"}`,children:[e.jsx(me,{selected:x,onChange:y}),e.jsx(ce,{tags:g,counts:b,onChange:o})]}),m.length>0&&e.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-sm text-moss",children:"Related tags:"}),m.map(n=>e.jsx("button",{type:"button",onClick:()=>o(c=>Array.from(new Set([...c,n]))),className:"tag-pill",children:N(n)},n))]}),e.jsx(de,{}),e.jsx(re,{herbs:r,highlightQuery:l})]})]})]})}export{Ne as default};
