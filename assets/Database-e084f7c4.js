import{r as x,j as e,m as p,n as C,R as m,W as F}from"./main-96fc9696.js";import{l as O,f as R,u as T,H as M}from"./index-6f6041e7.js";import{u as S,T as H,c as P,h as E}from"./herbs-46ffaabe.js";import{a as A,d as y,n as w,t as z}from"./format-d7efe303.js";import{F as B}from"./fuse-11af6271.js";import"./star-7c848edd.js";const D=["Effect","Preparation","Safety","Chemistry","Region","Other"];function $({tags:r,onChange:c,storageKey:l="tagFilters",counts:o={}}){const[i,g]=S(l,[]),[f,d]=x.useState({Effect:!0,Preparation:!1,Safety:!1,Chemistry:!1,Region:!1,Other:!1}),[h,j]=x.useState({Effect:!1,Preparation:!1,Safety:!1,Chemistry:!1,Region:!1,Other:!1});x.useEffect(()=>{c==null||c(i)},[i,c]);const v=x.useMemo(()=>{const s={Effect:[],Preparation:[],Safety:[],Chemistry:[],Region:[],Other:[]};return r.forEach(t=>{const u=A(t);s[u].push(t)}),s},[r]),N=s=>{g(t=>t.includes(s)?t.filter(u=>u!==s):[...t,s])},b=s=>{switch(s){case"Effect":return"âš¡ Effects";case"Preparation":return"ðŸŒ¿ Preparation";case"Safety":return"âš ï¸ Safety";case"Chemistry":return"ðŸ§ª Chemistry";case"Region":return"ðŸ“ Region";default:return"âœ¨ Other"}},a=s=>{const t=v[s]||[],u=12,k=h[s]?t:t.slice(0,u);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"tag-list",children:[k.map(n=>e.jsx(p.button,{type:"button",onClick:()=>N(n),whileHover:{scale:1.1},whileTap:{scale:.95},animate:{opacity:i.includes(n)?1:.6},"aria-pressed":i.includes(n),className:"flex-shrink-0 focus:outline-none",title:o[n]?`${y(w(n))} â€” used in ${o[n]} herbs`:y(w(n)),children:e.jsx(H,{label:y(w(n)),variant:i.includes(n)?"green":z(n),className:P(i.includes(n)&&"ring-1 ring-emerald-400")})},n)),t.length>u&&e.jsx(p.button,{type:"button",whileHover:{scale:1.05},onClick:()=>j(n=>({...n,[s]:!n[s]})),className:"tag-pill mt-2",children:h[s]?"Show Less":"Show More"})]})})};return e.jsx("div",{className:"space-y-3",children:D.map(s=>e.jsxs("div",{className:"tag-section",children:[e.jsxs("button",{type:"button",className:"tag-label",onClick:()=>d(t=>({...t,[s]:!t[s]})),"aria-expanded":f[s],children:[b(s),e.jsx(p.span,{animate:{rotate:f[s]?90:0},className:"ml-1 text-xs",children:"â–¶"})]}),e.jsx(C,{initial:!1,children:f[s]&&e.jsx(p.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},children:a(s)},"content")})]},s))})}function L(){const r=m.useMemo(()=>{const l={};return E.forEach(o=>{const i=o.category.split("/")[0].trim();l[i]=(l[i]||0)+1}),l},[]),c=Math.max(...Object.values(r));return e.jsx("div",{className:"space-y-2",children:Object.entries(r).map(([l,o])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-40 text-sm",children:l}),e.jsx("div",{className:"flex-1 bg-slate-700/50 h-2 rounded",children:e.jsx("div",{className:"h-2 rounded bg-fuchsia-500",style:{width:`${o/c*100}%`}})}),e.jsx("span",{className:"text-sm",children:o})]},l))})}function q(){const r=x.useCallback(async c=>{await O(c)},[]);return e.jsx(R,{id:"starfield",init:r,options:{fullScreen:{enable:!0,zIndex:-10},background:{color:"transparent"},particles:{number:{value:100,density:{enable:!0,area:800}},color:{value:["#ffffff","#ffaadf","#c1ffdd"]},size:{value:{min:.5,max:1.5}},move:{enable:!0,speed:.15},opacity:{value:{min:.1,max:.6}}}}})}function G(){const[r]=m.useState(E);return r}function J(){const r=G(),{favorites:c}=T(),[l,o]=S("herbFavoritesOnly",!1),[i,g]=m.useState(""),f=m.useMemo(()=>new B(r,{keys:["name","tags","effects"],threshold:.3}),[r]),[d,h]=m.useState([]),j=m.useMemo(()=>{const a=r.reduce((s,t)=>s.concat(t.tags),[]);return Array.from(new Set(a))},[r]),v=m.useMemo(()=>{const a={};return r.forEach(s=>{s.tags.forEach(t=>{a[t]=(a[t]||0)+1})}),a},[r]),N=m.useMemo(()=>{let a=r;const s=i.trim();return s&&(a=f.search(s).map(t=>t.item)),d.length&&(a=a.filter(t=>d.every(u=>t.tags.includes(u)))),l&&(a=a.filter(t=>c.includes(t.id))),a},[r,i,d,l,c]),b=m.useMemo(()=>{if(d.length===0)return[];const a={};return r.forEach(s=>{d.every(t=>s.tags.includes(t))&&s.tags.forEach(t=>{d.includes(t)||(a[t]=(a[t]||0)+1)})}),Object.entries(a).sort((s,t)=>t[1]-s[1]).slice(0,5).map(([s])=>s)},[d,r]);return e.jsxs(e.Fragment,{children:[e.jsxs(F,{children:[e.jsx("title",{children:"Database - The Hippie Scientist"}),e.jsx("meta",{name:"description",content:"Browse herbal entries and expand each to learn more about their effects and usage."})]}),e.jsxs("div",{className:"relative min-h-screen px-4 pt-20",children:[e.jsx(q,{}),e.jsxs("div",{className:"relative mx-auto max-w-6xl",children:[e.jsxs(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-gradient mb-6 text-5xl font-bold",children:"Herb Database"}),e.jsx("p",{className:"mx-auto max-w-4xl text-xl text-gray-300",children:"Explore our collection of herbs. Click any entry to see detailed information."})]}),e.jsxs("div",{className:"sticky top-2 z-20 mb-4 flex flex-wrap items-center gap-2",children:[e.jsx("input",{type:"text",placeholder:"Search herbs...",value:i,onChange:a=>g(a.target.value),className:"flex-1 rounded-md bg-space-dark/70 px-3 py-2 text-white backdrop-blur-md focus:outline-none"}),e.jsx("button",{type:"button",onClick:()=>o(a=>!a),className:"rounded-md bg-space-dark/70 px-3 py-2 text-sm text-yellow-300 backdrop-blur-md hover:bg-white/10",children:l?"All Herbs":"Favorites"})]}),e.jsx("div",{className:"mb-4",children:e.jsx($,{tags:j,counts:v,onChange:h})}),b.length>0&&e.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-sm text-moss",children:"Related tags:"}),b.map(a=>e.jsx("button",{type:"button",onClick:()=>h(s=>Array.from(new Set([...s,a]))),className:"tag-pill",children:y(a)},a))]}),e.jsx(L,{}),e.jsx(M,{herbs:N})]})]})]})}export{J as default};
