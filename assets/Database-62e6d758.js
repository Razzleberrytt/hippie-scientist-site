import{l as P,r as N,j as e,m as f,n as F,L as _,R as p,W as V}from"./main-d7352f1b.js";import{d as S,t as T,s as B,n as E,a as z}from"./format-5969a492.js";import{u as I,T as k,I as U,c as C,a as K}from"./useLocalStorage-c4e6ea2e.js";import{S as Y}from"./star-8692bf55.js";import{h as M}from"./herbs-7604592b.js";import{F as W}from"./fuse-11af6271.js";import{S as G}from"./StarfieldBackground-bbdb5e48.js";/**
 * @license lucide-react v0.298.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=P("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Q="Unknown",q="Not well documented";function A(){const[t,n]=I("herbFavorites",[]);return{favorites:t,toggle:a=>{n(d=>d.includes(a)?d.filter(o=>o!==a):[...d,a])},isFavorite:a=>t.includes(a)}}const Z={Oneirogen:"blue","Dissociative / Sedative":"purple","Empathogen / Euphoriant":"pink","Ritual / Visionary":"green",Other:"yellow"},X={hidden:{},visible:{transition:{staggerChildren:.05}}},L={hidden:{opacity:0,y:10},visible:{opacity:1,y:0}},O=4,$={mechanismOfAction:"How this herb produces its effects in the body.",toxicity:"Known adverse effects or poisoning information.",therapeuticUses:"Traditional or potential healing applications.",contraindications:"Situations where this herb should be avoided."};function ee(t){const n=t.toLowerCase();return n.includes("oneirogen")?"from-indigo-700/40 to-purple-700/40":n.includes("ritual")||n.includes("visionary")?"from-green-800/40 to-blue-800/40":n.includes("stimulant")?"from-orange-700/40 to-red-700/40":"from-white/10 to-white/5"}function te(t,n){let r;if(typeof t=="number"&&(r=t),typeof t=="string"){const c=t.toLowerCase();c==="low"?r=1:c==="moderate"?r=3:c==="high"&&(r=5)}if(n&&/severe|danger/i.test(n))return"danger";if(r!=null)return r<=2?"safe":r<=4?"caution":"danger"}function se({herb:t,highlight:n=""}){var b,u;const[r,c]=N.useState(!1),[a,d]=N.useState(!1),o=()=>c(s=>!s),{isFavorite:x,toggle:y}=A(),v=s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),o())},j=s=>{if(!n)return s;const m=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),i=new RegExp(`(${m})`,"ig");return s.replace(i,'<span class="font-bold text-yellow-300">$1</span>')},w=ee(t.category),g=te(t.safetyRating,t.toxicity);return e.jsxs(f.div,{layout:!0,initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},exit:{opacity:0,scale:.9},onClick:o,onKeyDown:v,tabIndex:0,role:"button","aria-expanded":r,whileHover:{scale:1.03,boxShadow:"0 0 20px rgba(255,255,255,0.2)",backgroundColor:"rgba(255,255,255,0.1)"},whileTap:{scale:.97},transition:{layout:{duration:.4,ease:"easeInOut"}},className:`hover-glow card-contrast relative cursor-pointer overflow-hidden rounded-2xl bg-gradient-to-br ${w} border border-white/10 p-4 shadow-lg shadow-black/50 ring-1 ring-white/30 backdrop-blur-lg hover:drop-shadow-2xl hover:shadow-psychedelic-pink/40 focus:outline-none focus-visible:shadow-intense focus-visible:ring-2 focus-visible:ring-psychedelic-pink sm:p-6`,children:[e.jsx(f.span,{initial:{opacity:0,y:-4},whileHover:{opacity:1,y:0},whileTap:{opacity:1,y:0},className:"pointer-events-none absolute right-4 top-2 text-xs text-sand",children:"+ More Info"}),e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[e.jsx("h3",{className:"text-shadow mb-0.5 font-herb text-xl text-white sm:text-2xl",dangerouslySetInnerHTML:{__html:j(t.name)}}),g&&e.jsx("span",{className:`rounded-full px-2 py-0.5 text-xs font-medium shadow ${g==="safe"?"bg-green-700/40 text-green-200 ring-1 ring-green-400/60":g==="caution"?"bg-yellow-700/40 text-yellow-200 ring-1 ring-yellow-400/60":"bg-red-700/40 text-red-200 ring-1 ring-red-500/60"}`,children:g==="safe"?"âœ… Safe":g==="caution"?"âš ï¸ Caution":"â˜ ï¸ High Risk"})]}),t.scientificName&&e.jsx("p",{className:"mt-0.5 text-xs italic text-sand",dangerouslySetInnerHTML:{__html:j(t.scientificName)}}),e.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2 text-sm text-sand sm:text-base",children:[t.category&&e.jsx(k,{label:t.category,variant:Z[t.category]||"purple"}),((b=t.effects)==null?void 0:b.length)>0&&e.jsx("span",{children:t.effects.join(", ")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),y(t.id)},"aria-label":x(t.id)?"Remove favorite":"Add favorite",className:"rounded-md p-1 text-yellow-400 hover:bg-white/10",children:e.jsx(Y,{fill:x(t.id)?"currentColor":"none",size:18})}),e.jsx(f.span,{layout:!0,initial:!1,animate:{rotate:r?90:0},transition:{duration:.3},className:"text-cyan-200 transition-transform",children:e.jsx(J,{size:18})})]})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[(a||t.tags.length<=O?t.tags:t.tags.slice(0,O)).map(s=>e.jsx(k,{label:S(s),variant:T(s),className:r?"animate-pulse":""},s)),t.tags.length>O&&e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),d(m=>!m)},className:"focus:outline-none",children:e.jsx(k,{label:a?"Show Less":`+${t.tags.length-O} more`,variant:"yellow"})})]}),e.jsx(F,{initial:!1,children:r&&e.jsx(f.div,{layout:!0,initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},transition:{duration:.4,ease:"easeInOut"},className:"mt-4 overflow-hidden whitespace-pre-line break-words text-sm text-sand sm:text-base",children:e.jsxs(f.div,{variants:X,initial:"hidden",animate:"visible",exit:"hidden",className:"space-y-3",children:[["description","mechanismOfAction","therapeuticUses","sideEffects","contraindications","drugInteractions","preparation","pharmacokinetics","onset","duration","intensity","region","legalStatus","safetyRating","toxicity","toxicityLD50"].map(s=>{const m=t[s],i=typeof m=="string"&&m.trim()&&m!=="No description provided."?m:s==="mechanismOfAction"||s==="toxicity"||s==="toxicityLD50"?Q:q;return e.jsxs(f.div,{variants:L,children:[e.jsxs("span",{className:"font-semibold text-lime-300",children:[s.replace(/([A-Z])/g," $1")+":",$[s]&&e.jsx(U,{text:$[s]})]})," ",s==="safetyRating"?e.jsx("span",{className:typeof m=="number"?B(m):"",children:i}):i]},s)}),((u=t.tags)==null?void 0:u.length)>0&&e.jsx(f.div,{variants:L,className:"flex max-h-32 flex-wrap gap-2 overflow-y-auto pt-2",children:t.tags.slice(0,10).map(s=>e.jsx(k,{label:S(s),variant:T(s),className:r?"animate-pulse":""},s))}),e.jsxs(f.div,{variants:L,className:"pt-2",children:[e.jsx(_,{to:`/herbs/${t.id}`,onClick:s=>s.stopPropagation(),className:"text-comet underline",children:"View full page"}),t.affiliateLink&&e.jsx("a",{href:t.affiliateLink,target:"_blank",rel:"noopener noreferrer",onClick:s=>s.stopPropagation(),className:"ml-4 text-sm text-sky-300 underline",children:"ðŸŒ Buy Online"})]})]})},"content")})]})}const ie={hidden:{},visible:{transition:{staggerChildren:.05}}},ne={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},ae=({herbs:t,highlightQuery:n="",batchSize:r=24})=>{const[c,a]=p.useState(r),d=()=>a(o=>Math.min(o+r,t.length));return t.length===0?e.jsx("p",{className:"text-center text-sand/80",children:"No herbs match your search."}):e.jsxs(e.Fragment,{children:[e.jsx(f.div,{layout:!0,variants:ie,initial:"hidden",animate:"visible",className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:e.jsx(F,{children:t.slice(0,c).map(o=>e.jsx(f.div,{variants:ne,layout:!0,children:e.jsx(se,{herb:o,highlight:n})},o.id||o.name))})},t.map(o=>o.id).join("-")),c<t.length&&e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{type:"button",onClick:d,className:"rounded-md bg-black/30 px-4 py-2 text-sand hover:bg-white/10 backdrop-blur-md",children:"Show More"})})]})},re=ae,oe=["Effect","Preparation","Safety","Chemistry","Region","Other"];function le({tags:t,onChange:n,storageKey:r="tagFilters",counts:c={}}){const[a,d]=I(r,[]),[o,x]=N.useState({Effect:!0,Preparation:!1,Safety:!1,Chemistry:!1,Region:!1,Other:!1}),[y,v]=N.useState({Effect:!1,Preparation:!1,Safety:!1,Chemistry:!1,Region:!1,Other:!1});N.useEffect(()=>{n==null||n(a)},[a,n]);const j=N.useMemo(()=>{const u={Effect:[],Preparation:[],Safety:[],Chemistry:[],Region:[],Other:[]};return t.forEach(s=>{const m=C(E(s)),i=z(m);u[i].includes(m)||u[i].push(m)}),u},[t]),w=u=>{const s=C(u);d(m=>m.includes(s)?m.filter(i=>i!==s):[...m,s])},g=u=>{switch(u){case"Effect":return"âš¡ Effects";case"Preparation":return"ðŸŒ¿ Preparation";case"Safety":return"âš ï¸ Safety";case"Chemistry":return"ðŸ§ª Chemistry";case"Region":return"ðŸ“ Region";default:return"âœ¨ Other"}},b=u=>{const s=j[u]||[],m=12,i=y[u]?s:s.slice(0,m);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"tag-list",children:[i.map(l=>e.jsx(f.button,{type:"button",onClick:()=>w(l),whileHover:{scale:1.1},whileTap:{scale:.95},animate:{opacity:a.includes(l)?1:.6},"aria-pressed":a.includes(l),className:"flex-shrink-0 focus:outline-none",title:c[l]?`${S(E(l))} â€” used in ${c[l]} herbs`:S(E(l)),children:e.jsx(k,{label:S(E(l)),variant:a.includes(l)?"green":T(l),className:K(a.includes(l)&&"ring-1 ring-emerald-400")})},l)),s.length>m&&e.jsx(f.button,{type:"button",whileHover:{scale:1.05},onClick:()=>v(l=>({...l,[u]:!l[u]})),className:"tag-pill mt-2",children:y[u]?"Show Less":"Show More"})]})})};return e.jsx("div",{className:"space-y-3 sticky top-16 z-20 sm:static",children:oe.map(u=>e.jsxs("div",{className:"tag-section",children:[e.jsxs("button",{type:"button",className:"tag-label",onClick:()=>x(s=>({...s,[u]:!s[u]})),"aria-expanded":o[u],children:[g(u),e.jsx(f.span,{animate:{rotate:o[u]?90:0},className:"ml-1 text-xs",children:"â–¶"})]}),e.jsx(F,{initial:!1,children:o[u]&&e.jsx(f.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},children:b(u)},"content")})]},u))})}function ce(){const t=p.useMemo(()=>{const r={};return M.forEach(c=>{const a=c.category.split("/")[0].trim();r[a]=(r[a]||0)+1}),r},[]),n=Math.max(...Object.values(t));return e.jsx("div",{className:"space-y-2",children:Object.entries(t).map(([r,c])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-40 text-sm",children:r}),e.jsx("div",{className:"flex-1 bg-slate-700/50 h-2 rounded",children:e.jsx("div",{className:"h-2 rounded bg-fuchsia-500",style:{width:`${c/n*100}%`}})}),e.jsx("span",{className:"text-sm",children:c})]},r))})}function D(t){const n=t.toLowerCase();return/(empathogen|euphoriant)/.test(n)?"Empathogen":/(psychedelic|visionary)/.test(n)?"Psychedelic":/dissociative|sedative/.test(n)?"Dissociative":/oneirogen|dream/.test(n)?"Oneirogen":"Other"}function de(t,n={}){const{favorites:r=[]}=n,[c,a]=p.useState(""),[d,o]=p.useState([]),[x,y]=p.useState(!1),[v,j]=p.useState([]),[w,g]=p.useState(""),b=p.useMemo(()=>new W(t,{keys:["name","scientificName","effects","description","tags"],threshold:.4,includeMatches:!0,isCaseSensitive:!1,ignoreLocation:!0}),[t]);return{filtered:p.useMemo(()=>{let s=t;const m=c.trim();return m&&(s=b.search(m).map(i=>i.item)),d.length&&(s=s.filter(i=>d.every(l=>i.tags.some(h=>C(h)===C(l))))),v.length&&(s=s.filter(i=>v.includes(D(i.category)))),x&&(s=s.filter(i=>r.includes(i.id))),w==="name"&&(s=[...s].sort((i,l)=>i.name.localeCompare(l.name))),s},[t,c,d,v,x,r,w,b]),query:c,setQuery:a,tags:d,setTags:o,categories:v,setCategories:j,favoritesOnly:x,setFavoritesOnly:y,sort:w,setSort:g,fuse:b}}function ue({selected:t,onChange:n}){const r=p.useMemo(()=>{const a={};return M.forEach(d=>{const o=D(d.category);a[o]=(a[o]||0)+1}),a},[]),c=a=>{const d=t.includes(a)?t.filter(o=>o!==a):[...t,a];n==null||n(d)};return e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(r).sort((a,d)=>d[1]-a[1]).map(([a,d])=>e.jsxs("button",{type:"button",onClick:()=>c(a),className:`tag-pill ${t.includes(a)?"ring-2 ring-emerald-400":""}`,children:[a," (",d,")"]},a))})}function me(){const[t]=p.useState(M);return t}function pe({query:t,setQuery:n,fuse:r}){const[c,a]=p.useState([]);p.useEffect(()=>{const o=t.trim();a(o?r.search(o,{limit:5,isCaseSensitive:!1,ignoreLocation:!0}):[])},[t,r]);const d=o=>{if(!t)return o;const x=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),y=new RegExp(`(${x})`,"ig");return o.replace(y,'<span class="font-bold">$1</span>')};return e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",placeholder:"Search herbs...",value:t,onChange:o=>n(o.target.value),className:"w-full rounded-md bg-space-dark/70 px-3 py-2 text-white backdrop-blur-md focus:outline-none"}),c.length>0&&e.jsx("ul",{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-black/80 p-2 text-sm text-sand backdrop-blur-md",children:c.map(o=>e.jsx("li",{children:e.jsx("button",{type:"button",className:"w-full text-left hover:bg-white/10 px-2 py-1 rounded",onClick:()=>n(o.item.name),dangerouslySetInnerHTML:{__html:d(o.item.name)}})},o.item.id))})]})}function fe(t,n){try{const r=localStorage.getItem(t);return r?JSON.parse(r):n}catch{return n}}function H(t,n){try{localStorage.setItem(t,JSON.stringify(n))}catch{}}function je(){const t=me(),{favorites:n}=A(),{filtered:r,query:c,setQuery:a,tags:d,setTags:o,categories:x,setCategories:y,favoritesOnly:v,setFavoritesOnly:j,fuse:w}=de(t,{favorites:n});p.useEffect(()=>{const i=fe("dbScroll",0);i&&window.scrollTo(0,i);const l=()=>H("dbScroll",window.scrollY);return window.addEventListener("scroll",l),()=>{H("dbScroll",window.scrollY),window.removeEventListener("scroll",l)}},[]);const g=p.useMemo(()=>{const i=t.reduce((l,h)=>l.concat(h.tags),[]);return Array.from(new Set(i.map(C)))},[t]),b=p.useMemo(()=>{const i={};return t.forEach(l=>{l.tags.forEach(h=>{const R=C(h);i[R]=(i[R]||0)+1})}),i},[t]),[u,s]=p.useState(!1);p.useEffect(()=>{const i=()=>{window.scrollY>150&&s(!1)};return window.addEventListener("scroll",i),window.addEventListener("touchmove",i),()=>{window.removeEventListener("scroll",i),window.removeEventListener("touchmove",i)}},[]);const m=p.useMemo(()=>{if(d.length===0)return[];const i={};return t.forEach(l=>{d.every(h=>l.tags.includes(h))&&l.tags.forEach(h=>{d.includes(h)||(i[h]=(i[h]||0)+1)})}),Object.entries(i).sort((l,h)=>h[1]-l[1]).slice(0,5).map(([l])=>l)},[d,t]);return e.jsxs(e.Fragment,{children:[e.jsxs(V,{children:[e.jsx("title",{children:"Database - The Hippie Scientist"}),e.jsx("meta",{name:"description",content:"Browse herbal entries and expand each to learn more about their effects and usage."})]}),e.jsxs("div",{className:"relative min-h-screen px-4 pt-20",children:[e.jsx(G,{}),e.jsxs("div",{className:"relative mx-auto max-w-6xl",children:[e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-gradient mb-6 text-5xl font-bold",children:"Herb Database"}),e.jsx("p",{className:"mx-auto max-w-4xl text-xl text-sand",children:"Explore our collection of herbs. Click any entry to see detailed information."})]}),e.jsxs("div",{className:"sticky top-2 z-20 mb-4 flex flex-wrap items-center gap-2",children:[e.jsx(pe,{query:c,setQuery:a,fuse:w}),e.jsx("button",{type:"button",onClick:()=>j(i=>!i),className:"rounded-md bg-space-dark/70 px-3 py-2 text-sm text-yellow-300 backdrop-blur-md hover:bg-white/10",children:v?"All Herbs":"My Herbs"}),e.jsx("button",{type:"button",onClick:()=>s(i=>!i),className:"rounded-md bg-space-dark/70 px-3 py-2 text-sm text-sand backdrop-blur-md hover:bg-white/10 sm:hidden",children:u?"Hide Filters":"Show Filters"})]}),e.jsxs("div",{className:`mb-4 space-y-4 ${u?"":"hidden sm:block"}`,children:[e.jsx(ue,{selected:x,onChange:y}),e.jsx(le,{tags:g,counts:b,onChange:o})]}),m.length>0&&e.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-sm text-moss",children:"Related tags:"}),m.map(i=>e.jsx("button",{type:"button",onClick:()=>o(l=>Array.from(new Set([...l,i]))),className:"tag-pill",children:S(i)},i))]}),e.jsx(ce,{}),e.jsx(re,{herbs:r,highlightQuery:c})]})]})]})}export{je as default};
