import{n as E,j as e,m as u,e as T,R as c,h as M,p as P,q as y,W as V,C as _,L as G,D as J}from"./main-0d350f8e.js";import{F as U}from"./FadeInSection-2691533c.js";import{H as W}from"./HerbList-a2a3d3e3.js";import{m as Z,u as Q}from"./useFilteredHerbs-6ed97ac1.js";import{S as q}from"./StarfieldBackground-a5956442.js";import{u as K}from"./useHerbs-978ad958.js";/**
 * @license lucide-react v0.298.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=E("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.298.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=E("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);function te({allTags:a,activeTags:r,onToggleTag:d}){const x=t=>{d(t)},o=()=>{r.forEach(t=>d(t))},l={hidden:{},visible:{transition:{staggerChildren:.05}}},h={hidden:{opacity:0,y:10},visible:{opacity:1,y:0}};return e.jsxs(u.div,{variants:l,initial:"hidden",animate:"visible",className:"no-scrollbar flex gap-2 overflow-x-auto py-2",children:[a.map(t=>{const m=r.includes(t);return e.jsx(u.button,{variants:h,type:"button",onClick:()=>x(t),whileTap:{scale:.9},whileHover:{scale:1.08},animate:m?{scale:[1,1.15,1],boxShadow:"0 0 8px rgba(16,185,129,0.8)"}:{scale:1,boxShadow:"none"},transition:{type:"spring",stiffness:220,damping:12},className:`tag-pill hover-glow whitespace-nowrap transition-colors duration-300 ${m?"bg-emerald-700/70 text-white ring-2 ring-emerald-400 dark:bg-emerald-800":"bg-space-dark/70 text-sand dark:bg-gray-800 dark:text-gray-200"}`,children:T(t)},t)}),r.length>0&&e.jsx(u.button,{type:"button",onClick:o,whileTap:{scale:.9},whileHover:{scale:1.08},transition:{type:"spring",stiffness:220,damping:12},className:"tag-pill hover-glow whitespace-nowrap bg-rose-700/70 text-white dark:bg-rose-800 transition-colors duration-300",children:"Clear Filters"})]})}const L=5;function se(){const a=c.useMemo(()=>{const t={};return M.forEach(m=>{const p=m.category.split("/")[0].trim();t[p]=(t[p]||0)+1}),t},[]),r=c.useMemo(()=>Object.entries(a).sort((t,m)=>m[1]-t[1]),[a]),[d,x]=c.useState(!1),o=c.useMemo(()=>d?r:r.slice(0,L),[r,d]),l=r.length>L,h=Math.max(...r.map(([,t])=>t));return e.jsxs(u.div,{layout:!0,className:"space-y-2",children:[o.map(([t,m])=>e.jsxs(u.div,{layout:!0,className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-40 text-sm",children:t}),e.jsx("div",{className:"h-2 flex-1 rounded bg-gray-200 transition-colors duration-300 dark:bg-gray-700",children:e.jsx("div",{className:"h-2 rounded bg-pink-500 transition-colors duration-300 dark:bg-pink-400",style:{width:`${m/h*100}%`}})}),e.jsx("span",{className:"text-sm",children:m})]},t)),l&&e.jsx(u.button,{layout:!0,type:"button",onClick:()=>x(t=>!t),className:"mx-auto block text-xs text-moss hover:underline",children:d?"Show Less":"Show More"})]})}function ae({selected:a,onChange:r}){const d=c.useMemo(()=>{const o={};return M.forEach(l=>{const h=Z(l.category);o[h]=(o[h]||0)+1}),o},[]),x=o=>{const l=a.includes(o)?a.filter(h=>h!==o):[...a,o];r==null||r(l)};return e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(d).sort((o,l)=>l[1]-o[1]).map(([o,l])=>e.jsxs("button",{type:"button",onClick:()=>x(o),className:`tag-pill transition-colors duration-300 ${a.includes(o)?"ring-2 ring-emerald-400 bg-emerald-700/70 text-white dark:bg-emerald-800":"bg-space-dark/70 text-sand dark:bg-gray-800 dark:text-gray-200"}`,children:[o," (",l,")"]},o))})}function ne({query:a,setQuery:r,fuse:d}){const[x,o]=c.useState([]);c.useEffect(()=>{const t=a.trim();o(t?d.search(t,{limit:5,isCaseSensitive:!1,ignoreLocation:!0}):[])},[a,d]);const l=t=>{if(!a)return t;const m=a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),p=new RegExp(`(${m})`,"ig");return t.replace(p,'<span class="font-bold">$1</span>')},h=t=>{const m=[t.item.name,...t.item.altNames||[]].join(", ");return l(m)};return e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",placeholder:"Search herbs...","aria-label":"Search herbs",tabIndex:0,value:a,onChange:t=>r(t.target.value),className:"w-full rounded-md bg-space-dark/70 px-3 py-2 text-white backdrop-blur-md focus:outline-none"}),x.length>0&&e.jsx("ul",{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-black/80 p-2 text-sm text-sand backdrop-blur-md",children:x.map(t=>e.jsx("li",{children:e.jsx("button",{type:"button",tabIndex:0,"aria-label":`Select ${t.item.name}`,className:"w-full text-left rounded px-2 py-1 hover:bg-white/10",onClick:()=>r(t.item.name),dangerouslySetInnerHTML:{__html:h(t)}})},t.item.id))})]})}function re(a,r){try{const d=localStorage.getItem(a);return d?JSON.parse(d):r}catch{return r}}function C(a,r){try{localStorage.setItem(a,JSON.stringify(r))}catch{}}function he(){const a=K(),{favorites:r}=P(),{filtered:d,query:x,setQuery:o,tags:l,setTags:h,matchAll:t,setMatchAll:m,categories:p,setCategories:A,favoritesOnly:F,setFavoritesOnly:H,sort:O,setSort:$,fuse:I}=Q(a,{favorites:r});c.useEffect(()=>{var i;const n=((i=new URLSearchParams(window.location.search).get("herbs"))==null?void 0:i.split(","))||[];n.length&&setTimeout(()=>{n.forEach(g=>{const b=document.getElementById(`herb-${g}`);b&&(b.scrollIntoView({behavior:"smooth"}),b.classList.add("ring-2","ring-sky-300"),setTimeout(()=>b.classList.remove("ring-2","ring-sky-300"),2e3))})},300)},[]),c.useEffect(()=>{const s=re("dbScroll",0);s&&window.scrollTo(0,s);const n=()=>C("dbScroll",window.scrollY);return window.addEventListener("scroll",n),()=>{C("dbScroll",window.scrollY),window.removeEventListener("scroll",n)}},[]);const B=c.useMemo(()=>{const s=a.reduce((n,i)=>n.concat(i.tags),[]);return Array.from(new Set(s.map(y)))},[a]),f=c.useMemo(()=>{const s=a.filter(i=>i.affiliateLink&&i.affiliateLink.startsWith("http")).length,n=a.filter(i=>i.mechanismOfAction&&i.mechanismOfAction.trim()).length;return{total:a.length,affiliates:s,moaCount:n}},[a]),D=c.useCallback(s=>h(n=>n.includes(s)?n.filter(i=>i!==s):[...n,s]),[h]),[w,v]=c.useState(!1),[k,R]=c.useState(!0),[j,Y]=c.useState("grid"),[N,z]=c.useState(!1);c.useEffect(()=>{let s=window.scrollY;const n=()=>{const i=window.scrollY;R(i<s||i<100),s=i};return window.addEventListener("scroll",n),()=>window.removeEventListener("scroll",n)},[]),c.useEffect(()=>{const s=()=>{window.scrollY>150&&v(!1)};return window.addEventListener("scroll",s),window.addEventListener("touchmove",s),()=>{window.removeEventListener("scroll",s),window.removeEventListener("touchmove",s)}},[]);const S=c.useMemo(()=>{if(l.length===0)return[];const s={};return a.forEach(n=>{l.every(i=>n.tags.some(g=>y(g)===y(i)))&&n.tags.forEach(i=>{const g=y(i);l.some(b=>y(b)===g)||(s[g]=(s[g]||0)+1)})}),Object.entries(s).sort((n,i)=>i[1]-n[1]).slice(0,5).map(([n])=>n)},[l,a]);return e.jsxs(e.Fragment,{children:[e.jsxs(V,{children:[e.jsx("title",{children:"Database - The Hippie Scientist"}),e.jsx("meta",{name:"description",content:"Browse herbal entries and expand each to learn more about their effects and usage."})]}),e.jsxs("div",{className:"relative min-h-screen px-4 pt-20",children:[e.jsx(q,{}),e.jsxs(_,{className:"relative lg:flex lg:items-start lg:gap-8",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-gradient mb-6 text-5xl font-bold",children:"Herb Database"}),e.jsx("p",{className:"mx-auto max-w-4xl text-xl text-sand",children:"Explore our collection of herbs. Click any entry to see detailed information."})]}),e.jsxs(u.div,{className:"sticky top-2 z-20 mb-4 flex flex-wrap items-center gap-2",animate:{y:k?0:-60,opacity:k?1:0},transition:{duration:.3},children:[e.jsx(ne,{query:x,setQuery:o,fuse:I}),e.jsx("button",{type:"button",onClick:()=>Y(s=>s==="grid"?"list":"grid"),className:"rounded-md bg-space-dark/70 p-2 text-sand backdrop-blur-md hover:bg-white/10","aria-label":"Toggle view",children:j==="grid"?e.jsx(ee,{size:18}):e.jsx(X,{size:18})}),e.jsx("button",{type:"button",onClick:()=>H(s=>!s),className:"rounded-md bg-space-dark/70 px-3 py-2 text-sm text-yellow-300 backdrop-blur-md hover:bg-white/10",children:F?"All Herbs":"My Herbs"}),e.jsx("button",{type:"button",onClick:()=>m(s=>!s),className:"hover-glow rounded-md bg-space-dark/70 px-3 py-2 text-sm text-sand backdrop-blur-md hover:bg-white/10",children:t?"Match ALL":"Match ANY"}),e.jsxs("select",{value:O,onChange:s=>$(s.target.value),className:"rounded-md bg-space-dark/70 px-3 py-2 text-sm text-sand backdrop-blur-md hover:bg-white/10",children:[e.jsx("option",{value:"",children:"Sort By..."}),e.jsx("option",{value:"name",children:"Alphabetical (A–Z)"}),e.jsx("option",{value:"category",children:"Category"}),e.jsx("option",{value:"intensity",children:"Psychoactive Intensity"}),e.jsx("option",{value:"blend",children:"Blend-Friendliness"})]}),e.jsx(G,{to:"/downloads",className:"rounded-md bg-space-dark/70 p-2 text-sand backdrop-blur-md hover:bg-white/10","aria-label":"Export data",children:e.jsx(J,{size:18})}),e.jsx("button",{type:"button",onClick:()=>v(s=>!s),className:"rounded-md bg-space-dark/70 px-3 py-2 text-sm text-sand backdrop-blur-md hover:bg-white/10 sm:hidden",children:w?"Hide Filters":"Show Filters"})]}),e.jsxs("div",{className:`mb-4 space-y-4 ${w?"":"hidden sm:block"}`,children:[e.jsx(ae,{selected:p,onChange:A}),e.jsx(te,{allTags:B,activeTags:l,onToggleTag:D})]}),S.length>0&&e.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-sm text-moss",children:"Related tags:"}),S.map(s=>e.jsx("button",{type:"button",onClick:()=>h(n=>Array.from(new Set([...n,s]))),className:"tag-pill",children:T(s)},s))]}),e.jsx("button",{type:"button",onClick:()=>z(s=>!s),className:"mb-4 rounded-md bg-space-dark/70 px-3 py-2 text-sm text-sand backdrop-blur-md hover:bg-white/10 lg:hidden",children:N?"Hide Stats":"Show Stats"}),e.jsx(U,{children:e.jsx(W,{herbs:d,highlightQuery:x,view:j})}),e.jsxs("footer",{className:"mt-4 text-center text-sm text-moss",children:["Total herbs: ",f.total," · Affiliate links: ",f.affiliates," · MOA documented"," ",f.moaCount," · Updated: ",new Date("2025-07-25T15:11:41.967Z").toLocaleDateString()]})]}),e.jsx("aside",{className:`mt-6 lg:mt-0 lg:w-72 lg:sticky lg:top-24 ${N?"":"hidden lg:block"}`,children:e.jsx(se,{})})]})]})]})}export{he as default};
