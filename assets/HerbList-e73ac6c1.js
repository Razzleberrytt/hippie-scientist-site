import{l as W,R as v,r as T,p as q,j as e,m as c,A as R,L as O}from"./main-1c70c059.js";import{d as L,t as A,s as G,e as Z}from"./format-b20dbf99.js";import{T as w,I as z}from"./TagBadge-0db78c8b.js";import{u as F,C as J}from"./useLocalStorage-228218fa.js";import{s as Q}from"./slugify-386a61cd.js";import{S as X}from"./star-38be0712.js";/**
 * @license lucide-react v0.298.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=W("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),ee="Unknown",te="Not well documented";function ie(){const[i,n]=F("favorites",[]);return{favorites:i,toggle:l=>{n(s=>s.includes(l)?s.filter(m=>m!==l):[...s,l])},isFavorite:l=>i.includes(l)}}function M(){try{return localStorage.getItem("isAdmin")==="true"}catch{return!1}}const se={Oneirogen:"blue","Dissociative / Sedative":"purple","Empathogen / Euphoriant":"pink","Ritual / Visionary":"green",Other:"yellow"},ne={hidden:{},visible:{transition:{staggerChildren:.05}}},N={hidden:{opacity:0,y:10},visible:{opacity:1,y:0}},k=3,_={mechanismOfAction:"How this herb produces its effects in the body.",toxicity:"Known adverse effects or poisoning information.",therapeuticUses:"Traditional or potential healing applications.",contraindications:"Situations where this herb should be avoided.",dosage:"Common oral or smoked amount for effects."},ae=["description","mechanismOfAction","therapeuticUses","sideEffects","contraindications","drugInteractions","preparation","dosage","pharmacokinetics","onset","duration","intensity","region","legalStatus","safetyRating","toxicity","toxicityLD50"],oe=["description","preparation","dosage","onset","duration","intensity"];function re(i){const n=i.toLowerCase();return n.includes("oneirogen")?"from-indigo-700/40 to-purple-700/40":n.includes("ritual")||n.includes("visionary")?"from-green-800/40 to-blue-800/40":n.includes("stimulant")?"from-orange-700/40 to-red-700/40":"from-white/10 to-white/5"}function le(i,n){let r;if(typeof i=="number"&&(r=i),typeof i=="string"){const d=i.toLowerCase();d==="low"?r=1:d==="moderate"?r=3:d==="high"&&(r=5)}if(n&&/severe|danger/i.test(n))return"danger";if(r!=null)return r<=2?"safe":r<=4?"caution":"danger"}function ce({herb:i,highlight:n="",matches:r=[],compact:d=!1}){var $,H;const[l,s]=T.useState(!1),[m,x]=T.useState(!1),[a,u]=F(`tags-${i.id}`,i.tags),V=q(),[g,D]=T.useState(!1),I=()=>{localStorage.setItem("focusHerb",i.id),V(`/herb/${i.id}`)},{isFavorite:S,toggle:U}=ie(),K=t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),I())},P=t=>{if(!n)return t;const o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),p=new RegExp(`(${o})`,"ig");return t.replace(p,'<mark class="rounded bg-yellow-500/40 px-1">$1</mark>')},b=(t,o,p)=>{const h=r.find(y=>y.key===o&&(p==null||y.refIndex===p));if(!h||!h.indices)return P(t);let j="",C=0;return h.indices.forEach(([y,E])=>{j+=t.slice(C,y),j+=`<mark class="rounded bg-yellow-500/40 px-1">${t.slice(y,E+1)}</mark>`,C=E+1}),j+=t.slice(C),j},B=re(i.category),f=le(i.safetyRating,i.toxicity);return e.jsxs(c.div,{id:i.id,layout:!0,initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},exit:{opacity:0,scale:.9},onClick:I,onKeyDown:K,tabIndex:0,role:"button","aria-expanded":g,whileHover:{scale:1.03,boxShadow:"0 0 20px rgba(255,255,255,0.2)",backgroundColor:"rgba(255,255,255,0.1)"},whileTap:{scale:.97},transition:{layout:{duration:.4,ease:"easeInOut"}},className:`hover-glow card-contrast relative cursor-pointer overflow-hidden rounded-2xl bg-gradient-to-br ${B} border border-white/10 ${d?"p-2 sm:p-3":"p-4 sm:p-6"} shadow-lg shadow-black/50 ring-1 ring-white/30 backdrop-blur-lg hover:shadow-psychedelic-pink/40 hover:drop-shadow-2xl focus:outline-none focus-visible:shadow-intense focus-visible:ring-2 focus-visible:ring-psychedelic-pink`,children:[!d&&e.jsx(c.span,{initial:{opacity:0,y:-4},whileHover:{opacity:1,y:0},whileTap:{opacity:1,y:0},className:"pointer-events-none absolute right-4 top-2 text-xs text-sand",children:"+ More Info"}),e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[e.jsx("h3",{className:"text-shadow mb-0.5 font-herb text-xl text-white sm:text-2xl",dangerouslySetInnerHTML:{__html:b(i.name,"name")}}),f&&e.jsx("span",{className:`rounded-full px-2 py-0.5 text-xs font-medium shadow ${f==="safe"?"bg-green-700/40 text-green-200 ring-1 ring-green-400/60":f==="caution"?"bg-yellow-700/40 text-yellow-200 ring-1 ring-yellow-400/60":"bg-red-700/40 text-red-200 ring-1 ring-red-500/60"}`,children:f==="safe"?"âœ… Safe":f==="caution"?"âš ï¸ Caution":"â˜ ï¸ High Risk"})]}),i.scientificName&&e.jsx("p",{className:"mt-0.5 text-xs italic text-sand",dangerouslySetInnerHTML:{__html:b(i.scientificName,"scientificName")}}),e.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2 text-sm text-sand sm:text-base",children:[i.category&&e.jsx(w,{label:i.category,variant:se[i.category]||"purple"}),(($=i.effects)==null?void 0:$.length)>0&&e.jsx("span",{dangerouslySetInnerHTML:{__html:b(i.effects.join(", "),"effects")}})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),U(i.id)},"aria-label":S(i.id)?"Remove favorite":"Add favorite",className:"rounded-md p-1 text-yellow-400 hover:bg-white/10",children:e.jsx(X,{fill:S(i.id)?"currentColor":"none",size:18})}),e.jsx(c.span,{layout:!0,initial:!1,animate:{rotate:d?0:g?90:0},transition:{duration:.3},className:"text-cyan-200 transition-transform",onClick:t=>{t.stopPropagation(),D(o=>!o)},children:d?g?"-":"+":e.jsx(Y,{size:18})})]})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[(l||a.length<=k?a:a.slice(0,k)).map(t=>e.jsx(w,{label:L(t),variant:A(t),className:g?"animate-pulse":""},t)),a.length>k&&e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),s(o=>!o)},className:"focus:outline-none",children:e.jsx(w,{label:l?"Show Less":`+${a.length-k} more`,variant:"yellow"})})]}),e.jsx(R,{initial:!1,children:g&&e.jsx(c.div,{layout:!0,initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},transition:{duration:.4,ease:"easeInOut"},className:"mt-4 overflow-hidden whitespace-pre-line break-words text-sm text-sand sm:text-base",children:e.jsxs(c.div,{variants:ne,initial:"hidden",animate:"visible",exit:"hidden",className:"space-y-3",children:[(d?oe:ae).map(t=>{const o=i[t],p=typeof o=="string"&&o.trim()&&o!=="No description provided."?o:t==="mechanismOfAction"||t==="toxicity"||t==="toxicityLD50"?ee:te;return e.jsxs(c.div,{variants:N,children:[e.jsxs("span",{className:"font-semibold text-lime-300",children:[t.replace(/([A-Z])/g," $1")+":",_[t]&&e.jsx(z,{text:_[t]})]})," ",t==="safetyRating"?e.jsx("span",{className:typeof o=="number"?G(o):"",children:p}):e.jsx("span",{dangerouslySetInnerHTML:{__html:b(String(p),t)}})]},t)}),((H=i.activeConstituents)==null?void 0:H.length)>0&&e.jsxs(c.div,{variants:N,children:[e.jsx("span",{className:"font-semibold text-lime-300",children:"Active Compounds:"})," ",i.activeConstituents.map((t,o)=>e.jsxs(v.Fragment,{children:[o>0&&", ",e.jsx(J,{name:t.name,children:e.jsx(O,{to:`/compounds?compound=${Q(t.name)}`,onClick:p=>p.stopPropagation(),className:"hover-glow inline-block rounded px-1 text-sky-300 underline",children:t.name})})]},t.name))]}),(a==null?void 0:a.length)>0&&e.jsx(c.div,{variants:N,className:"flex max-h-32 flex-wrap gap-2 overflow-y-auto pt-2",children:a.slice(0,10).map(t=>e.jsx(w,{label:L(t),variant:A(t),className:g?"animate-pulse":""},t))}),e.jsxs(c.div,{variants:N,className:"pt-2",children:[e.jsx(O,{to:`/herb/${i.id}`,onClick:t=>{t.stopPropagation(),localStorage.setItem("focusHerb",i.id)},className:"text-comet underline",children:"View full page"}),M()&&e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),x(!0)},className:"ml-4 text-sand underline",children:"Edit Tags"}),i.affiliateLink&&e.jsx("a",{href:i.affiliateLink,target:"_blank",rel:"noopener noreferrer",onClick:t=>t.stopPropagation(),className:"ml-4 inline-block min-h-[44px] text-sm text-sky-300 underline",children:"ðŸŒ Buy Online"})]})]})},"content")}),M()&&m&&e.jsx(c.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur",children:e.jsxs(c.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"max-h-[80vh] overflow-y-auto rounded-md bg-midnight p-4 text-white",children:[e.jsx("h3",{className:"mb-2 text-lg font-bold",children:"Edit Tags"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.keys(Z).map(t=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:a.includes(t),onChange:o=>u(p=>o.target.checked?[...p,t]:p.filter(h=>h!==t)),className:"rounded focus-visible:ring-2 focus-visible:ring-psychedelic-pink"}),L(t)]},t))}),e.jsx("div",{className:"mt-4 text-right",children:e.jsx("button",{type:"button",onClick:()=>{console.log("Updated tags",a),x(!1)},className:"rounded bg-psychedelic-purple px-3 py-1",children:"Save"})})]})})]})}const de=v.memo(ce),pe=({currentPage:i,totalPages:n,onPageChange:r})=>{const l=(()=>{if(n<=7)return Array.from({length:n},(a,u)=>u+1);const s=[1],m=Math.max(2,i-1),x=Math.min(n-1,i+1);m>2&&s.push("â€¦");for(let a=m;a<=x;a++)s.push(a);return x<n-1&&s.push("â€¦"),s.push(n),s})();return e.jsxs("div",{className:"mx-auto mb-8 mt-4 flex flex-wrap justify-center gap-2",children:[e.jsx("button",{type:"button",disabled:i===1,onClick:()=>r(i-1),className:"rounded px-2 py-1 text-sm text-sand disabled:opacity-50",children:"Prev"}),l.map((s,m)=>typeof s=="number"?e.jsx(c.button,{whileHover:{scale:1.1},onClick:()=>r(s),className:`w-8 rounded px-2 py-1 text-center text-sm ${s===i?"bg-cosmic-purple text-white":"text-sand"}`,children:s},s):e.jsx("span",{className:"w-8 px-2 py-1 text-center text-sand",children:s},`ellipsis-${m}`)),e.jsx("button",{type:"button",disabled:i===n,onClick:()=>r(i+1),className:"rounded px-2 py-1 text-sm text-sand disabled:opacity-50",children:"Next"})]})},me={hidden:{},visible:{transition:{staggerChildren:.05}}},ue={hidden:{opacity:0,y:20},visible:{opacity:1,y:0},exit:{opacity:0,y:-20}},xe=v.memo(({herbs:i,highlightQuery:n="",matches:r={},compact:d=!1,pageSize:l=30})=>{const[s,m]=v.useState(1),x=Math.ceil(i.length/l),a=v.useMemo(()=>i.slice((s-1)*l,s*l),[i,s,l]);return i.length===0?e.jsx("p",{className:"text-center text-sand/80",children:"No herbs match your search."}):e.jsxs(e.Fragment,{children:[e.jsx(c.div,{layout:!0,variants:me,initial:"hidden",animate:"visible",className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:e.jsx(R,{children:a.map(u=>e.jsx(c.div,{variants:ue,layout:!0,exit:"exit",children:e.jsx(de,{herb:u,highlight:n,matches:r[u.id],compact:d})},u.id||u.name))})},a.map(u=>u.id).join("-")),x>1&&e.jsx(pe,{currentPage:s,totalPages:x,onPageChange:m})]})}),je=xe;export{je as H,ie as u};
