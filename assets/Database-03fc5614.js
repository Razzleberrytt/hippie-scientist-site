import{l as A,R as p,j as e,n as O,m as h,r as N,L as D,W as P}from"./main-3f262c91.js";import{d as S,t as L,s as _,n as C,a as V}from"./format-5969a492.js";import{u as $,T as E,c as B}from"./useLocalStorage-e29f1d80.js";import{S as z}from"./star-e35585c0.js";import{h as F}from"./herbs-47d0af06.js";import{F as U}from"./fuse-11af6271.js";import{S as K}from"./StarfieldBackground-497d2ec2.js";/**
 * @license lucide-react v0.298.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=A("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),W="Unknown",G="Not well documented";function H(){const[t,a]=$("herbFavorites",[]);return{favorites:t,toggle:i=>{a(u=>u.includes(i)?u.filter(o=>o!==i):[...u,i])},isFavorite:i=>t.includes(i)}}function J({text:t,children:a}){const[r,l]=p.useState(!1);return e.jsxs("span",{className:"relative inline-block",onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),onFocus:()=>l(!0),onBlur:()=>l(!1),onTouchStart:()=>l(i=>!i),children:[a||e.jsx("span",{className:"ml-1 cursor-help select-none text-sand",children:"‚ÑπÔ∏è"}),e.jsx(O,{children:r&&e.jsx(h.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},transition:{duration:.2},className:"absolute left-1/2 z-50 mt-1 w-56 -translate-x-1/2 rounded-md bg-black/80 p-2 text-xs text-white backdrop-blur",children:t})})]})}const Q={Oneirogen:"blue","Dissociative / Sedative":"purple","Empathogen / Euphoriant":"pink","Ritual / Visionary":"green",Other:"yellow"},q={hidden:{},visible:{transition:{staggerChildren:.05}}},T={hidden:{opacity:0,y:10},visible:{opacity:1,y:0}},k=4,M={mechanismOfAction:"How this herb produces its effects in the body.",toxicity:"Known adverse effects or poisoning information.",therapeuticUses:"Traditional or potential healing applications.",contraindications:"Situations where this herb should be avoided."};function Z(t){const a=t.toLowerCase();return a.includes("oneirogen")?"from-indigo-700/40 to-purple-700/40":a.includes("ritual")||a.includes("visionary")?"from-green-800/40 to-blue-800/40":a.includes("stimulant")?"from-orange-700/40 to-red-700/40":"from-white/10 to-white/5"}function X(t,a){let r;if(typeof t=="number"&&(r=t),typeof t=="string"){const l=t.toLowerCase();l==="low"?r=1:l==="moderate"?r=3:l==="high"&&(r=5)}if(a&&/severe|danger/i.test(a))return"danger";if(r!=null)return r<=2?"safe":r<=4?"caution":"danger"}function ee({herb:t,highlight:a=""}){var b,d;const[r,l]=N.useState(!1),[i,u]=N.useState(!1),o=()=>l(s=>!s),{isFavorite:f,toggle:y}=H(),v=s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),o())},j=s=>{if(!a)return s;const m=a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),n=new RegExp(`(${m})`,"ig");return s.replace(n,'<span class="font-bold text-yellow-300">$1</span>')},w=Z(t.category),g=X(t.safetyRating,t.toxicity);return e.jsxs(h.div,{layout:!0,initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},exit:{opacity:0,scale:.9},onClick:o,onKeyDown:v,tabIndex:0,role:"button","aria-expanded":r,whileHover:{scale:1.03,boxShadow:"0 0 20px rgba(255,255,255,0.2)",backgroundColor:"rgba(255,255,255,0.1)"},whileTap:{scale:.97},transition:{layout:{duration:.4,ease:"easeInOut"}},className:`hover-glow card-contrast relative cursor-pointer overflow-hidden rounded-2xl bg-gradient-to-br ${w} border border-white/10 p-4 shadow-lg shadow-black/50 ring-1 ring-white/30 backdrop-blur-md hover:shadow-psychedelic-pink/40 hover:drop-shadow-xl focus:outline-none focus-visible:ring-2 focus-visible:ring-psychedelic-pink sm:p-6`,children:[e.jsx(h.span,{initial:{opacity:0,y:-4},whileHover:{opacity:1,y:0},whileTap:{opacity:1,y:0},className:"pointer-events-none absolute right-4 top-2 text-xs text-sand",children:"+ More Info"}),e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[e.jsx("h3",{className:"text-shadow mb-0.5 font-herb text-xl text-white sm:text-2xl",dangerouslySetInnerHTML:{__html:j(t.name)}}),g&&e.jsx("span",{className:`rounded-full px-2 py-0.5 text-xs font-medium shadow ${g==="safe"?"bg-green-700/40 text-green-200 ring-1 ring-green-400/60":g==="caution"?"bg-yellow-700/40 text-yellow-200 ring-1 ring-yellow-400/60":"bg-red-700/40 text-red-200 ring-1 ring-red-500/60"}`,children:g==="safe"?"‚úÖ Safe":g==="caution"?"‚ö†Ô∏è Caution":"‚ò†Ô∏è High Risk"})]}),t.scientificName&&e.jsx("p",{className:"mt-0.5 text-xs italic text-sand",dangerouslySetInnerHTML:{__html:j(t.scientificName)}}),e.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2 text-sm text-sand sm:text-base",children:[t.category&&e.jsx(E,{label:t.category,variant:Q[t.category]||"purple"}),((b=t.effects)==null?void 0:b.length)>0&&e.jsx("span",{children:t.effects.join(", ")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),y(t.id)},"aria-label":f(t.id)?"Remove favorite":"Add favorite",className:"rounded-md p-1 text-yellow-400 hover:bg-white/10",children:e.jsx(z,{fill:f(t.id)?"currentColor":"none",size:18})}),e.jsx(h.span,{layout:!0,initial:!1,animate:{rotate:r?90:0},transition:{duration:.3},className:"text-cyan-200 transition-transform",children:e.jsx(Y,{size:18})})]})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[(i||t.tags.length<=k?t.tags:t.tags.slice(0,k)).map(s=>e.jsx(E,{label:S(s),variant:L(s),className:r?"animate-pulse":""},s)),t.tags.length>k&&e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),u(m=>!m)},className:"focus:outline-none",children:e.jsx(E,{label:i?"Show Less":`+${t.tags.length-k} more`,variant:"yellow"})})]}),e.jsx(O,{initial:!1,children:r&&e.jsx(h.div,{layout:!0,initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},transition:{duration:.4,ease:"easeInOut"},className:"mt-4 overflow-hidden whitespace-pre-line break-words text-sm text-sand sm:text-base",children:e.jsxs(h.div,{variants:q,initial:"hidden",animate:"visible",exit:"hidden",className:"space-y-3",children:[["description","mechanismOfAction","therapeuticUses","sideEffects","contraindications","drugInteractions","preparation","pharmacokinetics","onset","duration","intensity","region","legalStatus","safetyRating","toxicity","toxicityLD50"].map(s=>{const m=t[s],n=typeof m=="string"&&m.trim()&&m!=="No description provided."?m:s==="mechanismOfAction"||s==="toxicity"||s==="toxicityLD50"?W:G;return e.jsxs(h.div,{variants:T,children:[e.jsxs("span",{className:"font-semibold text-lime-300",children:[s.replace(/([A-Z])/g," $1")+":",M[s]&&e.jsx(J,{text:M[s]})]})," ",s==="safetyRating"?e.jsx("span",{className:typeof m=="number"?_(m):"",children:n}):n]},s)}),((d=t.tags)==null?void 0:d.length)>0&&e.jsx(h.div,{variants:T,className:"flex max-h-32 flex-wrap gap-2 overflow-y-auto pt-2",children:t.tags.slice(0,10).map(s=>e.jsx(E,{label:S(s),variant:L(s),className:r?"animate-pulse":""},s))}),e.jsx(h.div,{variants:T,className:"pt-2",children:e.jsx(D,{to:`/herbs/${t.id}`,onClick:s=>s.stopPropagation(),className:"text-comet underline",children:"View full page"})})]})},"content")})]})}const te={hidden:{},visible:{transition:{staggerChildren:.05}}},se={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},ne=({herbs:t,highlightQuery:a="",batchSize:r=24})=>{const[l,i]=p.useState(r),u=()=>i(o=>Math.min(o+r,t.length));return t.length===0?e.jsx("p",{className:"text-center text-sand/80",children:"No herbs match your search."}):e.jsxs(e.Fragment,{children:[e.jsx(h.div,{layout:!0,variants:te,initial:"hidden",animate:"visible",className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:e.jsx(O,{children:t.slice(0,l).map(o=>e.jsx(h.div,{variants:se,layout:!0,children:e.jsx(ee,{herb:o,highlight:a})},o.id||o.name))})},t.map(o=>o.id).join("-")),l<t.length&&e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{type:"button",onClick:u,className:"rounded-md bg-black/30 px-4 py-2 text-sand hover:bg-white/10 backdrop-blur-md",children:"Show More"})})]})},ae=ne,ie=["Effect","Preparation","Safety","Chemistry","Region","Other"];function re({tags:t,onChange:a,storageKey:r="tagFilters",counts:l={}}){const[i,u]=$(r,[]),[o,f]=N.useState({Effect:!0,Preparation:!1,Safety:!1,Chemistry:!1,Region:!1,Other:!1}),[y,v]=N.useState({Effect:!1,Preparation:!1,Safety:!1,Chemistry:!1,Region:!1,Other:!1});N.useEffect(()=>{a==null||a(i)},[i,a]);const j=N.useMemo(()=>{const d={Effect:[],Preparation:[],Safety:[],Chemistry:[],Region:[],Other:[]};return t.forEach(s=>{const m=C(s),n=V(m);d[n].includes(m)||d[n].push(m)}),d},[t]),w=d=>{u(s=>s.includes(d)?s.filter(m=>m!==d):[...s,d])},g=d=>{switch(d){case"Effect":return"‚ö° Effects";case"Preparation":return"üåø Preparation";case"Safety":return"‚ö†Ô∏è Safety";case"Chemistry":return"üß™ Chemistry";case"Region":return"üìç Region";default:return"‚ú® Other"}},b=d=>{const s=j[d]||[],m=12,n=y[d]?s:s.slice(0,m);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"tag-list",children:[n.map(c=>e.jsx(h.button,{type:"button",onClick:()=>w(c),whileHover:{scale:1.1},whileTap:{scale:.95},animate:{opacity:i.includes(c)?1:.6},"aria-pressed":i.includes(c),className:"flex-shrink-0 focus:outline-none",title:l[c]?`${S(C(c))} ‚Äî used in ${l[c]} herbs`:S(C(c)),children:e.jsx(E,{label:S(C(c)),variant:i.includes(c)?"green":L(c),className:B(i.includes(c)&&"ring-1 ring-emerald-400")})},c)),s.length>m&&e.jsx(h.button,{type:"button",whileHover:{scale:1.05},onClick:()=>v(c=>({...c,[d]:!c[d]})),className:"tag-pill mt-2",children:y[d]?"Show Less":"Show More"})]})})};return e.jsx("div",{className:"space-y-3",children:ie.map(d=>e.jsxs("div",{className:"tag-section",children:[e.jsxs("button",{type:"button",className:"tag-label",onClick:()=>f(s=>({...s,[d]:!s[d]})),"aria-expanded":o[d],children:[g(d),e.jsx(h.span,{animate:{rotate:o[d]?90:0},className:"ml-1 text-xs",children:"‚ñ∂"})]}),e.jsx(O,{initial:!1,children:o[d]&&e.jsx(h.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},children:b(d)},"content")})]},d))})}function oe(){const t=p.useMemo(()=>{const r={};return F.forEach(l=>{const i=l.category.split("/")[0].trim();r[i]=(r[i]||0)+1}),r},[]),a=Math.max(...Object.values(t));return e.jsx("div",{className:"space-y-2",children:Object.entries(t).map(([r,l])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-40 text-sm",children:r}),e.jsx("div",{className:"flex-1 bg-slate-700/50 h-2 rounded",children:e.jsx("div",{className:"h-2 rounded bg-fuchsia-500",style:{width:`${l/a*100}%`}})}),e.jsx("span",{className:"text-sm",children:l})]},r))})}function I(t){const a=t.toLowerCase();return/(empathogen|euphoriant)/.test(a)?"Empathogen":/(psychedelic|visionary)/.test(a)?"Psychedelic":/dissociative|sedative/.test(a)?"Dissociative":/oneirogen|dream/.test(a)?"Oneirogen":"Other"}function le(t,a={}){const{favorites:r=[]}=a,[l,i]=p.useState(""),[u,o]=p.useState([]),[f,y]=p.useState(!1),[v,j]=p.useState([]),[w,g]=p.useState(""),b=p.useMemo(()=>new U(t,{keys:["name","scientificName","effects","description","tags"],threshold:.4,includeMatches:!0}),[t]);return{filtered:p.useMemo(()=>{let s=t;const m=l.trim();return m&&(s=b.search(m).map(n=>n.item)),u.length&&(s=s.filter(n=>u.every(c=>n.tags.includes(c)))),v.length&&(s=s.filter(n=>v.includes(I(n.category)))),f&&(s=s.filter(n=>r.includes(n.id))),w==="name"&&(s=[...s].sort((n,c)=>n.name.localeCompare(c.name))),s},[t,l,u,v,f,r,w,b]),query:l,setQuery:i,tags:u,setTags:o,categories:v,setCategories:j,favoritesOnly:f,setFavoritesOnly:y,sort:w,setSort:g,fuse:b}}function ce({selected:t,onChange:a}){const r=p.useMemo(()=>{const i={};return F.forEach(u=>{const o=I(u.category);i[o]=(i[o]||0)+1}),i},[]),l=i=>{const u=t.includes(i)?t.filter(o=>o!==i):[...t,i];a==null||a(u)};return e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(r).sort((i,u)=>u[1]-i[1]).map(([i,u])=>e.jsxs("button",{type:"button",onClick:()=>l(i),className:`tag-pill ${t.includes(i)?"ring-2 ring-emerald-400":""}`,children:[i," (",u,")"]},i))})}function de(){const[t]=p.useState(F);return t}function ue({query:t,setQuery:a,fuse:r}){const[l,i]=p.useState([]);p.useEffect(()=>{const o=t.trim();i(o?r.search(o,{limit:5}):[])},[t,r]);const u=o=>{if(!t)return o;const f=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),y=new RegExp(`(${f})`,"ig");return o.replace(y,'<span class="font-bold">$1</span>')};return e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",placeholder:"Search herbs...",value:t,onChange:o=>a(o.target.value),className:"w-full rounded-md bg-space-dark/70 px-3 py-2 text-white backdrop-blur-md focus:outline-none"}),l.length>0&&e.jsx("ul",{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-black/80 p-2 text-sm text-sand backdrop-blur-md",children:l.map(o=>e.jsx("li",{children:e.jsx("button",{type:"button",className:"w-full text-left hover:bg-white/10 px-2 py-1 rounded",onClick:()=>a(o.item.name),dangerouslySetInnerHTML:{__html:u(o.item.name)}})},o.item.id))})]})}function me(t,a){try{const r=localStorage.getItem(t);return r?JSON.parse(r):a}catch{return a}}function R(t,a){try{localStorage.setItem(t,JSON.stringify(a))}catch{}}function be(){const t=de(),{favorites:a}=H(),{filtered:r,query:l,setQuery:i,tags:u,setTags:o,categories:f,setCategories:y,favoritesOnly:v,setFavoritesOnly:j,fuse:w}=le(t,{favorites:a});p.useEffect(()=>{const n=me("dbScroll",0);n&&window.scrollTo(0,n);const c=()=>R("dbScroll",window.scrollY);return window.addEventListener("scroll",c),()=>{R("dbScroll",window.scrollY),window.removeEventListener("scroll",c)}},[]);const g=p.useMemo(()=>{const n=t.reduce((c,x)=>c.concat(x.tags),[]);return Array.from(new Set(n))},[t]),b=p.useMemo(()=>{const n={};return t.forEach(c=>{c.tags.forEach(x=>{n[x]=(n[x]||0)+1})}),n},[t]),[d,s]=p.useState(!1);p.useEffect(()=>{const n=()=>{window.scrollY>150&&s(!1)};return window.addEventListener("scroll",n),window.addEventListener("touchmove",n),()=>{window.removeEventListener("scroll",n),window.removeEventListener("touchmove",n)}},[]);const m=p.useMemo(()=>{if(u.length===0)return[];const n={};return t.forEach(c=>{u.every(x=>c.tags.includes(x))&&c.tags.forEach(x=>{u.includes(x)||(n[x]=(n[x]||0)+1)})}),Object.entries(n).sort((c,x)=>x[1]-c[1]).slice(0,5).map(([c])=>c)},[u,t]);return e.jsxs(e.Fragment,{children:[e.jsxs(P,{children:[e.jsx("title",{children:"Database - The Hippie Scientist"}),e.jsx("meta",{name:"description",content:"Browse herbal entries and expand each to learn more about their effects and usage."})]}),e.jsxs("div",{className:"relative min-h-screen px-4 pt-20",children:[e.jsx(K,{}),e.jsxs("div",{className:"relative mx-auto max-w-6xl",children:[e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-gradient mb-6 text-5xl font-bold",children:"Herb Database"}),e.jsx("p",{className:"mx-auto max-w-4xl text-xl text-gray-300",children:"Explore our collection of herbs. Click any entry to see detailed information."})]}),e.jsxs("div",{className:"sticky top-2 z-20 mb-4 flex flex-wrap items-center gap-2",children:[e.jsx(ue,{query:l,setQuery:i,fuse:w}),e.jsx("button",{type:"button",onClick:()=>j(n=>!n),className:"rounded-md bg-space-dark/70 px-3 py-2 text-sm text-yellow-300 backdrop-blur-md hover:bg-white/10",children:v?"All Herbs":"My Herbs"}),e.jsx("button",{type:"button",onClick:()=>s(n=>!n),className:"rounded-md bg-space-dark/70 px-3 py-2 text-sm text-sand backdrop-blur-md hover:bg-white/10 sm:hidden",children:d?"Hide Filters":"Show Filters"})]}),e.jsxs("div",{className:`mb-4 space-y-4 ${d?"":"hidden sm:block"}`,children:[e.jsx(ce,{selected:f,onChange:y}),e.jsx(re,{tags:g,counts:b,onChange:o})]}),m.length>0&&e.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-sm text-moss",children:"Related tags:"}),m.map(n=>e.jsx("button",{type:"button",onClick:()=>o(c=>Array.from(new Set([...c,n]))),className:"tag-pill",children:S(n)},n))]}),e.jsx(oe,{}),e.jsx(ae,{herbs:r,highlightQuery:l})]})]})]})}export{be as default};
