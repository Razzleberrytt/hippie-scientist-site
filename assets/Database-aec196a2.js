import{r as p,j as e,m as h,R as d,W as w}from"./main-5e85297b.js";import{l as k,f as F,u as S,H as T}from"./index-0da4272c.js";import{u as b,T as H,c as E,h as y}from"./herbs-5d7d60cc.js";import{d as j,t as M}from"./format-45884e8d.js";import{F as O}from"./fuse-11af6271.js";import"./star-094a466e.js";function A({tags:t,onChange:c,storageKey:i="tagFilters"}){const[r,u]=b(i,[]);p.useEffect(()=>{c==null||c(r)},[r,c]);const x=n=>{u(o=>o.includes(n)?o.filter(m=>m!==n):[...o,n])};return e.jsx("div",{className:"flex flex-wrap gap-2 overflow-x-auto pb-4",children:t.map(n=>e.jsx(h.button,{type:"button",onClick:()=>x(n),whileHover:{scale:1.1},whileTap:{scale:.95},animate:{opacity:r.includes(n)?1:.6},"aria-pressed":r.includes(n),className:"flex-shrink-0 focus:outline-none",children:e.jsx(H,{label:j(n),variant:r.includes(n)?"green":M(n),className:E(r.includes(n)&&"ring-1 ring-emerald-400")})},n))})}function B(){const t=d.useMemo(()=>{const i={};return y.forEach(r=>{i[r.category]=(i[r.category]||0)+1}),i},[]),c=Math.max(...Object.values(t));return e.jsx("div",{className:"space-y-2",children:Object.entries(t).map(([i,r])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-40 text-sm",children:i}),e.jsx("div",{className:"flex-1 bg-slate-700/50 h-2 rounded",children:e.jsx("div",{className:"h-2 rounded bg-fuchsia-500",style:{width:`${r/c*100}%`}})}),e.jsx("span",{className:"text-sm",children:r})]},i))})}function R(){const t=p.useCallback(async c=>{await k(c)},[]);return e.jsx(F,{id:"starfield",init:t,options:{fullScreen:{enable:!0,zIndex:-10},background:{color:"transparent"},particles:{number:{value:100,density:{enable:!0,area:800}},color:{value:["#ffffff","#ffaadf","#c1ffdd"]},size:{value:{min:.5,max:1.5}},move:{enable:!0,speed:.15},opacity:{value:{min:.1,max:.6}}}}})}function z(){const[t]=d.useState(y);return t}function Q(){const t=z(),{favorites:c}=S(),[i,r]=b("herbFavoritesOnly",!1),[u,x]=d.useState(""),n=d.useMemo(()=>new O(t,{keys:["name","tags","effects"],threshold:.3}),[t]),[o,m]=d.useState([]),g=d.useMemo(()=>{const s=t.reduce((l,a)=>l.concat(a.tags),[]);return Array.from(new Set(s))},[t]),v=d.useMemo(()=>{let s=t;const l=u.trim();return l&&(s=n.search(l).map(a=>a.item)),o.length&&(s=s.filter(a=>o.every(N=>a.tags.includes(N)))),i&&(s=s.filter(a=>c.includes(a.id))),s},[t,u,o,i,c]),f=d.useMemo(()=>{if(o.length===0)return[];const s={};return t.forEach(l=>{o.every(a=>l.tags.includes(a))&&l.tags.forEach(a=>{o.includes(a)||(s[a]=(s[a]||0)+1)})}),Object.entries(s).sort((l,a)=>a[1]-l[1]).slice(0,5).map(([l])=>l)},[o,t]);return e.jsxs(e.Fragment,{children:[e.jsxs(w,{children:[e.jsx("title",{children:"Database - The Hippie Scientist"}),e.jsx("meta",{name:"description",content:"Browse herbal entries and expand each to learn more about their effects and usage."})]}),e.jsxs("div",{className:"relative min-h-screen px-4 pt-20",children:[e.jsx(R,{}),e.jsxs("div",{className:"relative mx-auto max-w-3xl",children:[e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-gradient mb-6 text-5xl font-bold",children:"Herb Database"}),e.jsx("p",{className:"mx-auto max-w-3xl text-xl text-gray-300",children:"Explore our collection of herbs. Click any entry to see detailed information."})]}),e.jsxs("div",{className:"sticky top-2 z-10 mb-4 flex items-center gap-2",children:[e.jsx("input",{type:"text",placeholder:"Search herbs...",value:u,onChange:s=>x(s.target.value),className:"flex-1 rounded-md bg-space-dark/70 px-3 py-2 text-white backdrop-blur-md focus:outline-none"}),e.jsx("button",{type:"button",onClick:()=>r(s=>!s),className:"rounded-md bg-space-dark/70 px-3 py-2 text-sm text-yellow-300 backdrop-blur-md hover:bg-white/10",children:i?"All Herbs":"Favorites"})]}),e.jsx(A,{tags:g,onChange:m}),f.length>0&&e.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-sm text-moss",children:"Related tags:"}),f.map(s=>e.jsx("button",{type:"button",onClick:()=>m(l=>Array.from(new Set([...l,s]))),className:"tag-pill",children:j(s)},s))]}),e.jsx(B,{}),e.jsx(T,{herbs:v})]})]})]})}export{Q as default};
