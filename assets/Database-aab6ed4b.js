import{r as p,j as e,m as b,R as m,W as w}from"./main-c9bef5d5.js";import{l as k,f as F,u as S,H as T}from"./index-35c2035c.js";import{u as h,T as H,c as E,h as j}from"./herbs-6c10be05.js";import{d as y,t as M}from"./format-45884e8d.js";import{F as O}from"./fuse-11af6271.js";import"./star-1e5d34be.js";function z({tags:t,onChange:c,storageKey:i="tagFilters"}){const[l,d]=h(i,[]);p.useEffect(()=>{c==null||c(l)},[l,c]);const x=r=>{d(o=>o.includes(r)?o.filter(u=>u!==r):[...o,r])};return e.jsx("div",{className:"sticky top-16 z-10 flex flex-wrap gap-2 overflow-x-auto pb-4 backdrop-blur-md bg-black/30 rounded-xl px-2",children:t.map(r=>e.jsx(b.button,{type:"button",onClick:()=>x(r),whileHover:{scale:1.1},whileTap:{scale:.95},animate:{opacity:l.includes(r)?1:.6},"aria-pressed":l.includes(r),className:"flex-shrink-0 focus:outline-none",children:e.jsx(H,{label:y(r),variant:l.includes(r)?"green":M(r),className:E(l.includes(r)&&"ring-1 ring-emerald-400")})},r))})}function A(){const t=m.useMemo(()=>{const i={};return j.forEach(l=>{const d=l.category.split("/")[0].trim();i[d]=(i[d]||0)+1}),i},[]),c=Math.max(...Object.values(t));return e.jsx("div",{className:"space-y-2",children:Object.entries(t).map(([i,l])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-40 text-sm",children:i}),e.jsx("div",{className:"flex-1 bg-slate-700/50 h-2 rounded",children:e.jsx("div",{className:"h-2 rounded bg-fuchsia-500",style:{width:`${l/c*100}%`}})}),e.jsx("span",{className:"text-sm",children:l})]},i))})}function B(){const t=p.useCallback(async c=>{await k(c)},[]);return e.jsx(F,{id:"starfield",init:t,options:{fullScreen:{enable:!0,zIndex:-10},background:{color:"transparent"},particles:{number:{value:100,density:{enable:!0,area:800}},color:{value:["#ffffff","#ffaadf","#c1ffdd"]},size:{value:{min:.5,max:1.5}},move:{enable:!0,speed:.15},opacity:{value:{min:.1,max:.6}}}}})}function R(){const[t]=m.useState(j);return t}function Q(){const t=R(),{favorites:c}=S(),[i,l]=h("herbFavoritesOnly",!1),[d,x]=m.useState(""),r=m.useMemo(()=>new O(t,{keys:["name","tags","effects"],threshold:.3}),[t]),[o,u]=m.useState([]),g=m.useMemo(()=>{const s=t.reduce((n,a)=>n.concat(a.tags),[]);return Array.from(new Set(s))},[t]),v=m.useMemo(()=>{let s=t;const n=d.trim();return n&&(s=r.search(n).map(a=>a.item)),o.length&&(s=s.filter(a=>o.every(N=>a.tags.includes(N)))),i&&(s=s.filter(a=>c.includes(a.id))),s},[t,d,o,i,c]),f=m.useMemo(()=>{if(o.length===0)return[];const s={};return t.forEach(n=>{o.every(a=>n.tags.includes(a))&&n.tags.forEach(a=>{o.includes(a)||(s[a]=(s[a]||0)+1)})}),Object.entries(s).sort((n,a)=>a[1]-n[1]).slice(0,5).map(([n])=>n)},[o,t]);return e.jsxs(e.Fragment,{children:[e.jsxs(w,{children:[e.jsx("title",{children:"Database - The Hippie Scientist"}),e.jsx("meta",{name:"description",content:"Browse herbal entries and expand each to learn more about their effects and usage."})]}),e.jsxs("div",{className:"relative min-h-screen px-4 pt-20",children:[e.jsx(B,{}),e.jsxs("div",{className:"relative mx-auto max-w-6xl",children:[e.jsxs(b.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-gradient mb-6 text-5xl font-bold",children:"Herb Database"}),e.jsx("p",{className:"mx-auto max-w-4xl text-xl text-gray-300",children:"Explore our collection of herbs. Click any entry to see detailed information."})]}),e.jsxs("div",{className:"sticky top-2 z-20 mb-4 flex flex-wrap items-center gap-2",children:[e.jsx("input",{type:"text",placeholder:"Search herbs...",value:d,onChange:s=>x(s.target.value),className:"flex-1 rounded-md bg-space-dark/70 px-3 py-2 text-white backdrop-blur-md focus:outline-none"}),e.jsx("button",{type:"button",onClick:()=>l(s=>!s),className:"rounded-md bg-space-dark/70 px-3 py-2 text-sm text-yellow-300 backdrop-blur-md hover:bg-white/10",children:i?"All Herbs":"Favorites"})]}),e.jsx("div",{className:"mb-4",children:e.jsx(z,{tags:g,onChange:u})}),f.length>0&&e.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-sm text-moss",children:"Related tags:"}),f.map(s=>e.jsx("button",{type:"button",onClick:()=>u(n=>Array.from(new Set([...n,s]))),className:"tag-pill",children:y(s)},s))]}),e.jsx(A,{}),e.jsx(T,{herbs:v})]})]})]})}export{Q as default};
