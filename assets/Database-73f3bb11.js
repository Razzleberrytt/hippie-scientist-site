import{l as A,R as p,j as e,n as k,m as f,r as C,L as D,W as P}from"./main-b8333972.js";import{d as E,t as F,s as _,a as V,n as O}from"./format-d7efe303.js";import{u as $,T as S,c as B}from"./useLocalStorage-176ce874.js";import{S as z}from"./star-75526f4e.js";import{h as L}from"./herbs-57fc8cc5.js";import{F as U}from"./fuse-11af6271.js";import{S as K}from"./StarfieldBackground-7bed650b.js";/**
 * @license lucide-react v0.298.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=A("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),W="Unknown",G="Not well documented";function H(){const[t,i]=$("herbFavorites",[]);return{favorites:t,toggle:a=>{i(u=>u.includes(a)?u.filter(o=>o!==a):[...u,a])},isFavorite:a=>t.includes(a)}}function J({text:t,children:i}){const[n,l]=p.useState(!1);return e.jsxs("span",{className:"relative inline-block",onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),onFocus:()=>l(!0),onBlur:()=>l(!1),onTouchStart:()=>l(a=>!a),children:[i||e.jsx("span",{className:"ml-1 cursor-help select-none text-sand",children:"‚ÑπÔ∏è"}),e.jsx(k,{children:n&&e.jsx(f.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},transition:{duration:.2},className:"absolute left-1/2 z-50 mt-1 w-56 -translate-x-1/2 rounded-md bg-black/80 p-2 text-xs text-white backdrop-blur",children:t})})]})}const Q={Oneirogen:"blue","Dissociative / Sedative":"purple","Empathogen / Euphoriant":"pink","Ritual / Visionary":"green",Other:"yellow"},q={hidden:{},visible:{transition:{staggerChildren:.05}}},T={hidden:{opacity:0,y:10},visible:{opacity:1,y:0}},N=4,M={mechanismOfAction:"How this herb produces its effects in the body.",toxicity:"Known adverse effects or poisoning information.",therapeuticUses:"Traditional or potential healing applications.",contraindications:"Situations where this herb should be avoided."};function Z(t){const i=t.toLowerCase();return i.includes("oneirogen")?"from-indigo-700/40 to-purple-700/40":i.includes("ritual")||i.includes("visionary")?"from-green-800/40 to-blue-800/40":i.includes("stimulant")?"from-orange-700/40 to-red-700/40":"from-white/10 to-white/5"}function X(t,i){let n;if(typeof t=="number"&&(n=t),typeof t=="string"){const l=t.toLowerCase();l==="low"?n=1:l==="moderate"?n=3:l==="high"&&(n=5)}if(i&&/severe|danger/i.test(i))return"danger";if(n!=null)return n<=2?"safe":n<=4?"caution":"danger"}function ee({herb:t,highlight:i=""}){var b,d;const[n,l]=C.useState(!1),[a,u]=C.useState(!1),o=()=>l(s=>!s),{isFavorite:h,toggle:y}=H(),v=s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),o())},j=s=>{if(!i)return s;const m=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),r=new RegExp(`(${m})`,"ig");return s.replace(r,'<span class="font-bold text-yellow-300">$1</span>')},w=Z(t.category),g=X(t.safetyRating,t.toxicity);return e.jsxs(f.div,{layout:!0,initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},exit:{opacity:0,scale:.9},onClick:o,onKeyDown:v,tabIndex:0,role:"button","aria-expanded":n,whileHover:{scale:1.03,boxShadow:"0 0 20px rgba(255,255,255,0.2)",backgroundColor:"rgba(255,255,255,0.1)"},whileTap:{scale:.97},transition:{layout:{duration:.4,ease:"easeInOut"}},className:`hover-glow card-contrast relative cursor-pointer overflow-hidden rounded-2xl bg-gradient-to-br ${w} border border-white/10 p-4 shadow-lg shadow-black/50 ring-1 ring-white/30 backdrop-blur-md hover:shadow-psychedelic-pink/40 focus:outline-none focus-visible:ring-2 focus-visible:ring-psychedelic-pink sm:p-6`,children:[e.jsx(f.span,{initial:{opacity:0,y:-4},whileHover:{opacity:1,y:0},whileTap:{opacity:1,y:0},className:"pointer-events-none absolute right-4 top-2 text-xs text-sand",children:"+ More Info"}),e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"text-shadow mb-0.5 font-herb text-xl text-white sm:text-2xl",dangerouslySetInnerHTML:{__html:j(t.name)}}),g&&e.jsx("span",{className:`ml-1 rounded-full px-2 py-0.5 text-xs font-medium shadow ${g==="safe"?"bg-green-700/40 text-green-200 ring-1 ring-green-400/60":g==="caution"?"bg-yellow-700/40 text-yellow-200 ring-1 ring-yellow-400/60":"bg-red-700/40 text-red-200 ring-1 ring-red-500/60"}`,children:g==="safe"?"‚úÖ Safe":g==="caution"?"‚ö†Ô∏è Caution":"‚ò†Ô∏è High Risk"}),t.scientificName&&e.jsx("p",{className:"mt-0.5 text-xs italic text-sand",dangerouslySetInnerHTML:{__html:j(t.scientificName)}}),e.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2 text-sm text-sand sm:text-base",children:[t.category&&e.jsx(S,{label:t.category,variant:Q[t.category]||"purple"}),((b=t.effects)==null?void 0:b.length)>0&&e.jsx("span",{children:t.effects.join(", ")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),y(t.id)},"aria-label":h(t.id)?"Remove favorite":"Add favorite",className:"rounded-md p-1 text-yellow-400 hover:bg-white/10",children:e.jsx(z,{fill:h(t.id)?"currentColor":"none",size:18})}),e.jsx(f.span,{layout:!0,initial:!1,animate:{rotate:n?90:0},transition:{duration:.3},className:"text-cyan-200 transition-transform",children:e.jsx(Y,{size:18})})]})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",onClick:s=>{s.stopPropagation(),t.tags.length>N&&u(m=>!m)},children:[(a||t.tags.length<=N?t.tags:t.tags.slice(0,N)).map(s=>e.jsx(S,{label:E(s),variant:F(s),className:n?"animate-pulse":""},s)),t.tags.length>N&&!a&&e.jsx(S,{label:`+${t.tags.length-N} more`,variant:"yellow"}),t.tags.length>N&&a&&e.jsx(S,{label:"Show Less",variant:"yellow"})]}),e.jsx(k,{initial:!1,children:n&&e.jsx(f.div,{layout:!0,initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},transition:{duration:.4,ease:"easeInOut"},className:"mt-4 overflow-hidden whitespace-pre-line break-words text-sm text-sand sm:text-base",children:e.jsxs(f.div,{variants:q,initial:"hidden",animate:"visible",exit:"hidden",className:"space-y-3",children:[["description","mechanismOfAction","therapeuticUses","sideEffects","contraindications","drugInteractions","preparation","pharmacokinetics","onset","duration","intensity","region","legalStatus","safetyRating","toxicity","toxicityLD50"].map(s=>{const m=t[s],r=typeof m=="string"&&m.trim()&&m!=="No description provided."?m:s==="mechanismOfAction"||s==="toxicity"||s==="toxicityLD50"?W:G;return e.jsxs(f.div,{variants:T,children:[e.jsxs("span",{className:"font-semibold text-lime-300",children:[s.replace(/([A-Z])/g," $1")+":",M[s]&&e.jsx(J,{text:M[s]})]})," ",s==="safetyRating"?e.jsx("span",{className:typeof m=="number"?_(m):"",children:r}):r]},s)}),((d=t.tags)==null?void 0:d.length)>0&&e.jsx(f.div,{variants:T,className:"flex max-h-32 flex-wrap gap-2 overflow-y-auto pt-2",children:t.tags.slice(0,10).map(s=>e.jsx(S,{label:E(s),variant:F(s),className:n?"animate-pulse":""},s))}),e.jsx(f.div,{variants:T,className:"pt-2",children:e.jsx(D,{to:`/herbs/${t.id}`,onClick:s=>s.stopPropagation(),className:"text-comet underline",children:"View full page"})})]})},"content")})]})}const te={hidden:{},visible:{transition:{staggerChildren:.05}}},se={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},ae=({herbs:t,highlightQuery:i="",batchSize:n=24})=>{const[l,a]=p.useState(n),u=()=>a(o=>Math.min(o+n,t.length));return t.length===0?e.jsx("p",{className:"text-center text-sand/80",children:"No herbs match your search."}):e.jsxs(e.Fragment,{children:[e.jsx(f.div,{layout:!0,variants:te,initial:"hidden",animate:"visible",className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:e.jsx(k,{children:t.slice(0,l).map(o=>e.jsx(f.div,{variants:se,layout:!0,children:e.jsx(ee,{herb:o,highlight:i})},o.id||o.name))})},t.map(o=>o.id).join("-")),l<t.length&&e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{type:"button",onClick:u,className:"rounded-md bg-black/30 px-4 py-2 text-sand hover:bg-white/10 backdrop-blur-md",children:"Show More"})})]})},ie=ae,ne=["Effect","Preparation","Safety","Chemistry","Region","Other"];function re({tags:t,onChange:i,storageKey:n="tagFilters",counts:l={}}){const[a,u]=$(n,[]),[o,h]=C.useState({Effect:!0,Preparation:!1,Safety:!1,Chemistry:!1,Region:!1,Other:!1}),[y,v]=C.useState({Effect:!1,Preparation:!1,Safety:!1,Chemistry:!1,Region:!1,Other:!1});C.useEffect(()=>{i==null||i(a)},[a,i]);const j=C.useMemo(()=>{const d={Effect:[],Preparation:[],Safety:[],Chemistry:[],Region:[],Other:[]};return t.forEach(s=>{const m=V(s);d[m].push(s)}),d},[t]),w=d=>{u(s=>s.includes(d)?s.filter(m=>m!==d):[...s,d])},g=d=>{switch(d){case"Effect":return"‚ö° Effects";case"Preparation":return"üåø Preparation";case"Safety":return"‚ö†Ô∏è Safety";case"Chemistry":return"üß™ Chemistry";case"Region":return"üìç Region";default:return"‚ú® Other"}},b=d=>{const s=j[d]||[],m=12,r=y[d]?s:s.slice(0,m);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"tag-list",children:[r.map(c=>e.jsx(f.button,{type:"button",onClick:()=>w(c),whileHover:{scale:1.1},whileTap:{scale:.95},animate:{opacity:a.includes(c)?1:.6},"aria-pressed":a.includes(c),className:"flex-shrink-0 focus:outline-none",title:l[c]?`${E(O(c))} ‚Äî used in ${l[c]} herbs`:E(O(c)),children:e.jsx(S,{label:E(O(c)),variant:a.includes(c)?"green":F(c),className:B(a.includes(c)&&"ring-1 ring-emerald-400")})},c)),s.length>m&&e.jsx(f.button,{type:"button",whileHover:{scale:1.05},onClick:()=>v(c=>({...c,[d]:!c[d]})),className:"tag-pill mt-2",children:y[d]?"Show Less":"Show More"})]})})};return e.jsx("div",{className:"space-y-3",children:ne.map(d=>e.jsxs("div",{className:"tag-section",children:[e.jsxs("button",{type:"button",className:"tag-label",onClick:()=>h(s=>({...s,[d]:!s[d]})),"aria-expanded":o[d],children:[g(d),e.jsx(f.span,{animate:{rotate:o[d]?90:0},className:"ml-1 text-xs",children:"‚ñ∂"})]}),e.jsx(k,{initial:!1,children:o[d]&&e.jsx(f.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},children:b(d)},"content")})]},d))})}function oe(){const t=p.useMemo(()=>{const n={};return L.forEach(l=>{const a=l.category.split("/")[0].trim();n[a]=(n[a]||0)+1}),n},[]),i=Math.max(...Object.values(t));return e.jsx("div",{className:"space-y-2",children:Object.entries(t).map(([n,l])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-40 text-sm",children:n}),e.jsx("div",{className:"flex-1 bg-slate-700/50 h-2 rounded",children:e.jsx("div",{className:"h-2 rounded bg-fuchsia-500",style:{width:`${l/i*100}%`}})}),e.jsx("span",{className:"text-sm",children:l})]},n))})}function I(t){const i=t.toLowerCase();return/(empathogen|euphoriant)/.test(i)?"Empathogen":/(psychedelic|visionary)/.test(i)?"Psychedelic":/dissociative|sedative/.test(i)?"Dissociative":/oneirogen|dream/.test(i)?"Oneirogen":"Other"}function le(t,i={}){const{favorites:n=[]}=i,[l,a]=p.useState(""),[u,o]=p.useState([]),[h,y]=p.useState(!1),[v,j]=p.useState([]),[w,g]=p.useState(""),b=p.useMemo(()=>new U(t,{keys:["name","scientificName","effects","description","tags"],threshold:.4,includeMatches:!0}),[t]);return{filtered:p.useMemo(()=>{let s=t;const m=l.trim();return m&&(s=b.search(m).map(r=>r.item)),u.length&&(s=s.filter(r=>u.every(c=>r.tags.includes(c)))),v.length&&(s=s.filter(r=>v.includes(I(r.category)))),h&&(s=s.filter(r=>n.includes(r.id))),w==="name"&&(s=[...s].sort((r,c)=>r.name.localeCompare(c.name))),s},[t,l,u,v,h,n,w,b]),query:l,setQuery:a,tags:u,setTags:o,categories:v,setCategories:j,favoritesOnly:h,setFavoritesOnly:y,sort:w,setSort:g,fuse:b}}function ce({selected:t,onChange:i}){const n=p.useMemo(()=>{const a={};return L.forEach(u=>{const o=I(u.category);a[o]=(a[o]||0)+1}),a},[]),l=a=>{const u=t.includes(a)?t.filter(o=>o!==a):[...t,a];i==null||i(u)};return e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(n).sort((a,u)=>u[1]-a[1]).map(([a,u])=>e.jsxs("button",{type:"button",onClick:()=>l(a),className:`tag-pill ${t.includes(a)?"ring-2 ring-emerald-400":""}`,children:[a," (",u,")"]},a))})}function de(){const[t]=p.useState(L);return t}function ue({query:t,setQuery:i,fuse:n}){const[l,a]=p.useState([]);p.useEffect(()=>{const o=t.trim();a(o?n.search(o,{limit:5}):[])},[t,n]);const u=o=>{if(!t)return o;const h=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),y=new RegExp(`(${h})`,"ig");return o.replace(y,'<span class="font-bold">$1</span>')};return e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",placeholder:"Search herbs...",value:t,onChange:o=>i(o.target.value),className:"w-full rounded-md bg-space-dark/70 px-3 py-2 text-white backdrop-blur-md focus:outline-none"}),l.length>0&&e.jsx("ul",{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-black/80 p-2 text-sm text-sand backdrop-blur-md",children:l.map(o=>e.jsx("li",{children:e.jsx("button",{type:"button",className:"w-full text-left hover:bg-white/10 px-2 py-1 rounded",onClick:()=>i(o.item.name),dangerouslySetInnerHTML:{__html:u(o.item.name)}})},o.item.id))})]})}function me(t,i){try{const n=localStorage.getItem(t);return n?JSON.parse(n):i}catch{return i}}function R(t,i){try{localStorage.setItem(t,JSON.stringify(i))}catch{}}function be(){const t=de(),{favorites:i}=H(),{filtered:n,query:l,setQuery:a,tags:u,setTags:o,categories:h,setCategories:y,favoritesOnly:v,setFavoritesOnly:j,fuse:w}=le(t,{favorites:i});p.useEffect(()=>{const r=me("dbScroll",0);r&&window.scrollTo(0,r);const c=()=>R("dbScroll",window.scrollY);return window.addEventListener("scroll",c),()=>{R("dbScroll",window.scrollY),window.removeEventListener("scroll",c)}},[]);const g=p.useMemo(()=>{const r=t.reduce((c,x)=>c.concat(x.tags),[]);return Array.from(new Set(r))},[t]),b=p.useMemo(()=>{const r={};return t.forEach(c=>{c.tags.forEach(x=>{r[x]=(r[x]||0)+1})}),r},[t]),[d,s]=p.useState(!1);p.useEffect(()=>{const r=()=>{window.scrollY>150&&s(!1)};return window.addEventListener("scroll",r),()=>window.removeEventListener("scroll",r)},[]);const m=p.useMemo(()=>{if(u.length===0)return[];const r={};return t.forEach(c=>{u.every(x=>c.tags.includes(x))&&c.tags.forEach(x=>{u.includes(x)||(r[x]=(r[x]||0)+1)})}),Object.entries(r).sort((c,x)=>x[1]-c[1]).slice(0,5).map(([c])=>c)},[u,t]);return e.jsxs(e.Fragment,{children:[e.jsxs(P,{children:[e.jsx("title",{children:"Database - The Hippie Scientist"}),e.jsx("meta",{name:"description",content:"Browse herbal entries and expand each to learn more about their effects and usage."})]}),e.jsxs("div",{className:"relative min-h-screen px-4 pt-20",children:[e.jsx(K,{}),e.jsxs("div",{className:"relative mx-auto max-w-6xl",children:[e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-gradient mb-6 text-5xl font-bold",children:"Herb Database"}),e.jsx("p",{className:"mx-auto max-w-4xl text-xl text-gray-300",children:"Explore our collection of herbs. Click any entry to see detailed information."})]}),e.jsxs("div",{className:"sticky top-2 z-20 mb-4 flex flex-wrap items-center gap-2",children:[e.jsx(ue,{query:l,setQuery:a,fuse:w}),e.jsx("button",{type:"button",onClick:()=>j(r=>!r),className:"rounded-md bg-space-dark/70 px-3 py-2 text-sm text-yellow-300 backdrop-blur-md hover:bg-white/10",children:v?"All Herbs":"My Herbs"}),e.jsx("button",{type:"button",onClick:()=>s(r=>!r),className:"rounded-md bg-space-dark/70 px-3 py-2 text-sm text-sand backdrop-blur-md hover:bg-white/10 sm:hidden",children:d?"Hide Filters":"Show Filters"})]}),e.jsxs("div",{className:`mb-4 space-y-4 ${d?"":"hidden sm:block"}`,children:[e.jsx(ce,{selected:h,onChange:y}),e.jsx(re,{tags:g,counts:b,onChange:o})]}),m.length>0&&e.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-sm text-moss",children:"Related tags:"}),m.map(r=>e.jsx("button",{type:"button",onClick:()=>o(c=>Array.from(new Set([...c,r]))),className:"tag-pill",children:E(r)},r))]}),e.jsx(oe,{}),e.jsx(ie,{herbs:n,highlightQuery:l})]})]})]})}export{be as default};
