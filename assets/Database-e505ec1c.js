import{l as L,r as j,j as e,m as h,n as C,L as H,R as p,W as $}from"./main-7e24e225.js";import{d as w,t as k,s as I,a as A,n as S}from"./format-d7efe303.js";import{u as T,T as N,c as D,h as M}from"./useLocalStorage-e4976ae8.js";import{S as P}from"./star-a9fe264e.js";import{l as _,f as z}from"./index-fc77f585.js";import{F as V}from"./fuse-11af6271.js";/**
 * @license lucide-react v0.298.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=L("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),U="Unknown",K="Not well documented";function R(){const[t,l]=T("herbFavorites",[]);return{favorites:t,toggle:c=>{l(m=>m.includes(c)?m.filter(r=>r!==c):[...m,c])},isFavorite:c=>t.includes(c)}}const W={Oneirogen:"blue","Dissociative / Sedative":"purple","Empathogen / Euphoriant":"pink","Ritual / Visionary":"green",Other:"yellow"},Y={hidden:{},visible:{transition:{staggerChildren:.05}}},E={hidden:{opacity:0,y:10},visible:{opacity:1,y:0}};function J({herb:t,highlight:l=""}){var y,b;const[o,d]=j.useState(!1),c=()=>d(a=>!a),{isFavorite:m,toggle:r}=R(),f=a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),c())},g=a=>{if(!l)return a;const x=l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),n=new RegExp(`(${x})`,"ig");return a.replace(n,'<span class="font-bold text-yellow-300">$1</span>')};return e.jsxs(h.div,{layout:!0,initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},exit:{opacity:0,scale:.9},onClick:c,onKeyDown:f,tabIndex:0,role:"button","aria-expanded":o,whileHover:{scale:1.03,boxShadow:"0 0 20px rgba(255,255,255,0.2)",backgroundColor:"rgba(255,255,255,0.1)"},whileTap:{scale:.97},transition:{layout:{duration:.4,ease:"easeInOut"}},className:"hover-glow relative cursor-pointer overflow-hidden rounded-2xl bg-white/10 p-4 sm:p-6 ring-1 ring-white/30 border border-white/10 shadow-xl backdrop-blur-md focus:outline-none focus-visible:ring-2 focus-visible:ring-psychedelic-pink",children:[e.jsx(h.span,{initial:{opacity:0,y:-4},whileHover:{opacity:1,y:0},whileTap:{opacity:1,y:0},className:"pointer-events-none absolute right-4 top-2 text-xs text-sand",children:"+ More Info"}),e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-herb text-xl sm:text-2xl text-white",dangerouslySetInnerHTML:{__html:g(t.name)}}),t.scientificName&&e.jsx("p",{className:"text-xs italic text-sand",dangerouslySetInnerHTML:{__html:g(t.scientificName)}}),e.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2 text-sm sm:text-base text-sand",children:[t.category&&e.jsx(N,{label:t.category,variant:W[t.category]||"purple"}),((y=t.effects)==null?void 0:y.length)>0&&e.jsx("span",{children:t.effects.join(", ")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:a=>{a.stopPropagation(),r(t.id)},"aria-label":m(t.id)?"Remove favorite":"Add favorite",className:"rounded-md p-1 text-yellow-400 hover:bg-white/10",children:e.jsx(P,{fill:m(t.id)?"currentColor":"none",size:18})}),e.jsx(h.span,{layout:!0,initial:!1,animate:{rotate:o?90:0},transition:{duration:.3},className:"text-cyan-200 transition-transform",children:e.jsx(B,{size:18})})]})]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:t.tags.slice(0,3).map(a=>e.jsx(N,{label:w(a),variant:k(a),className:o?"animate-pulse":""},a))}),e.jsx(C,{initial:!1,children:o&&e.jsx(h.div,{layout:!0,initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},transition:{duration:.4,ease:"easeInOut"},className:"mt-4 overflow-hidden text-sm sm:text-base text-sand break-words whitespace-pre-line",children:e.jsxs(h.div,{variants:Y,initial:"hidden",animate:"visible",exit:"hidden",className:"space-y-3",children:[["description","mechanismOfAction","therapeuticUses","sideEffects","contraindications","drugInteractions","preparation","pharmacokinetics","onset","duration","intensity","region","legalStatus","safetyRating","toxicity","toxicityLD50"].map(a=>{const x=t[a],n=typeof x=="string"&&x.trim()&&x!=="No description provided."?x:a==="mechanismOfAction"||a==="toxicity"||a==="toxicityLD50"?U:K;return e.jsxs(h.div,{variants:E,children:[e.jsx("span",{className:"font-semibold text-lime-300",children:a.replace(/([A-Z])/g," $1")+":"})," ",a==="safetyRating"?e.jsx("span",{className:typeof x=="number"?I(x):"",children:n}):n]},a)}),((b=t.tags)==null?void 0:b.length)>0&&e.jsx(h.div,{variants:E,className:"flex max-h-32 flex-wrap gap-2 overflow-y-auto pt-2",children:t.tags.slice(0,10).map(a=>e.jsx(N,{label:w(a),variant:k(a),className:o?"animate-pulse":""},a))}),e.jsx(h.div,{variants:E,className:"pt-2",children:e.jsx(H,{to:`/herbs/${t.id}`,onClick:a=>a.stopPropagation(),className:"text-comet underline",children:"View full page"})})]})},"content")})]})}const Q=({herbs:t,highlightQuery:l="",batchSize:o=24})=>{const[d,c]=p.useState(o),m=()=>c(r=>Math.min(r+o,t.length));return t.length===0?e.jsx("p",{className:"text-center text-sand/80",children:"No herbs match your search."}):e.jsxs(e.Fragment,{children:[e.jsx(h.div,{layout:!0,className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:e.jsx(C,{children:t.slice(0,d).map(r=>e.jsx(J,{herb:r,highlight:l},r.id||r.name))})}),d<t.length&&e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{type:"button",onClick:m,className:"rounded-md bg-black/30 px-4 py-2 text-sand hover:bg-white/10 backdrop-blur-md",children:"Show More"})})]})},q=Q,G=["Effect","Preparation","Safety","Chemistry","Region","Other"];function Z({tags:t,onChange:l,storageKey:o="tagFilters",counts:d={}}){const[c,m]=T(o,[]),[r,f]=j.useState({Effect:!0,Preparation:!1,Safety:!1,Chemistry:!1,Region:!1,Other:!1}),[g,y]=j.useState({Effect:!1,Preparation:!1,Safety:!1,Chemistry:!1,Region:!1,Other:!1});j.useEffect(()=>{l==null||l(c)},[c,l]);const b=j.useMemo(()=>{const s={Effect:[],Preparation:[],Safety:[],Chemistry:[],Region:[],Other:[]};return t.forEach(i=>{const v=A(i);s[v].push(i)}),s},[t]),a=s=>{m(i=>i.includes(s)?i.filter(v=>v!==s):[...i,s])},x=s=>{switch(s){case"Effect":return"âš¡ Effects";case"Preparation":return"ðŸŒ¿ Preparation";case"Safety":return"âš ï¸ Safety";case"Chemistry":return"ðŸ§ª Chemistry";case"Region":return"ðŸ“ Region";default:return"âœ¨ Other"}},n=s=>{const i=b[s]||[],v=12,F=g[s]?i:i.slice(0,v);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"tag-list",children:[F.map(u=>e.jsx(h.button,{type:"button",onClick:()=>a(u),whileHover:{scale:1.1},whileTap:{scale:.95},animate:{opacity:c.includes(u)?1:.6},"aria-pressed":c.includes(u),className:"flex-shrink-0 focus:outline-none",title:d[u]?`${w(S(u))} â€” used in ${d[u]} herbs`:w(S(u)),children:e.jsx(N,{label:w(S(u)),variant:c.includes(u)?"green":k(u),className:D(c.includes(u)&&"ring-1 ring-emerald-400")})},u)),i.length>v&&e.jsx(h.button,{type:"button",whileHover:{scale:1.05},onClick:()=>y(u=>({...u,[s]:!u[s]})),className:"tag-pill mt-2",children:g[s]?"Show Less":"Show More"})]})})};return e.jsx("div",{className:"space-y-3",children:G.map(s=>e.jsxs("div",{className:"tag-section",children:[e.jsxs("button",{type:"button",className:"tag-label",onClick:()=>f(i=>({...i,[s]:!i[s]})),"aria-expanded":r[s],children:[x(s),e.jsx(h.span,{animate:{rotate:r[s]?90:0},className:"ml-1 text-xs",children:"â–¶"})]}),e.jsx(C,{initial:!1,children:r[s]&&e.jsx(h.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},children:n(s)},"content")})]},s))})}function X(){const t=p.useMemo(()=>{const o={};return M.forEach(d=>{const c=d.category.split("/")[0].trim();o[c]=(o[c]||0)+1}),o},[]),l=Math.max(...Object.values(t));return e.jsx("div",{className:"space-y-2",children:Object.entries(t).map(([o,d])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-40 text-sm",children:o}),e.jsx("div",{className:"flex-1 bg-slate-700/50 h-2 rounded",children:e.jsx("div",{className:"h-2 rounded bg-fuchsia-500",style:{width:`${d/l*100}%`}})}),e.jsx("span",{className:"text-sm",children:d})]},o))})}function ee(){const t=j.useCallback(async l=>{await _(l)},[]);return e.jsx(z,{id:"starfield",init:t,options:{fullScreen:{enable:!0,zIndex:-10},background:{color:"transparent"},particles:{number:{value:100,density:{enable:!0,area:800}},color:{value:["#ffffff","#ffaadf","#c1ffdd"]},size:{value:{min:.5,max:1.5}},move:{enable:!0,speed:.15},opacity:{value:{min:.1,max:.6}}}}})}function te(){const[t]=p.useState(M);return t}function se({query:t,setQuery:l,fuse:o}){const[d,c]=p.useState([]);p.useEffect(()=>{const r=t.trim();c(r?o.search(r,{limit:5}):[])},[t,o]);const m=r=>{if(!t)return r;const f=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),g=new RegExp(`(${f})`,"ig");return r.replace(g,'<span class="font-bold">$1</span>')};return e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",placeholder:"Search herbs...",value:t,onChange:r=>l(r.target.value),className:"w-full rounded-md bg-space-dark/70 px-3 py-2 text-white backdrop-blur-md focus:outline-none"}),d.length>0&&e.jsx("ul",{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-black/80 p-2 text-sm text-sand backdrop-blur-md",children:d.map(r=>e.jsx("li",{children:e.jsx("button",{type:"button",className:"w-full text-left hover:bg-white/10 px-2 py-1 rounded",onClick:()=>l(r.item.name),dangerouslySetInnerHTML:{__html:m(r.item.name)}})},r.item.id))})]})}function ae(t,l={}){const{favorites:o=[]}=l,[d,c]=p.useState(""),[m,r]=p.useState([]),[f,g]=p.useState(!1),[y,b]=p.useState(""),a=p.useMemo(()=>new V(t,{keys:["name","scientificName","effects","description","tags"],threshold:.4,includeMatches:!0}),[t]);return{filtered:p.useMemo(()=>{let n=t;const s=d.trim();return s&&(n=a.search(s).map(i=>i.item)),m.length&&(n=n.filter(i=>m.every(v=>i.tags.includes(v)))),f&&(n=n.filter(i=>o.includes(i.id))),y==="name"&&(n=[...n].sort((i,v)=>i.name.localeCompare(v.name))),n},[t,d,m,f,o,y,a]),query:d,setQuery:c,tags:m,setTags:r,favoritesOnly:f,setFavoritesOnly:g,sort:y,setSort:b,fuse:a}}function ne(t,l){try{const o=localStorage.getItem(t);return o?JSON.parse(o):l}catch{return l}}function O(t,l){try{localStorage.setItem(t,JSON.stringify(l))}catch{}}function me(){const t=te(),{favorites:l}=R(),{filtered:o,query:d,setQuery:c,tags:m,setTags:r,favoritesOnly:f,setFavoritesOnly:g,fuse:y}=ae(t,{favorites:l});p.useEffect(()=>{const n=ne("dbScroll",0);n&&window.scrollTo(0,n);const s=()=>O("dbScroll",window.scrollY);return window.addEventListener("scroll",s),()=>{O("dbScroll",window.scrollY),window.removeEventListener("scroll",s)}},[]);const b=p.useMemo(()=>{const n=t.reduce((s,i)=>s.concat(i.tags),[]);return Array.from(new Set(n))},[t]),a=p.useMemo(()=>{const n={};return t.forEach(s=>{s.tags.forEach(i=>{n[i]=(n[i]||0)+1})}),n},[t]),x=p.useMemo(()=>{if(m.length===0)return[];const n={};return t.forEach(s=>{m.every(i=>s.tags.includes(i))&&s.tags.forEach(i=>{m.includes(i)||(n[i]=(n[i]||0)+1)})}),Object.entries(n).sort((s,i)=>i[1]-s[1]).slice(0,5).map(([s])=>s)},[m,t]);return e.jsxs(e.Fragment,{children:[e.jsxs($,{children:[e.jsx("title",{children:"Database - The Hippie Scientist"}),e.jsx("meta",{name:"description",content:"Browse herbal entries and expand each to learn more about their effects and usage."})]}),e.jsxs("div",{className:"relative min-h-screen px-4 pt-20",children:[e.jsx(ee,{}),e.jsxs("div",{className:"relative mx-auto max-w-6xl",children:[e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-gradient mb-6 text-5xl font-bold",children:"Herb Database"}),e.jsx("p",{className:"mx-auto max-w-4xl text-xl text-gray-300",children:"Explore our collection of herbs. Click any entry to see detailed information."})]}),e.jsxs("div",{className:"sticky top-2 z-20 mb-4 flex flex-wrap items-center gap-2",children:[e.jsx(se,{query:d,setQuery:c,fuse:y}),e.jsx("button",{type:"button",onClick:()=>g(n=>!n),className:"rounded-md bg-space-dark/70 px-3 py-2 text-sm text-yellow-300 backdrop-blur-md hover:bg-white/10",children:f?"All Herbs":"My Herbs"})]}),e.jsx("div",{className:"mb-4",children:e.jsx(Z,{tags:b,counts:a,onChange:r})}),x.length>0&&e.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-sm text-moss",children:"Related tags:"}),x.map(n=>e.jsx("button",{type:"button",onClick:()=>r(s=>Array.from(new Set([...s,n]))),className:"tag-pill",children:w(n)},n))]}),e.jsx(X,{}),e.jsx(q,{herbs:o,highlightQuery:d})]})]})]})}export{me as default};
