import{l as V,r as C,j as e,m as x,n as R,R as f,L as I,W as Y}from"./main-db4a877a.js";import{d as k,t as M,s as z,n as O,a as U}from"./format-5969a492.js";import{u as D,T as L,I as K,c as E,a as W}from"./useLocalStorage-71eeea28.js";import{s as G}from"./slugify-386a61cd.js";import{S as J}from"./star-72076ba0.js";import{h as $}from"./herbs-6272d0e6.js";import{F as Q}from"./fuse-11af6271.js";import{S as q}from"./StarfieldBackground-f3559502.js";/**
 * @license lucide-react v0.298.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=V("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),X="Unknown",ee="Not well documented";function _(){const[t,n]=D("herbFavorites",[]);return{favorites:t,toggle:i=>{n(d=>d.includes(i)?d.filter(o=>o!==i):[...d,i])},isFavorite:i=>t.includes(i)}}const te={Oneirogen:"blue","Dissociative / Sedative":"purple","Empathogen / Euphoriant":"pink","Ritual / Visionary":"green",Other:"yellow"},se={hidden:{},visible:{transition:{staggerChildren:.05}}},T={hidden:{opacity:0,y:10},visible:{opacity:1,y:0}},F=4,A={mechanismOfAction:"How this herb produces its effects in the body.",toxicity:"Known adverse effects or poisoning information.",therapeuticUses:"Traditional or potential healing applications.",contraindications:"Situations where this herb should be avoided.",dosage:"Common oral or smoked amount for effects."};function ne(t){const n=t.toLowerCase();return n.includes("oneirogen")?"from-indigo-700/40 to-purple-700/40":n.includes("ritual")||n.includes("visionary")?"from-green-800/40 to-blue-800/40":n.includes("stimulant")?"from-orange-700/40 to-red-700/40":"from-white/10 to-white/5"}function ie(t,n){let a;if(typeof t=="number"&&(a=t),typeof t=="string"){const c=t.toLowerCase();c==="low"?a=1:c==="moderate"?a=3:c==="high"&&(a=5)}if(n&&/severe|danger/i.test(n))return"danger";if(a!=null)return a<=2?"safe":a<=4?"caution":"danger"}function ae({herb:t,highlight:n=""}){var j,u,m;const[a,c]=C.useState(!1),[i,d]=C.useState(!1),o=()=>c(s=>!s),{isFavorite:y,toggle:w}=_(),b=s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),o())},S=s=>{if(!n)return s;const r=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),p=new RegExp(`(${r})`,"ig");return s.replace(p,'<span class="font-bold text-yellow-300">$1</span>')},N=ne(t.category),v=ie(t.safetyRating,t.toxicity);return e.jsxs(x.div,{layout:!0,initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},exit:{opacity:0,scale:.9},onClick:o,onKeyDown:b,tabIndex:0,role:"button","aria-expanded":a,whileHover:{scale:1.03,boxShadow:"0 0 20px rgba(255,255,255,0.2)",backgroundColor:"rgba(255,255,255,0.1)"},whileTap:{scale:.97},transition:{layout:{duration:.4,ease:"easeInOut"}},className:`hover-glow card-contrast relative cursor-pointer overflow-hidden rounded-2xl bg-gradient-to-br ${N} border border-white/10 p-4 shadow-lg shadow-black/50 ring-1 ring-white/30 backdrop-blur-lg hover:drop-shadow-2xl hover:shadow-psychedelic-pink/40 focus:outline-none focus-visible:shadow-intense focus-visible:ring-2 focus-visible:ring-psychedelic-pink sm:p-6`,children:[e.jsx(x.span,{initial:{opacity:0,y:-4},whileHover:{opacity:1,y:0},whileTap:{opacity:1,y:0},className:"pointer-events-none absolute right-4 top-2 text-xs text-sand",children:"+ More Info"}),e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[e.jsx("h3",{className:"text-shadow mb-0.5 font-herb text-xl text-white sm:text-2xl",dangerouslySetInnerHTML:{__html:S(t.name)}}),v&&e.jsx("span",{className:`rounded-full px-2 py-0.5 text-xs font-medium shadow ${v==="safe"?"bg-green-700/40 text-green-200 ring-1 ring-green-400/60":v==="caution"?"bg-yellow-700/40 text-yellow-200 ring-1 ring-yellow-400/60":"bg-red-700/40 text-red-200 ring-1 ring-red-500/60"}`,children:v==="safe"?"✅ Safe":v==="caution"?"⚠️ Caution":"☠️ High Risk"})]}),t.scientificName&&e.jsx("p",{className:"mt-0.5 text-xs italic text-sand",dangerouslySetInnerHTML:{__html:S(t.scientificName)}}),e.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2 text-sm text-sand sm:text-base",children:[t.category&&e.jsx(L,{label:t.category,variant:te[t.category]||"purple"}),((j=t.effects)==null?void 0:j.length)>0&&e.jsx("span",{children:t.effects.join(", ")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),w(t.id)},"aria-label":y(t.id)?"Remove favorite":"Add favorite",className:"rounded-md p-1 text-yellow-400 hover:bg-white/10",children:e.jsx(J,{fill:y(t.id)?"currentColor":"none",size:18})}),e.jsx(x.span,{layout:!0,initial:!1,animate:{rotate:a?90:0},transition:{duration:.3},className:"text-cyan-200 transition-transform",children:e.jsx(Z,{size:18})})]})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[(i||t.tags.length<=F?t.tags:t.tags.slice(0,F)).map(s=>e.jsx(L,{label:k(s),variant:M(s),className:a?"animate-pulse":""},s)),t.tags.length>F&&e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),d(r=>!r)},className:"focus:outline-none",children:e.jsx(L,{label:i?"Show Less":`+${t.tags.length-F} more`,variant:"yellow"})})]}),e.jsx(R,{initial:!1,children:a&&e.jsx(x.div,{layout:!0,initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},transition:{duration:.4,ease:"easeInOut"},className:"mt-4 overflow-hidden whitespace-pre-line break-words text-sm text-sand sm:text-base",children:e.jsxs(x.div,{variants:se,initial:"hidden",animate:"visible",exit:"hidden",className:"space-y-3",children:[["description","mechanismOfAction","therapeuticUses","sideEffects","contraindications","drugInteractions","preparation","dosage","pharmacokinetics","onset","duration","intensity","region","legalStatus","safetyRating","toxicity","toxicityLD50"].map(s=>{const r=t[s],p=typeof r=="string"&&r.trim()&&r!=="No description provided."?r:s==="mechanismOfAction"||s==="toxicity"||s==="toxicityLD50"?X:ee;return e.jsxs(x.div,{variants:T,children:[e.jsxs("span",{className:"font-semibold text-lime-300",children:[s.replace(/([A-Z])/g," $1")+":",A[s]&&e.jsx(K,{text:A[s]})]})," ",s==="safetyRating"?e.jsx("span",{className:typeof r=="number"?z(r):"",children:p}):p]},s)}),((u=t.activeConstituents)==null?void 0:u.length)>0&&e.jsxs(x.div,{variants:T,children:[e.jsx("span",{className:"font-semibold text-lime-300",children:"Active Compounds:"})," ",t.activeConstituents.map((s,r)=>e.jsxs(f.Fragment,{children:[r>0&&", ",e.jsx(I,{to:`/compounds#${G(s.name)}`,onClick:p=>p.stopPropagation(),className:"hover-glow inline-block rounded px-1 text-sky-300 underline",children:s.name})]},s.name))]}),((m=t.tags)==null?void 0:m.length)>0&&e.jsx(x.div,{variants:T,className:"flex max-h-32 flex-wrap gap-2 overflow-y-auto pt-2",children:t.tags.slice(0,10).map(s=>e.jsx(L,{label:k(s),variant:M(s),className:a?"animate-pulse":""},s))}),e.jsxs(x.div,{variants:T,className:"pt-2",children:[e.jsx(I,{to:`/herbs/${t.id}`,onClick:s=>s.stopPropagation(),className:"text-comet underline",children:"View full page"}),t.affiliateLink&&e.jsx("a",{href:t.affiliateLink,target:"_blank",rel:"noopener noreferrer",onClick:s=>s.stopPropagation(),className:"ml-4 text-sm text-sky-300 underline",children:"🌐 Buy Online"})]})]})},"content")})]})}const oe={hidden:{},visible:{transition:{staggerChildren:.05}}},re={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},le=({herbs:t,highlightQuery:n="",batchSize:a=24})=>{const[c,i]=f.useState(a),d=()=>i(o=>Math.min(o+a,t.length));return t.length===0?e.jsx("p",{className:"text-center text-sand/80",children:"No herbs match your search."}):e.jsxs(e.Fragment,{children:[e.jsx(x.div,{layout:!0,variants:oe,initial:"hidden",animate:"visible",className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:e.jsx(R,{children:t.slice(0,c).map(o=>e.jsx(x.div,{variants:re,layout:!0,children:e.jsx(ae,{herb:o,highlight:n})},o.id||o.name))})},t.map(o=>o.id).join("-")),c<t.length&&e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{type:"button",onClick:d,className:"rounded-md bg-black/30 px-4 py-2 text-sand hover:bg-white/10 backdrop-blur-md",children:"Show More"})})]})},ce=le,de=["Effect","Preparation","Safety","Chemistry","Region","Other"];function ue({tags:t,onChange:n,storageKey:a="tagFilters",counts:c={}}){const[i,d]=D(a,[]),[o,y]=C.useState({Effect:!0,Preparation:!1,Safety:!1,Chemistry:!1,Region:!1,Other:!1}),[w,b]=C.useState({Effect:!1,Preparation:!1,Safety:!1,Chemistry:!1,Region:!1,Other:!1});C.useEffect(()=>{n==null||n(i)},[i,n]);const S=C.useMemo(()=>{const u={Effect:[],Preparation:[],Safety:[],Chemistry:[],Region:[],Other:[]};return t.forEach(m=>{const s=E(O(m)),r=U(s);u[r].includes(s)||u[r].push(s)}),u},[t]),N=u=>{const m=E(u);d(s=>s.includes(m)?s.filter(r=>r!==m):[...s,m])},v=u=>{switch(u){case"Effect":return"⚡ Effects";case"Preparation":return"🌿 Preparation";case"Safety":return"⚠️ Safety";case"Chemistry":return"🧪 Chemistry";case"Region":return"📍 Region";default:return"✨ Other"}},j=u=>{const m=S[u]||[],s=12,r=w[u]?m:m.slice(0,s);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"tag-list",children:[r.map(p=>e.jsx(x.button,{type:"button",onClick:()=>N(p),whileHover:{scale:1.1},whileTap:{scale:.95},animate:{opacity:i.includes(p)?1:.6},"aria-pressed":i.includes(p),className:"flex-shrink-0 focus:outline-none",title:c[p]?`${k(O(p))} — used in ${c[p]} herbs`:k(O(p)),children:e.jsx(L,{label:k(O(p)),variant:i.includes(p)?"green":M(p),className:W(i.includes(p)&&"ring-1 ring-emerald-400")})},p)),m.length>s&&e.jsx(x.button,{type:"button",whileHover:{scale:1.05},onClick:()=>b(p=>({...p,[u]:!p[u]})),className:"tag-pill mt-2",children:w[u]?"Show Less":"Show More"})]})})};return e.jsx("div",{className:"space-y-3 sticky top-16 z-20 sm:static",children:de.map(u=>e.jsxs("div",{className:"tag-section",children:[e.jsxs("button",{type:"button",className:"tag-label",onClick:()=>y(m=>({...m,[u]:!m[u]})),"aria-expanded":o[u],children:[v(u),e.jsx(x.span,{animate:{rotate:o[u]?90:0},className:"ml-1 text-xs",children:"▶"})]}),e.jsx(R,{initial:!1,children:o[u]&&e.jsx(x.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},children:j(u)},"content")})]},u))})}function me(){const t=f.useMemo(()=>{const a={};return $.forEach(c=>{const i=c.category.split("/")[0].trim();a[i]=(a[i]||0)+1}),a},[]),n=Math.max(...Object.values(t));return e.jsx("div",{className:"space-y-2",children:Object.entries(t).map(([a,c])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-40 text-sm",children:a}),e.jsx("div",{className:"flex-1 bg-slate-700/50 h-2 rounded",children:e.jsx("div",{className:"h-2 rounded bg-fuchsia-500",style:{width:`${c/n*100}%`}})}),e.jsx("span",{className:"text-sm",children:c})]},a))})}function B(t){const n=t.toLowerCase();return/(empathogen|euphoriant)/.test(n)?"Empathogen":/(psychedelic|visionary)/.test(n)?"Psychedelic":/dissociative|sedative/.test(n)?"Dissociative":/oneirogen|dream/.test(n)?"Oneirogen":"Other"}function pe(t,n={}){const{favorites:a=[]}=n,[c,i]=f.useState(""),[d,o]=f.useState([]),[y,w]=f.useState(!1),[b,S]=f.useState([]),[N,v]=f.useState(""),j=f.useMemo(()=>new Q(t,{keys:["name","scientificName","effects","description","tags"],threshold:.4,includeMatches:!0,isCaseSensitive:!1,ignoreLocation:!0}),[t]);return{filtered:f.useMemo(()=>{let m=t;const s=c.trim();return s&&(m=j.search(s).map(r=>r.item)),d.length&&(m=m.filter(r=>d.every(p=>r.tags.some(l=>E(l)===E(p))))),b.length&&(m=m.filter(r=>b.includes(B(r.category)))),y&&(m=m.filter(r=>a.includes(r.id))),N==="name"&&(m=[...m].sort((r,p)=>r.name.localeCompare(p.name))),m},[t,c,d,b,y,a,N,j]),query:c,setQuery:i,tags:d,setTags:o,categories:b,setCategories:S,favoritesOnly:y,setFavoritesOnly:w,sort:N,setSort:v,fuse:j}}function fe({selected:t,onChange:n}){const a=f.useMemo(()=>{const i={};return $.forEach(d=>{const o=B(d.category);i[o]=(i[o]||0)+1}),i},[]),c=i=>{const d=t.includes(i)?t.filter(o=>o!==i):[...t,i];n==null||n(d)};return e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(a).sort((i,d)=>d[1]-i[1]).map(([i,d])=>e.jsxs("button",{type:"button",onClick:()=>c(i),className:`tag-pill ${t.includes(i)?"ring-2 ring-emerald-400":""}`,children:[i," (",d,")"]},i))})}function he(){const[t]=f.useState($);return t}function xe({query:t,setQuery:n,fuse:a}){const[c,i]=f.useState([]);f.useEffect(()=>{const o=t.trim();i(o?a.search(o,{limit:5,isCaseSensitive:!1,ignoreLocation:!0}):[])},[t,a]);const d=o=>{if(!t)return o;const y=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),w=new RegExp(`(${y})`,"ig");return o.replace(w,'<span class="font-bold">$1</span>')};return e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",placeholder:"Search herbs...",value:t,onChange:o=>n(o.target.value),className:"w-full rounded-md bg-space-dark/70 px-3 py-2 text-white backdrop-blur-md focus:outline-none"}),c.length>0&&e.jsx("ul",{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-black/80 p-2 text-sm text-sand backdrop-blur-md",children:c.map(o=>e.jsx("li",{children:e.jsx("button",{type:"button",className:"w-full text-left hover:bg-white/10 px-2 py-1 rounded",onClick:()=>n(o.item.name),dangerouslySetInnerHTML:{__html:d(o.item.name)}})},o.item.id))})]})}function ge(t,n){try{const a=localStorage.getItem(t);return a?JSON.parse(a):n}catch{return n}}function P(t,n){try{localStorage.setItem(t,JSON.stringify(n))}catch{}}function ke(){const t=he(),{favorites:n}=_(),{filtered:a,query:c,setQuery:i,tags:d,setTags:o,categories:y,setCategories:w,favoritesOnly:b,setFavoritesOnly:S,fuse:N}=pe(t,{favorites:n});f.useEffect(()=>{const l=ge("dbScroll",0);l&&window.scrollTo(0,l);const h=()=>P("dbScroll",window.scrollY);return window.addEventListener("scroll",h),()=>{P("dbScroll",window.scrollY),window.removeEventListener("scroll",h)}},[]);const v=f.useMemo(()=>{const l=t.reduce((h,g)=>h.concat(g.tags),[]);return Array.from(new Set(l.map(E)))},[t]),j=f.useMemo(()=>{const l={};return t.forEach(h=>{h.tags.forEach(g=>{const H=E(g);l[H]=(l[H]||0)+1})}),l},[t]),[u,m]=f.useState(!1),[s,r]=f.useState(!0);f.useEffect(()=>{let l=window.scrollY;const h=()=>{const g=window.scrollY;r(g<l||g<100),l=g};return window.addEventListener("scroll",h),()=>window.removeEventListener("scroll",h)},[]),f.useEffect(()=>{const l=()=>{window.scrollY>150&&m(!1)};return window.addEventListener("scroll",l),window.addEventListener("touchmove",l),()=>{window.removeEventListener("scroll",l),window.removeEventListener("touchmove",l)}},[]);const p=f.useMemo(()=>{if(d.length===0)return[];const l={};return t.forEach(h=>{d.every(g=>h.tags.includes(g))&&h.tags.forEach(g=>{d.includes(g)||(l[g]=(l[g]||0)+1)})}),Object.entries(l).sort((h,g)=>g[1]-h[1]).slice(0,5).map(([h])=>h)},[d,t]);return e.jsxs(e.Fragment,{children:[e.jsxs(Y,{children:[e.jsx("title",{children:"Database - The Hippie Scientist"}),e.jsx("meta",{name:"description",content:"Browse herbal entries and expand each to learn more about their effects and usage."})]}),e.jsxs("div",{className:"relative min-h-screen px-4 pt-20",children:[e.jsx(q,{}),e.jsxs("div",{className:"relative mx-auto max-w-6xl",children:[e.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-gradient mb-6 text-5xl font-bold",children:"Herb Database"}),e.jsx("p",{className:"mx-auto max-w-4xl text-xl text-sand",children:"Explore our collection of herbs. Click any entry to see detailed information."})]}),e.jsxs(x.div,{className:"sticky top-2 z-20 mb-4 flex flex-wrap items-center gap-2",animate:{y:s?0:-60,opacity:s?1:0},transition:{duration:.3},children:[e.jsx(xe,{query:c,setQuery:i,fuse:N}),e.jsx("button",{type:"button",onClick:()=>S(l=>!l),className:"rounded-md bg-space-dark/70 px-3 py-2 text-sm text-yellow-300 backdrop-blur-md hover:bg-white/10",children:b?"All Herbs":"My Herbs"}),e.jsx("button",{type:"button",onClick:()=>m(l=>!l),className:"rounded-md bg-space-dark/70 px-3 py-2 text-sm text-sand backdrop-blur-md hover:bg-white/10 sm:hidden",children:u?"Hide Filters":"Show Filters"})]}),e.jsxs("div",{className:`mb-4 space-y-4 ${u?"":"hidden sm:block"}`,children:[e.jsx(fe,{selected:y,onChange:w}),e.jsx(ue,{tags:v,counts:j,onChange:o})]}),p.length>0&&e.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-sm text-moss",children:"Related tags:"}),p.map(l=>e.jsx("button",{type:"button",onClick:()=>o(h=>Array.from(new Set([...h,l]))),className:"tag-pill",children:k(l)},l))]}),e.jsx(me,{}),e.jsx(ce,{herbs:a,highlightQuery:c})]})]})]})}export{ke as default};
