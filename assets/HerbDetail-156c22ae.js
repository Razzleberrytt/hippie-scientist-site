import{j as e,E as v,k as w,R as p,L as d,W as A,m as S}from"./main-8107ca7e.js";import{a as b,d as H,t as L}from"./herbs-8a0b8949.js";import{s as O,u as E,T as $}from"./useLocalStorage-17c46a94.js";import{s as l}from"./safeHerbField-1fbb551f.js";import{s as y}from"./slugify-386a61cd.js";function B(i){return b.map(s=>{if(s.id===i.id)return{h:s,score:-1};let r=0;const m=new Set(s.tags??[]),f=new Set(s.effects||[]);return(i.tags??[]).forEach(o=>{m.has(o)&&(r+=2)}),(i.effects||[]).forEach(o=>{f.has(o)&&(r+=1)}),i.mechanismOfAction&&s.mechanismOfAction&&i.mechanismOfAction===s.mechanismOfAction&&(r+=2),{h:s,score:r}}).sort((s,r)=>r.score-s.score).slice(0,5).filter(s=>s.score>0).map(s=>s.h)}function C(){var g,j;const{id:i}=w(),n=b.find(a=>a.id===i),s=O(n||{}),[r,m]=E(`notes-${i}`,""),[f,o]=p.useState(!1);if(!n)return console.warn("Herb not found or malformed:",i),e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("p",{children:"Herb not found."}),e.jsx(d,{to:"/database",className:"text-comet underline",children:"Back to database"})]});const t={...s,name:l(s.name,"Unnamed Herb"),description:l(s.description,""),category:l(s.category,"Other"),tags:Array.isArray(s.tags)?s.tags:[],effects:Array.isArray(s.effects)?s.effects:[],slug:s.slug||y(l(s.name,""))};(!(n!=null&&n.name)||!(n!=null&&n.description))&&console.warn("Incomplete herb data",i,n);const u=p.useMemo(()=>B(t),[t]),N=`${t.name} is classified as ${t.category}. Known effects include ${t.effects.join(", ")}.`;return e.jsxs(e.Fragment,{children:[e.jsxs(A,{children:[e.jsxs("title",{children:[t.name," - The Hippie Scientist"]}),t.description&&e.jsx("meta",{name:"description",content:t.description})]}),e.jsxs(S.div,{initial:{opacity:0},animate:{opacity:1},className:"mx-auto max-w-3xl space-y-6 px-6 py-12",children:[e.jsx(d,{to:"/database",className:"text-comet underline",children:"← Back"}),e.jsx("h1",{className:"text-gradient text-4xl font-bold",children:t.name}),t.scientificName&&e.jsx("p",{className:"italic",children:t.scientificName}),e.jsxs("div",{className:"space-y-2",children:[["description","mechanismOfAction","therapeuticUses","sideEffects","contraindications","drugInteractions","preparation","dosage","pharmacokinetics","onset","duration","intensity","region","legalStatus","safetyRating","toxicity","toxicityLD50"].map(a=>{const c=t[a],x=Array.isArray(c),h=x?c:l(c,"");if(!x&&h==="")return null;const k=x?h.join(", "):String(h);return e.jsxs("div",{children:[e.jsxs("span",{className:"font-semibold text-lime-300",children:[a.replace(/([A-Z])/g," $1"),":"]})," ",k]},a)}),((g=t.activeConstituents)==null?void 0:g.length)>0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-lime-300",children:"Active Compounds:"})," ",t.activeConstituents.map((a,c)=>e.jsxs(p.Fragment,{children:[c>0&&", ",e.jsx(d,{className:"text-sky-300 underline",to:`/compounds#${y(a.name)}`,children:a.name})]},a.name))]}),t.affiliateLink&&t.affiliateLink.startsWith("http")&&e.jsx("a",{href:t.affiliateLink,target:"_blank",rel:"noopener noreferrer",className:"text-sky-300 underline",children:"Buy Online"}),e.jsx("div",{className:"flex flex-wrap gap-2 pt-2",children:(j=t.tags)==null?void 0:j.map(a=>e.jsx($,{label:H(a),variant:L(a)},a))})]}),e.jsx("button",{type:"button",className:"rounded-md bg-gradient-to-r from-violet-900 to-sky-900 px-3 py-2 text-white hover:opacity-90",onClick:()=>o(a=>!a),children:"🧠 Smart Explore"}),f&&u.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"mt-4 text-2xl font-bold text-sky-300",children:"Similar Herbs"}),e.jsx("ul",{className:"list-inside list-disc",children:u.map(a=>e.jsx("li",{children:e.jsx(d,{className:"text-comet underline",to:`/herbs/${a.id}`,children:a.name})},a.id))})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-sky-300",children:"Your Notes"}),e.jsx("textarea",{value:r,onChange:a=>m(a.target.value),className:"mt-2 w-full rounded-md bg-black/20 p-2 text-white",rows:5})]}),e.jsxs("details",{className:"rounded-md bg-slate-800/40 p-4",children:[e.jsx("summary",{className:"cursor-pointer text-sky-300",children:"🧬 Summarize This Herb"}),e.jsx("p",{className:"mt-2",children:N})]})]}),t.affiliateLink&&t.affiliateLink.startsWith("http")&&e.jsx("a",{href:t.affiliateLink,target:"_blank",rel:"noopener noreferrer",className:"fixed bottom-4 right-4 z-20 rounded-full bg-gradient-to-r from-violet-600 to-sky-600 px-4 py-3 text-white shadow-lg hover:shadow-xl",children:"Buy Online"})]})}function z(){return e.jsx(v,{children:e.jsx(C,{})})}export{z as default};
