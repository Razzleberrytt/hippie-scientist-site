import{R as C,j as l,m as k,A as he,r as H,W as Me,L as we,D as Fe}from"./main-329f383e.js";import{H as Se,u as Be}from"./HerbCardAccordion-5d55640a.js";import{u as ve,I as De,T as Ne,c as je}from"./useLocalStorage-b2e0762e.js";import{c as v,n as V,b as Ie,d as G,t as Le,a as de,h as _e}from"./herbs-1a452efb.js";import{S as ke}from"./StarfieldBackground-d61b1f2d.js";import"./slugify-386a61cd.js";import"./herbs-1d311145.js";const Oe={hidden:{},visible:{transition:{staggerChildren:.05}}},Re={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},Te=({herbs:t,highlightQuery:e="",batchSize:s=24})=>{const[r,n]=C.useState(s),i=()=>n(o=>Math.min(o+s,t.length));return t.length===0?l.jsx("p",{className:"text-center text-sand/80",children:"No herbs match your search."}):l.jsxs(l.Fragment,{children:[l.jsx(k.div,{layout:!0,variants:Oe,initial:"hidden",animate:"visible",className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:l.jsx(he,{children:t.slice(0,r).map(o=>l.jsx(k.div,{variants:Re,layout:!0,children:l.jsx(Se,{herb:o,highlight:e})},o.id||o.name))})},t.map(o=>o.id).join("-")),r<t.length&&l.jsx("div",{className:"mt-6 text-center",children:l.jsx("button",{type:"button",onClick:i,className:"rounded-md bg-black/30 px-4 py-2 text-sand hover:bg-white/10 backdrop-blur-md",children:"Show More"})})]})},$e=Te,ne=5,Pe=["Effect","Preparation","Safety","Chemistry","Region","Other"];function He({tags:t,onChange:e,storageKey:s="tagFilters",counts:r={}}){const[n,i]=ve(s,[]),[o,c]=H.useState({Effect:!0,Preparation:!1,Safety:!1,Chemistry:!1,Region:!1,Other:!1}),[a,u]=H.useState({Effect:!1,Preparation:!1,Safety:!1,Chemistry:!1,Region:!1,Other:!1});H.useEffect(()=>{e==null||e(n)},[n,e]);const h=H.useMemo(()=>{const f={Effect:[],Preparation:[],Safety:[],Chemistry:[],Region:[],Other:[]};return t.forEach(E=>{const M=v(V(E)),y=Ie(M);f[y].includes(M)||f[y].push(M)}),f},[t]),g=f=>{const E=v(f);i(M=>M.includes(E)?M.filter(y=>y!==E):[...M,E])},p=f=>{switch(f){case"Effect":return"âš¡ Effects";case"Preparation":return"ðŸŒ¿ Preparation";case"Safety":return"âš ï¸ Safety";case"Chemistry":return"ðŸ§ª Chemistry";case"Region":return"ðŸ“ Region";default:return"âœ¨ Other"}},A=f=>{const E=h[f]||[],M=12,y=E.filter(d=>(r[v(d)]||0)>=ne),S=E.filter(d=>(r[v(d)]||0)<ne),w=[...y,...S],B=a[f]?w:y.slice(0,M),j=S.length>0||y.length>M;return l.jsx(l.Fragment,{children:l.jsxs("div",{className:"tag-list",children:[B.map(d=>l.jsx(k.button,{type:"button",onClick:()=>g(d),whileHover:{scale:1.1},whileTap:{scale:.95},animate:{opacity:n.includes(d)?1:.6},"aria-pressed":n.includes(d),tabIndex:0,className:"flex-shrink-0 focus:outline-none",children:l.jsx(De,{text:`${G(V(d))} â€” used in ${r[d]??r[v(d)]??0} herbs`,children:l.jsx(Ne,{label:G(V(d)),variant:n.includes(d)?"green":Le(d),className:je(n.includes(d)&&"ring-1 ring-emerald-400")})})},d)),j&&l.jsx(k.button,{type:"button",whileHover:{scale:1.05},onClick:()=>u(d=>({...d,[f]:!d[f]})),tabIndex:0,className:"tag-pill mt-2",children:a[f]?"Show Less":"Show More"})]})})};return l.jsx("div",{className:"sticky top-16 z-20 space-y-3 rounded-xl bg-black/30 p-2 backdrop-blur-md sm:static sm:bg-transparent sm:p-0",children:Pe.map(f=>l.jsxs("div",{className:"tag-section",children:[l.jsxs("button",{type:"button",className:"tag-label",tabIndex:0,onClick:()=>c(E=>({...E,[f]:!E[f]})),"aria-expanded":o[f],children:[p(f),l.jsx(k.span,{animate:{rotate:o[f]?90:0},className:"ml-1 text-xs",children:"â–¶"})]}),l.jsx(he,{initial:!1,children:o[f]&&l.jsx(k.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},children:A(f)},"content")})]},f))})}const re=5;function ze(){const t=C.useMemo(()=>{const c={};return de.forEach(a=>{const u=a.category.split("/")[0].trim();c[u]=(c[u]||0)+1}),c},[]),e=C.useMemo(()=>Object.entries(t).sort((c,a)=>a[1]-c[1]),[t]),[s,r]=C.useState(!1),n=C.useMemo(()=>s?e:e.filter(([,c])=>c>=re),[e,s]),i=C.useMemo(()=>e.some(([,c])=>c<re),[e]),o=Math.max(...e.map(([,c])=>c));return l.jsxs("div",{className:"relative space-y-2",onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),children:[n.map(([c,a])=>l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"w-40 text-sm",children:c}),l.jsx("div",{className:"flex-1 bg-slate-700/50 h-2 rounded",children:l.jsx("div",{className:"h-2 rounded bg-fuchsia-500",style:{width:`${a/o*100}%`}})}),l.jsx("span",{className:"text-sm",children:a})]},c)),i&&!s&&l.jsx("div",{className:"pointer-events-none text-center text-xs text-moss",children:"Hover to show more"})]})}function _(t){return Array.isArray?Array.isArray(t):ge(t)==="[object Array]"}const Ke=1/0;function We(t){if(typeof t=="string")return t;let e=t+"";return e=="0"&&1/t==-Ke?"-0":e}function Ye(t){return t==null?"":We(t)}function I(t){return typeof t=="string"}function fe(t){return typeof t=="number"}function Ve(t){return t===!0||t===!1||Ue(t)&&ge(t)=="[object Boolean]"}function me(t){return typeof t=="object"}function Ue(t){return me(t)&&t!==null}function D(t){return t!=null}function U(t){return!t.trim().length}function ge(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const Ge="Incorrect 'index' type",Qe=t=>`Invalid value for key ${t}`,Je=t=>`Pattern length exceeds max of ${t}.`,Xe=t=>`Missing ${t} property in key`,Ze=t=>`Property 'weight' in key '${t}' must be a positive integer`,ie=Object.prototype.hasOwnProperty;class qe{constructor(e){this._keys=[],this._keyMap={};let s=0;e.forEach(r=>{let n=pe(r);this._keys.push(n),this._keyMap[n.id]=n,s+=n.weight}),this._keys.forEach(r=>{r.weight/=s})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function pe(t){let e=null,s=null,r=null,n=1,i=null;if(I(t)||_(t))r=t,e=ce(t),s=Q(t);else{if(!ie.call(t,"name"))throw new Error(Xe("name"));const o=t.name;if(r=o,ie.call(t,"weight")&&(n=t.weight,n<=0))throw new Error(Ze(o));e=ce(o),s=Q(o),i=t.getFn}return{path:e,id:s,weight:n,src:r,getFn:i}}function ce(t){return _(t)?t:t.split(".")}function Q(t){return _(t)?t.join("."):t}function et(t,e){let s=[],r=!1;const n=(i,o,c)=>{if(D(i))if(!o[c])s.push(i);else{let a=o[c];const u=i[a];if(!D(u))return;if(c===o.length-1&&(I(u)||fe(u)||Ve(u)))s.push(Ye(u));else if(_(u)){r=!0;for(let h=0,g=u.length;h<g;h+=1)n(u[h],o,c+1)}else o.length&&n(u,o,c+1)}};return n(t,I(e)?e.split("."):e,0),r?s:s[0]}const tt={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},st={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(t,e)=>t.score===e.score?t.idx<e.idx?-1:1:t.score<e.score?-1:1},nt={location:0,threshold:.6,distance:100},rt={useExtendedSearch:!1,getFn:et,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var m={...st,...tt,...nt,...rt};const it=/[^ ]+/g;function ct(t=1,e=3){const s=new Map,r=Math.pow(10,e);return{get(n){const i=n.match(it).length;if(s.has(i))return s.get(i);const o=1/Math.pow(i,.5*t),c=parseFloat(Math.round(o*r)/r);return s.set(i,c),c},clear(){s.clear()}}}class te{constructor({getFn:e=m.getFn,fieldNormWeight:s=m.fieldNormWeight}={}){this.norm=ct(s,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((s,r)=>{this._keysMap[s.id]=r})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,I(this.docs[0])?this.docs.forEach((e,s)=>{this._addString(e,s)}):this.docs.forEach((e,s)=>{this._addObject(e,s)}),this.norm.clear())}add(e){const s=this.size();I(e)?this._addString(e,s):this._addObject(e,s)}removeAt(e){this.records.splice(e,1);for(let s=e,r=this.size();s<r;s+=1)this.records[s].i-=1}getValueForItemAtKeyId(e,s){return e[this._keysMap[s]]}size(){return this.records.length}_addString(e,s){if(!D(e)||U(e))return;let r={v:e,i:s,n:this.norm.get(e)};this.records.push(r)}_addObject(e,s){let r={i:s,$:{}};this.keys.forEach((n,i)=>{let o=n.getFn?n.getFn(e):this.getFn(e,n.path);if(D(o)){if(_(o)){let c=[];const a=[{nestedArrIndex:-1,value:o}];for(;a.length;){const{nestedArrIndex:u,value:h}=a.pop();if(D(h))if(I(h)&&!U(h)){let g={v:h,i:u,n:this.norm.get(h)};c.push(g)}else _(h)&&h.forEach((g,p)=>{a.push({nestedArrIndex:p,value:g})})}r.$[i]=c}else if(I(o)&&!U(o)){let c={v:o,n:this.norm.get(o)};r.$[i]=c}}}),this.records.push(r)}toJSON(){return{keys:this.keys,records:this.records}}}function xe(t,e,{getFn:s=m.getFn,fieldNormWeight:r=m.fieldNormWeight}={}){const n=new te({getFn:s,fieldNormWeight:r});return n.setKeys(t.map(pe)),n.setSources(e),n.create(),n}function ot(t,{getFn:e=m.getFn,fieldNormWeight:s=m.fieldNormWeight}={}){const{keys:r,records:n}=t,i=new te({getFn:e,fieldNormWeight:s});return i.setKeys(r),i.setIndexRecords(n),i}function z(t,{errors:e=0,currentLocation:s=0,expectedLocation:r=0,distance:n=m.distance,ignoreLocation:i=m.ignoreLocation}={}){const o=e/t.length;if(i)return o;const c=Math.abs(r-s);return n?o+c/n:c?1:o}function at(t=[],e=m.minMatchCharLength){let s=[],r=-1,n=-1,i=0;for(let o=t.length;i<o;i+=1){let c=t[i];c&&r===-1?r=i:!c&&r!==-1&&(n=i-1,n-r+1>=e&&s.push([r,n]),r=-1)}return t[i-1]&&i-r>=e&&s.push([r,i-1]),s}const R=32;function ut(t,e,s,{location:r=m.location,distance:n=m.distance,threshold:i=m.threshold,findAllMatches:o=m.findAllMatches,minMatchCharLength:c=m.minMatchCharLength,includeMatches:a=m.includeMatches,ignoreLocation:u=m.ignoreLocation}={}){if(e.length>R)throw new Error(Je(R));const h=e.length,g=t.length,p=Math.max(0,Math.min(r,g));let A=i,f=p;const E=c>1||a,M=E?Array(g):[];let y;for(;(y=t.indexOf(e,f))>-1;){let x=z(e,{currentLocation:y,expectedLocation:p,distance:n,ignoreLocation:u});if(A=Math.min(x,A),f=y+h,E){let b=0;for(;b<h;)M[y+b]=1,b+=1}}f=-1;let S=[],w=1,B=h+g;const j=1<<h-1;for(let x=0;x<h;x+=1){let b=0,F=B;for(;b<F;)z(e,{errors:x,currentLocation:p+F,expectedLocation:p,distance:n,ignoreLocation:u})<=A?b=F:B=F,F=Math.floor((B-b)/2+b);B=F;let L=Math.max(1,p-F+1),Y=o?g:Math.min(p+F,g)+h,T=Array(Y+2);T[Y+1]=(1<<x)-1;for(let N=Y;N>=L;N-=1){let P=N-1,se=s[t.charAt(P)];if(E&&(M[P]=+!!se),T[N]=(T[N+1]<<1|1)&se,x&&(T[N]|=(S[N+1]|S[N])<<1|1|S[N+1]),T[N]&j&&(w=z(e,{errors:x,currentLocation:P,expectedLocation:p,distance:n,ignoreLocation:u}),w<=A)){if(A=w,f=P,f<=p)break;L=Math.max(1,2*p-f)}}if(z(e,{errors:x+1,currentLocation:p,expectedLocation:p,distance:n,ignoreLocation:u})>A)break;S=T}const d={isMatch:f>=0,score:Math.max(.001,w)};if(E){const x=at(M,c);x.length?a&&(d.indices=x):d.isMatch=!1}return d}function lt(t){let e={};for(let s=0,r=t.length;s<r;s+=1){const n=t.charAt(s);e[n]=(e[n]||0)|1<<r-s-1}return e}const K=String.prototype.normalize?t=>t.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):t=>t;class Ae{constructor(e,{location:s=m.location,threshold:r=m.threshold,distance:n=m.distance,includeMatches:i=m.includeMatches,findAllMatches:o=m.findAllMatches,minMatchCharLength:c=m.minMatchCharLength,isCaseSensitive:a=m.isCaseSensitive,ignoreDiacritics:u=m.ignoreDiacritics,ignoreLocation:h=m.ignoreLocation}={}){if(this.options={location:s,threshold:r,distance:n,includeMatches:i,findAllMatches:o,minMatchCharLength:c,isCaseSensitive:a,ignoreDiacritics:u,ignoreLocation:h},e=a?e:e.toLowerCase(),e=u?K(e):e,this.pattern=e,this.chunks=[],!this.pattern.length)return;const g=(A,f)=>{this.chunks.push({pattern:A,alphabet:lt(A),startIndex:f})},p=this.pattern.length;if(p>R){let A=0;const f=p%R,E=p-f;for(;A<E;)g(this.pattern.substr(A,R),A),A+=R;if(f){const M=p-R;g(this.pattern.substr(M),M)}}else g(this.pattern,0)}searchIn(e){const{isCaseSensitive:s,ignoreDiacritics:r,includeMatches:n}=this.options;if(e=s?e:e.toLowerCase(),e=r?K(e):e,this.pattern===e){let E={isMatch:!0,score:0};return n&&(E.indices=[[0,e.length-1]]),E}const{location:i,distance:o,threshold:c,findAllMatches:a,minMatchCharLength:u,ignoreLocation:h}=this.options;let g=[],p=0,A=!1;this.chunks.forEach(({pattern:E,alphabet:M,startIndex:y})=>{const{isMatch:S,score:w,indices:B}=ut(e,E,M,{location:i+y,distance:o,threshold:c,findAllMatches:a,minMatchCharLength:u,includeMatches:n,ignoreLocation:h});S&&(A=!0),p+=w,S&&B&&(g=[...g,...B])});let f={isMatch:A,score:A?p/this.chunks.length:1};return A&&n&&(f.indices=g),f}}class O{constructor(e){this.pattern=e}static isMultiMatch(e){return oe(e,this.multiRegex)}static isSingleMatch(e){return oe(e,this.singleRegex)}search(){}}function oe(t,e){const s=t.match(e);return s?s[1]:null}class ht extends O{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const s=e===this.pattern;return{isMatch:s,score:s?0:1,indices:[0,this.pattern.length-1]}}}class dt extends O{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const r=e.indexOf(this.pattern)===-1;return{isMatch:r,score:r?0:1,indices:[0,e.length-1]}}}class ft extends O{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const s=e.startsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,this.pattern.length-1]}}}class mt extends O{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const s=!e.startsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,e.length-1]}}}class gt extends O{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const s=e.endsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class pt extends O{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const s=!e.endsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,e.length-1]}}}class Ee extends O{constructor(e,{location:s=m.location,threshold:r=m.threshold,distance:n=m.distance,includeMatches:i=m.includeMatches,findAllMatches:o=m.findAllMatches,minMatchCharLength:c=m.minMatchCharLength,isCaseSensitive:a=m.isCaseSensitive,ignoreDiacritics:u=m.ignoreDiacritics,ignoreLocation:h=m.ignoreLocation}={}){super(e),this._bitapSearch=new Ae(e,{location:s,threshold:r,distance:n,includeMatches:i,findAllMatches:o,minMatchCharLength:c,isCaseSensitive:a,ignoreDiacritics:u,ignoreLocation:h})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class ye extends O{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let s=0,r;const n=[],i=this.pattern.length;for(;(r=e.indexOf(this.pattern,s))>-1;)s=r+i,n.push([r,s-1]);const o=!!n.length;return{isMatch:o,score:o?0:1,indices:n}}}const J=[ht,ye,ft,mt,pt,gt,dt,Ee],ae=J.length,xt=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,At="|";function Et(t,e={}){return t.split(At).map(s=>{let r=s.trim().split(xt).filter(i=>i&&!!i.trim()),n=[];for(let i=0,o=r.length;i<o;i+=1){const c=r[i];let a=!1,u=-1;for(;!a&&++u<ae;){const h=J[u];let g=h.isMultiMatch(c);g&&(n.push(new h(g,e)),a=!0)}if(!a)for(u=-1;++u<ae;){const h=J[u];let g=h.isSingleMatch(c);if(g){n.push(new h(g,e));break}}}return n})}const yt=new Set([Ee.type,ye.type]);class bt{constructor(e,{isCaseSensitive:s=m.isCaseSensitive,ignoreDiacritics:r=m.ignoreDiacritics,includeMatches:n=m.includeMatches,minMatchCharLength:i=m.minMatchCharLength,ignoreLocation:o=m.ignoreLocation,findAllMatches:c=m.findAllMatches,location:a=m.location,threshold:u=m.threshold,distance:h=m.distance}={}){this.query=null,this.options={isCaseSensitive:s,ignoreDiacritics:r,includeMatches:n,minMatchCharLength:i,findAllMatches:c,ignoreLocation:o,location:a,threshold:u,distance:h},e=s?e:e.toLowerCase(),e=r?K(e):e,this.pattern=e,this.query=Et(this.pattern,this.options)}static condition(e,s){return s.useExtendedSearch}searchIn(e){const s=this.query;if(!s)return{isMatch:!1,score:1};const{includeMatches:r,isCaseSensitive:n,ignoreDiacritics:i}=this.options;e=n?e:e.toLowerCase(),e=i?K(e):e;let o=0,c=[],a=0;for(let u=0,h=s.length;u<h;u+=1){const g=s[u];c.length=0,o=0;for(let p=0,A=g.length;p<A;p+=1){const f=g[p],{isMatch:E,indices:M,score:y}=f.search(e);if(E){if(o+=1,a+=y,r){const S=f.constructor.type;yt.has(S)?c=[...c,...M]:c.push(M)}}else{a=0,o=0,c.length=0;break}}if(o){let p={isMatch:!0,score:a/o};return r&&(p.indices=c),p}}return{isMatch:!1,score:1}}}const X=[];function Ct(...t){X.push(...t)}function Z(t,e){for(let s=0,r=X.length;s<r;s+=1){let n=X[s];if(n.condition(t,e))return new n(t,e)}return new Ae(t,e)}const W={AND:"$and",OR:"$or"},q={PATH:"$path",PATTERN:"$val"},ee=t=>!!(t[W.AND]||t[W.OR]),Mt=t=>!!t[q.PATH],wt=t=>!_(t)&&me(t)&&!ee(t),ue=t=>({[W.AND]:Object.keys(t).map(e=>({[e]:t[e]}))});function be(t,e,{auto:s=!0}={}){const r=n=>{let i=Object.keys(n);const o=Mt(n);if(!o&&i.length>1&&!ee(n))return r(ue(n));if(wt(n)){const a=o?n[q.PATH]:i[0],u=o?n[q.PATTERN]:n[a];if(!I(u))throw new Error(Qe(a));const h={keyId:Q(a),pattern:u};return s&&(h.searcher=Z(u,e)),h}let c={children:[],operator:i[0]};return i.forEach(a=>{const u=n[a];_(u)&&u.forEach(h=>{c.children.push(r(h))})}),c};return ee(t)||(t=ue(t)),r(t)}function Ft(t,{ignoreFieldNorm:e=m.ignoreFieldNorm}){t.forEach(s=>{let r=1;s.matches.forEach(({key:n,norm:i,score:o})=>{const c=n?n.weight:null;r*=Math.pow(o===0&&c?Number.EPSILON:o,(c||1)*(e?1:i))}),s.score=r})}function St(t,e){const s=t.matches;e.matches=[],D(s)&&s.forEach(r=>{if(!D(r.indices)||!r.indices.length)return;const{indices:n,value:i}=r;let o={indices:n,value:i};r.key&&(o.key=r.key.src),r.idx>-1&&(o.refIndex=r.idx),e.matches.push(o)})}function Bt(t,e){e.score=t.score}function vt(t,e,{includeMatches:s=m.includeMatches,includeScore:r=m.includeScore}={}){const n=[];return s&&n.push(St),r&&n.push(Bt),t.map(i=>{const{idx:o}=i,c={item:e[o],refIndex:o};return n.length&&n.forEach(a=>{a(i,c)}),c})}class ${constructor(e,s={},r){this.options={...m,...s},this.options.useExtendedSearch,this._keyStore=new qe(this.options.keys),this.setCollection(e,r)}setCollection(e,s){if(this._docs=e,s&&!(s instanceof te))throw new Error(Ge);this._myIndex=s||xe(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){D(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const s=[];for(let r=0,n=this._docs.length;r<n;r+=1){const i=this._docs[r];e(i,r)&&(this.removeAt(r),r-=1,n-=1,s.push(i))}return s}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:s=-1}={}){const{includeMatches:r,includeScore:n,shouldSort:i,sortFn:o,ignoreFieldNorm:c}=this.options;let a=I(e)?I(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return Ft(a,{ignoreFieldNorm:c}),i&&a.sort(o),fe(s)&&s>-1&&(a=a.slice(0,s)),vt(a,this._docs,{includeMatches:r,includeScore:n})}_searchStringList(e){const s=Z(e,this.options),{records:r}=this._myIndex,n=[];return r.forEach(({v:i,i:o,n:c})=>{if(!D(i))return;const{isMatch:a,score:u,indices:h}=s.searchIn(i);a&&n.push({item:i,idx:o,matches:[{score:u,value:i,norm:c,indices:h}]})}),n}_searchLogical(e){const s=be(e,this.options),r=(c,a,u)=>{if(!c.children){const{keyId:g,searcher:p}=c,A=this._findMatches({key:this._keyStore.get(g),value:this._myIndex.getValueForItemAtKeyId(a,g),searcher:p});return A&&A.length?[{idx:u,item:a,matches:A}]:[]}const h=[];for(let g=0,p=c.children.length;g<p;g+=1){const A=c.children[g],f=r(A,a,u);if(f.length)h.push(...f);else if(c.operator===W.AND)return[]}return h},n=this._myIndex.records,i={},o=[];return n.forEach(({$:c,i:a})=>{if(D(c)){let u=r(s,c,a);u.length&&(i[a]||(i[a]={idx:a,item:c,matches:[]},o.push(i[a])),u.forEach(({matches:h})=>{i[a].matches.push(...h)}))}}),o}_searchObjectList(e){const s=Z(e,this.options),{keys:r,records:n}=this._myIndex,i=[];return n.forEach(({$:o,i:c})=>{if(!D(o))return;let a=[];r.forEach((u,h)=>{a.push(...this._findMatches({key:u,value:o[h],searcher:s}))}),a.length&&i.push({idx:c,item:o,matches:a})}),i}_findMatches({key:e,value:s,searcher:r}){if(!D(s))return[];let n=[];if(_(s))s.forEach(({v:i,i:o,n:c})=>{if(!D(i))return;const{isMatch:a,score:u,indices:h}=r.searchIn(i);a&&n.push({score:u,key:e,value:i,idx:o,norm:c,indices:h})});else{const{v:i,n:o}=s,{isMatch:c,score:a,indices:u}=r.searchIn(i);c&&n.push({score:a,key:e,value:i,norm:o,indices:u})}return n}}$.version="7.1.0";$.createIndex=xe;$.parseIndex=ot;$.config=m;$.parseQuery=be;Ct(bt);function Ce(t){const e=t.toLowerCase();return/(empathogen|euphoriant)/.test(e)?"Empathogen":/(psychedelic|visionary)/.test(e)?"Psychedelic":/dissociative|sedative/.test(e)?"Dissociative":/oneirogen|dream/.test(e)?"Oneirogen":"Other"}function Dt(t,e={}){const{favorites:s=[]}=e,[r,n]=C.useState(""),[i,o]=C.useState([]),[c,a]=C.useState(!0),[u,h]=C.useState(!1),[g,p]=C.useState([]),[A,f]=C.useState(""),E=C.useMemo(()=>new $(t,{keys:["name","altNames","scientificName","effects","tags"],threshold:.4,includeMatches:!0,isCaseSensitive:!1,ignoreLocation:!0}),[t]);return{filtered:C.useMemo(()=>{let y=t;const S=r.trim();return S&&(y=E.search(S).map(w=>w.item)),i.length&&(y=y.filter(w=>c?i.every(B=>w.tags.some(j=>v(j)===v(B))):i.some(B=>w.tags.some(j=>v(j)===v(B))))),g.length&&(y=y.filter(w=>g.includes(Ce(w.category)))),u&&(y=y.filter(w=>s.includes(w.id))),A==="name"&&(y=[...y].sort((w,B)=>w.name.localeCompare(B.name))),y},[t,r,i,g,u,s,A,E,c]),query:r,setQuery:n,tags:i,setTags:o,matchAll:c,setMatchAll:a,categories:g,setCategories:p,favoritesOnly:u,setFavoritesOnly:h,sort:A,setSort:f,fuse:E}}function Nt({selected:t,onChange:e}){const s=C.useMemo(()=>{const n={};return de.forEach(i=>{const o=Ce(i.category);n[o]=(n[o]||0)+1}),n},[]),r=n=>{const i=t.includes(n)?t.filter(o=>o!==n):[...t,n];e==null||e(i)};return l.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(s).sort((n,i)=>i[1]-n[1]).map(([n,i])=>l.jsxs("button",{type:"button",onClick:()=>r(n),className:`tag-pill ${t.includes(n)?"ring-2 ring-emerald-400":""}`,children:[n," (",i,")"]},n))})}function jt(){const[t]=C.useState(_e);return C.useEffect(()=>{},[]),t}function It({query:t,setQuery:e,fuse:s}){const[r,n]=C.useState([]);C.useEffect(()=>{const c=t.trim();n(c?s.search(c,{limit:5,isCaseSensitive:!1,ignoreLocation:!0}):[])},[t,s]);const i=c=>{if(!t)return c;const a=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),u=new RegExp(`(${a})`,"ig");return c.replace(u,'<span class="font-bold">$1</span>')},o=c=>{const a=[c.item.name,...c.item.altNames||[]].join(", ");return i(a)};return l.jsxs("div",{className:"relative w-full",children:[l.jsx("input",{type:"text",placeholder:"Search herbs...","aria-label":"Search herbs",tabIndex:0,value:t,onChange:c=>e(c.target.value),className:"w-full rounded-md bg-space-dark/70 px-3 py-2 text-white backdrop-blur-md focus:outline-none"}),r.length>0&&l.jsx("ul",{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-black/80 p-2 text-sm text-sand backdrop-blur-md",children:r.map(c=>l.jsx("li",{children:l.jsx("button",{type:"button",tabIndex:0,"aria-label":`Select ${c.item.name}`,className:"w-full text-left rounded px-2 py-1 hover:bg-white/10",onClick:()=>e(c.item.name),dangerouslySetInnerHTML:{__html:o(c)}})},c.item.id))})]})}function Lt(t,e){try{const s=localStorage.getItem(t);return s?JSON.parse(s):e}catch{return e}}function le(t,e){try{localStorage.setItem(t,JSON.stringify(e))}catch{}}function zt(){const t=jt(),{favorites:e}=Be(),{filtered:s,query:r,setQuery:n,tags:i,setTags:o,matchAll:c,setMatchAll:a,categories:u,setCategories:h,favoritesOnly:g,setFavoritesOnly:p,fuse:A}=Dt(t,{favorites:e});C.useEffect(()=>{var b;const x=((b=new URLSearchParams(window.location.search).get("herbs"))==null?void 0:b.split(","))||[];x.length&&setTimeout(()=>{x.forEach(F=>{const L=document.getElementById(`herb-${F}`);L&&(L.scrollIntoView({behavior:"smooth"}),L.classList.add("ring-2","ring-sky-300"),setTimeout(()=>L.classList.remove("ring-2","ring-sky-300"),2e3))})},300)},[]),C.useEffect(()=>{const d=Lt("dbScroll",0);d&&window.scrollTo(0,d);const x=()=>le("dbScroll",window.scrollY);return window.addEventListener("scroll",x),()=>{le("dbScroll",window.scrollY),window.removeEventListener("scroll",x)}},[]);const f=C.useMemo(()=>{const d=t.reduce((x,b)=>x.concat(b.tags),[]);return Array.from(new Set(d.map(v)))},[t]),E=C.useMemo(()=>{const d=t.filter(b=>b.affiliateLink&&b.affiliateLink.startsWith("http")).length,x=t.filter(b=>b.mechanismOfAction&&b.mechanismOfAction.trim()).length;return{total:t.length,affiliates:d,moaCount:x}},[t]),M=C.useMemo(()=>{const d={};return t.forEach(x=>{x.tags.forEach(b=>{const F=v(b);d[F]=(d[F]||0)+1})}),d},[t]),[y,S]=C.useState(!1),[w,B]=C.useState(!0);C.useEffect(()=>{let d=window.scrollY;const x=()=>{const b=window.scrollY;B(b<d||b<100),d=b};return window.addEventListener("scroll",x),()=>window.removeEventListener("scroll",x)},[]),C.useEffect(()=>{const d=()=>{window.scrollY>150&&S(!1)};return window.addEventListener("scroll",d),window.addEventListener("touchmove",d),()=>{window.removeEventListener("scroll",d),window.removeEventListener("touchmove",d)}},[]);const j=C.useMemo(()=>{if(i.length===0)return[];const d={};return t.forEach(x=>{i.every(b=>x.tags.some(F=>v(F)===v(b)))&&x.tags.forEach(b=>{const F=v(b);i.some(L=>v(L)===F)||(d[F]=(d[F]||0)+1)})}),Object.entries(d).sort((x,b)=>b[1]-x[1]).slice(0,5).map(([x])=>x)},[i,t]);return l.jsxs(l.Fragment,{children:[l.jsxs(Me,{children:[l.jsx("title",{children:"Database - The Hippie Scientist"}),l.jsx("meta",{name:"description",content:"Browse herbal entries and expand each to learn more about their effects and usage."})]}),l.jsxs("div",{className:"relative min-h-screen px-4 pt-20",children:[l.jsx(ke,{}),l.jsxs("div",{className:"relative mx-auto max-w-6xl",children:[l.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"mb-8 text-center",children:[l.jsx("h1",{className:"text-gradient mb-6 text-5xl font-bold",children:"Herb Database"}),l.jsx("p",{className:"mx-auto max-w-4xl text-xl text-sand",children:"Explore our collection of herbs. Click any entry to see detailed information."})]}),l.jsxs(k.div,{className:"sticky top-2 z-20 mb-4 flex flex-wrap items-center gap-2",animate:{y:w?0:-60,opacity:w?1:0},transition:{duration:.3},children:[l.jsx(It,{query:r,setQuery:n,fuse:A}),l.jsx("button",{type:"button",onClick:()=>p(d=>!d),className:"rounded-md bg-space-dark/70 px-3 py-2 text-sm text-yellow-300 backdrop-blur-md hover:bg-white/10",children:g?"All Herbs":"My Herbs"}),l.jsx("button",{type:"button",onClick:()=>a(d=>!d),className:"hover-glow rounded-md bg-space-dark/70 px-3 py-2 text-sm text-sand backdrop-blur-md hover:bg-white/10",children:c?"Match ALL":"Match ANY"}),l.jsx(we,{to:"/downloads",className:"rounded-md bg-space-dark/70 p-2 text-sand backdrop-blur-md hover:bg-white/10","aria-label":"Export data",children:l.jsx(Fe,{size:18})}),l.jsx("button",{type:"button",onClick:()=>S(d=>!d),className:"rounded-md bg-space-dark/70 px-3 py-2 text-sm text-sand backdrop-blur-md hover:bg-white/10 sm:hidden",children:y?"Hide Filters":"Show Filters"})]}),l.jsxs("div",{className:`mb-4 space-y-4 ${y?"":"hidden sm:block"}`,children:[l.jsx(Nt,{selected:u,onChange:h}),l.jsx(He,{tags:f,counts:M,onChange:o})]}),j.length>0&&l.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-2",children:[l.jsx("span",{className:"text-sm text-moss",children:"Related tags:"}),j.map(d=>l.jsx("button",{type:"button",onClick:()=>o(x=>Array.from(new Set([...x,d]))),className:"tag-pill",children:G(d)},d))]}),l.jsx(ze,{}),l.jsx($e,{herbs:s,highlightQuery:r}),l.jsxs("footer",{className:"mt-4 text-center text-sm text-moss",children:["Total herbs: ",E.total," Â· Affiliate links: ",E.affiliates," Â· MOA documented:"," ",E.moaCount," Â· Updated: ",new Date("2025-07-21T01:25:00.176Z").toLocaleDateString()]})]})]})]})}export{zt as default};
